{% extends 'c-word.html' %}

{% block title %} scrapy - computer | software | language | python | framework | crawler {% endblock title %}

{% block point1 %}
<article contenteditable="true">
  <p>Category: computer | software | language | python | framework | crawler | scrapy</p>
  <h1 id="blogTitle0">Scrapy</h1><h2 id="blogTitle1">概述</h2><h3 id="blogTitle2">定义</h3><div><br></div><div><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">Scrapy is an application framework for crawling web sites and extracting structured data which can be used for a wide range of useful applications, like data mining, information processing or historical archival.</p></div><div><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">Scrapy是用纯Python实现一个为了爬取网站数据、提取结构性数据而编写的应用框架，用途非常广泛，如数据挖掘、信息处理、历史建档等。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">框架的力量，用户只需要定制开发几个模块就可以轻松的实现一个爬虫，用来抓取网页内容以及各种图片，非常之方便。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">Scrapy 使用了 Twisted<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">['twɪstɪd]</code>(其主要对手是Tornado)异步网络框架来处理网络通讯，可以加快我们的下载速度，不用自己去实现异步框架，并且包含了各种中间件接口，可以灵活的完成各种需求。</p></li></ul></div><div><br></div><h3 id="blogTitle3">制作 Scrapy 爬虫 一共需要 4 步<br></h3><div><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">新建项目（scrapy startproject xxx）：新建一个新的爬虫项目</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">明确目标（编写 items.py）：明确你想要抓取的目标</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">制作爬虫（spiders/xxspider.py）：制作爬虫开始爬取网页</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">存储内容（pipelines.py）：设计管道存储爬取内容</li></ul></div><h4 id="blogTitle4">新建项目</h4><div><ul style="font-size: 16px; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">新建项目（scrapy startproject xxx）：新建一个新的爬虫项目</li></ul></div><h4 id="blogTitle5">明确目标</h4><div><ul style="font-size: 16px; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">明确目标（编写 items.py）：明确你想要抓取的目标</li></ul></div><h4 id="blogTitle6">制作爬虫</h4><div><ul style="font-size: 16px; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">制作爬虫（spiders/xxspider.py）：制作爬虫开始爬取网页</li></ul></div><h4 id="blogTitle7">存储内容</h4><div><ul style="font-size: 16px; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">存储内容（pipelines.py）：设计管道存储爬取内容</li></ul></div><h3 id="blogTitle8">组成</h3><div><br></div><h3 id="blogTitle9">功能</h3><div><br></div><h3 id="blogTitle10">用途</h3><div><br></div><div><h3 id="blogTitle11">安装</h3><div><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-weight: 700; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);">具体Scrapy安装流程参考：</span><a href="http://doc.scrapy.org/en/latest/intro/install.html#intro-install-platform-notes" target="_blank" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: 16px; background: 0px 0px rgb(243, 234, 203); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-weight: 700; letter-spacing: 0.2px;">http://doc.scrapy.org/en/latest/intro/install.html#intro-install-platform-notes</a><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-weight: 700; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);">&nbsp;里面有各个平台的安装方法</span><br></div><h4 id="blogTitle12">下载</h4><div><span style="color: rgb(101, 123, 131); font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; letter-spacing: 0.2px; background-color: rgb(253, 246, 227);">pip3 install scrapy</span><br></div><h4 id="blogTitle13">创建软链接</h4><pre>ln -s /usr/local/python3/bin/scrapy /usr/bin/scrapy</pre><div><br></div><div><br></div></div><div><br></div><div><h2 id="blogTitle14">架构总览</h2><div>描述 Scrapy 的架构</div><div>描述 Scrapy 各组件之间是如何交互的</div><h3 id="blogTitle15">数据流</h3><div><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2wAAAJLCAYAAACbshVrAAAgAElEQVR4XuzdB3hUVd4G8Hd6yqSREEIPRZp0URRQsBfsveEiomsXFwTr6lJcWRFsa8FeWP0sqNi7iCKgqCjFAoQmLb1OMvV7/ickJKTNJFPunXnv8/BAMveee+7v3CgvpxkmT57se+qpp8CDAhSgAAUoQAEKUIACFKAABbQjsGDhLBjOmTjZ98ZzDGzaaRbWhAIUoAAFKEABClCAAhSgAKAC2+GnT/B9986L9KAABShAAQpQgAIUoAAFKEABDQmowMYhkRpqEVaFAhSgAAUoQAEKUIACFKDAPoF9ge1S31NPvUQUClCAAhSgAAUoQAEKUIACFNCQgApsPbOzfZtycjRULVaFAhSgAAUoQAEKUIACFKAABRjY+A5QgAIUoAAFKEABClCAAhTQqAADm0YbhtWiAAUoQAEKUIACFKAABSjAwMZ3gAIUoAAFKEABClCAAhSggEYFGNg02jCsFgUoQAEKUIACFKAABShAAQY2vgMUoAAFKEABClCAAhSgAAU0KsDAptGGYbUoQAEKUIACFKAABShAAQowsPEdoAAFKEABClCAAhSgAAUooFEBBjaNNgyrRQEKUIACFKAABShAAQpQgIGN7wAFKEABClCAAhSgAAUoQAGNCjCwabRhWC0KUIACFKAABShAAQpQgAIMbHwHKEABClCAAhSgAAUoQAEKaFTgsmnXwNAzO9u3KSdHo1VktShAAQpQgAIUoAAFKEABCsSmgMFgYGCLzabnU1OAAhSgAAUoQAEKUIACWhcwGPsxsGm9kVg/ClCAAhSgAAUoQAEKUCA2BRjYYrPd+dQUoAAFKEABClCAAhSggA4EGNh00EisIgUoQAEKUIACFKAABSgQmwIG4+EcEhmbTc+npgAFKEABClCAAhSgAAW0LsBFR7TeQqwfBShAAQpQgAIUoAAFKBCzAgZDFnvYYrb1+eAUoAAFKEABClCAAhSggKYF2MOm6eZh5ShAAQpQgAIUoAAFKECBWBZYsHAWe9hi+QXgs1OAAhSgAAUoQAEKUIAC2hVgYNNu27BmFKAABShAAQpQgAIUoECMCzCwxfgLwMenAAUoQAEKUIACFKAABbQrsGDhNA6J1G7zsGYUoAAFKEABClCAAhSgQCwLTDkrG4YeAy7wbV73aiw78NkpQAEKUIACFKAABShAAQpoTkCtEnnU1f/0LX38X5qrHCtEAQpQgAIUoAAFKEABClAglgXUPmzT5szz3X/71Fh24LNTgAIUoAAFKEABClCAAhTQnMBtD82EYd68eb6pUyMf2IqLizUHxApRIFwCCQkJsFgs4bod70MBClCAAhSgAAUooAMBtUrkvHl3+6ZOvSfi1X3vvfciXgdWgAKREhgxYgSysrIidXvelwIUoAAFKEABClBAgwIqsN178yW+2+a/HPHqSWA74ogjkJ6eHvG6sAIUCKeAvPsMbOEU570oQAEKUIACFKCAPgRUYLtyVC/fwm83RrzGDGwRbwJWIEICDGwRgudtKUABClCAAhSggMYFNLVxNgObxt8WVi9kAgxsIaNlwRSgAAUoQAEKUEDXAgxsum4+Vj5aBBjYoqUl+RwUoAAFKEABClAguAIMbMH1ZGkUaJUAA1ur2HgRBShAAQpQgAIUiHoBBraob2I+oB4EGNj00EqsIwUoQAEKUIACFAi/AANb+M15Rwo0EGBg40tBAQpQgAIUoAAFKNCYAAMb3wsKaECAgU0DjcAqUIACFKAABShAAQ0KMLBpsFFYpdgTYGCLvTbnE1OAAhSgAAUoQAF/BBjY/FHiORQIsQADW4iBWTwFKEABClCAAhTQqQADm04bjtWOLgEGtuhqTz4NBShAAQpQgAIUCJYAA1uwJFkOBdogwMDWBjxeSgEKUIACFKAABaJYgIEtihuXj6YfAQY2/bQVa0oBClCAAhSgAAXCKcDAFk5t3osCTQgwsPHVoAAFKEABClCAAhRoTICBje8FBTQgwMCmgUZgFShAAQpQgAIUoIAGBRjYNNgorFLsCTCwxV6b84kpQAEKUIACFKCAPwK6DGyPPfo1Fi/+xZ/na/U5J5/cH1NvObbB9e8u+RUPPbi01eX6c2G/fh3w6GPnNTh1/fpduPH6N/0potXndOiQhEWv/K3V1/PC1gkwsLXOjVdRgAIUoAAFKECBaBdgYGuihRnYov3V19bzMbBpqz1YGwpQgAIUoAAFKKAVAQY2BrZ6Auxhi8yPJgNbZNx5VwpQgAIUoAAFKKB1AQY2BjYGNg38lDKwaaARWAUKUIACFKAABSigQQEGNgY2BjYN/GAysGmgEVgFClCAAhSgAAUooEEBBjYGNgY2DfxgMrBpoBFYBQpQgAIUoAAFKKBBAQY2BjYGNg38YDKwaaARWAUKUIACFKAABSigQQEV2K6++Xbf4/PnRLx68pfWI444Aunp6c3Whcv6h66pWrvoyNy5c/HTTz/hrLPOwgUXXFBbwcsvvxwGgwHy+V9//YX//Oc/+Ne//oVOnTrh1ltvRW5urjr3xBNPxEknnYSOHTuqr9944w31S44ePXrg1FNPxejRo9XXRUVF6torrrgChx56aO29Nm3ahDvuuKMBzvXXX49HH30UL7/8MsxmM1588UXs3LlTlSHH448/DovFgsmTJ8PlcmHChAno06cP7r77bphMJlRWVuKmm25CcXGxOr9bt27qOUeOHAmj0YiHHnoI3333Xb37nnzyyfjb3/zfHoGBLXTvNEumAAUoQAEKUIACehZQgW3evHm+qVOnRvw5GNiqm0CP+7BJoHr//fdx5JFH4uuvv1bPISFm1KhRSElJwc8//4zffvtNBa9vvvkG/fr1w9ChQzF8+HAVjh577DF0795dfSbn33PPPSpYnX/++fjss8+wZs0afPnllxgzZgx2796trn3iiSdw5pln1r63P/zwgwpwM2bMqPcujx07Fqeccgp27dqFrKwsyNd5eXlYt26dOu+oo47C6aefjmnTpkHewdNOO03V79tvv0W7du1QVlaG3r1745BDDsGgQYOwcuVK9WyLFy9W5V544YXqmS+77LLa+0q4lHL8PRjY/JXieRSgAAUoQAEKUCC2BFRgu+Sk4b6XP1wd8SdnYNN3YFu+fDmsVqsKZqmpqbjtttvw+uuvq3DUVGB78MEHVej68ccfVdh66623VHiSwLZixQp89NFHCuWaa67BK6+8onrpSktLmw1sPp+v3ru8fv16HHzwwaoH8KCDDsKwYcNUOeXl5eo8CXHS+3bcccdh4sSJkOvfffddfP/99+jVq1dtYLvvvvvU53Jd//79cfTRR+OFF15QgW3Lli2qvq09GNhaK8frKEABClCAAhSgQHQLqMDWo/8o3+b130b8SRnY9B3YJOhIT9Pq1atVj9TAgQNVT9UXX3zRYmCTJ5feOAlIL730UoPA9umnn+KEE05QvV49e/YMKLDJsMvMzEzVAyg9cxLYEhMT8eqrr6r6de7cGdI7J3WWIZMSDKW3TXr4jjnmmAaBTep67rnnwuv1ql42BraI/6eDFaAABShAAQpQgAJRK8AhkU007ckn98fU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JEDBFkCYbIoESIAESIAESIAESIAESIAEAkmAgi2QNNkWCZAACZAACZAACZAACZAACQSQAAVbAGGyKRIgARIgARIgARIgARIgARIIJAEKtkDSZFskQAIkQAIkQAIkQAIkQAIkEEACFGwBhMmmSIAESIAESIAESIAESIAESCCQBCjYAkmTbZEACZAACZAACZAACZAACZBAAAlQsAUQJpsiARIgARIgARIgARIgARIggUASoGALJE22RQIkQAIkQAIkQAIkQAIkQAIBJEDBFkCYbIoESIAESIAESIAESIAESIAEAkmAgi2QNNkWCZAACZAACZAACZAACZAACQSQAAVbAGGyKRIgARIgARIgARIgARIgARIIJAEKtkDSZFskQAIkQAIkQAIkQAIkQAIkEEACFGwBhMmmSIAESIAESIAESIAESIAESCCQBCjYAkmTbZEACZAACZAACZAACZAACZBAAAlQsAUQJpsiARIgARIgARIgARIgARIggUASoGALJE22RQIkQAIkQAIkQAIkQAIkQAIBJEDBFkCYbIoESIAESIAESIAESIAESIAEAkmAgi2QNNkWCZAACZAACZAACZAACZAACQSQAAVbAGGyKRIgARIgARIgARIgARIgARIIJAEKtkDSZFskQAIkQAIkQAIkQAIkQAIkEEACFGwBhMmmSIAESIAESIAESIAESIAESCCQBCjYAkmTbZEACZAACZAACZAACZAACZBAAAlQsAUQJpsiARIgARIgARIgARIgARIggUASoGALJE22RQIkQAIkQAIkQAIkQAIkQAIBJEDBFkCYbIoESIAESIAESIAESIAESIAEAkmAgi2QNNkWCZAACZAACZAACZAACZAACQSQAAVbAGGyKRIgARIgARIgARIgARIgARIIJAEKtkDSZFskQAIkQAIkQAIkQAIkQAIkEEACFGwBhMmmSIAESIAESIAESIAESIAESCCQBCjYAkmTbZEACZAACZAACZAACZAACZBAAAlQsAUQJpsiARIgARIgARIgARIgARIggUASoGALJE22RQIkQAIkQAIkQAIkQAIkQAIBJEDBFkCYbIoESIAESIAESIAESIAESIAEAkmAgi2QNNkWCZAACZAACZAACZAACZAACQSQAAVbAGGyKRIgARIgARIgARIgARIgARIIJAEKtkDSZFskQAIkQAIkQAIkQAIkQAIkEEACFGwBhMmmSIAESIAESIAESIAESIAESCCQBCjYAkmTbZEACZAACZAACZAACZAACZBAAAlQsAUQJpsiARIgARIgARIgARIgARIggUASoGALJE22RQIkQAIkQAIkQAIkQAIkQAIBJEDBFkCYbIoESIAESIAESIAESIAESIAEAkmAgi2QNNkWCZAACZAACZAACZAACZAACQSQAAVbAGGyKRIgARIgARIgARIgARIgARIIJAEKtkDSZFskQAIkQAIkQAIkQAIkQAIkEEACFGwBhMmmSIAESIAESIAESIAESIAESCCQBCjYAkmTbZEACZAACZAACZAACZAACZBAAAlQsAUQJpsiARIgARIgARIgARIgARIggUASoGALJE22RQIkQAIkQAIkQAIkQAIkQAIBJEDBFkCYbIoESIAESIAESIAESIAESIAEAkmAgi2QNNkWCZAACZAACZAACZAACZAACQSQAAVbAGGyKRIgARIgARIgARIgARIgARIIJAEKtkDSZFskQAIkQAIkQAIkQAIkQAIkEEACFGwBhMmmSIAESIAESIAESIAESIAESCCQBOoEW3R0dCDbZVskQAIkQAIkQAIkQAIkQAIkQAJHScAaacb/A+g4eFa2sS3KAAAAAElFTkSuQmCC" style="width: 746px;"><br></div><div><h3 id="blogTitle16">运作流程</h3></div><div><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">The data flow in Scrapy is controlled by the execution engine, and goes like this:</p><ol class="arabic simple" style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style-position: initial; list-style-image: initial; line-height: 24px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);"><li style="box-sizing: border-box; list-style: decimal; margin-left: 24px;">The&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-engine" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Engine</a>&nbsp;gets the initial Requests to crawl from the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-spiders" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Spider</a>.</li><li style="box-sizing: border-box; list-style: decimal; margin-left: 24px;">The&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-engine" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Engine</a>&nbsp;schedules the Requests in the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-scheduler" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Scheduler</a>&nbsp;and asks for the next Requests to crawl.</li><li style="box-sizing: border-box; list-style: decimal; margin-left: 24px;">The&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-scheduler" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Scheduler</a>&nbsp;returns the next Requests to the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-engine" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Engine</a>.</li><li style="box-sizing: border-box; list-style: decimal; margin-left: 24px;">The&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-engine" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Engine</a>&nbsp;sends the Requests to the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-downloader" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Downloader</a>, passing through the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-downloader-middleware" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Downloader Middlewares</a>&nbsp;(see<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#scrapy.downloadermiddlewares.DownloaderMiddleware.process_request" title="scrapy.downloadermiddlewares.DownloaderMiddleware.process_request" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-meth docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">process_request()</span></code></a>).</li><li style="box-sizing: border-box; list-style: decimal; margin-left: 24px;">Once the page finishes downloading the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-downloader" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Downloader</a>&nbsp;generates a Response (with that page) and sends it to the Engine, passing through the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-downloader-middleware" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Downloader Middlewares</a>&nbsp;(see&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#scrapy.downloadermiddlewares.DownloaderMiddleware.process_response" title="scrapy.downloadermiddlewares.DownloaderMiddleware.process_response" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-meth docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">process_response()</span></code></a>).</li><li style="box-sizing: border-box; list-style: decimal; margin-left: 24px;">The&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-engine" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Engine</a>&nbsp;receives the Response from the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-downloader" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Downloader</a>&nbsp;and sends it to the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-spiders" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Spider</a>&nbsp;for processing, passing through the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-spider-middleware" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Spider Middleware</a>&nbsp;(see<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/spider-middleware.html#scrapy.spidermiddlewares.SpiderMiddleware.process_spider_input" title="scrapy.spidermiddlewares.SpiderMiddleware.process_spider_input" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-meth docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">process_spider_input()</span></code></a>).</li><li style="box-sizing: border-box; list-style: decimal; margin-left: 24px;">The&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-spiders" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Spider</a>&nbsp;processes the Response and returns scraped items and new Requests (to follow) to the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-engine" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Engine</a>, passing through the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-spider-middleware" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Spider Middleware</a>&nbsp;(see<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/spider-middleware.html#scrapy.spidermiddlewares.SpiderMiddleware.process_spider_output" title="scrapy.spidermiddlewares.SpiderMiddleware.process_spider_output" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-meth docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">process_spider_output()</span></code></a>).</li><li style="box-sizing: border-box; list-style: decimal; margin-left: 24px;">The&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-engine" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Engine</a>&nbsp;sends processed items to&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-pipelines" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Item Pipelines</a>, then send processed Requests to the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-scheduler" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Scheduler</a>&nbsp;and asks for possible next Requests to crawl.</li><li style="box-sizing: border-box; list-style: decimal; margin-left: 24px;">The process repeats (from step 1) until there are no more requests from the&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/architecture.html#component-scheduler" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Scheduler</a>.</li></ol></div><div><br></div><div><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">代码写好，程序开始运行...</p><ol style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>：Hi！<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>, 你要处理哪一个网站？</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>：老大要我处理 xxxx.com。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>：你把第一个需要处理的 URL 给我吧。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>：给你，第一个 URL 是 xxxxxxx.com。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>：Hi！<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">调度器</code>，我这有 request 请求你帮我排序入队一下。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">调度器</code>：好的，正在处理你等一下。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>：Hi！<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">调度器</code>，把你处理好的 request 请求给我。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">调度器</code>：给你，这是我处理好的 request。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>：Hi！下载器，你按照老大的<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">下载中间件</code>的设置帮我下载一下这个 request 请求。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">下载器</code>：好的！给你，这是下载好的东西。（如果失败：sorry，这个 request 下载失败了。然后<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>告诉<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">调度器</code>，这个 request 下载失败了，你记录一下，我们待会儿再下载）。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>：Hi！<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>，这是下载好的东西，并且已经按照老大的<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">下载中间件</code>处理过了，你自己处理一下（注意！这儿 responses 默认是交给&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">def parse()</code>这个函数处理的）。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>：（处理完毕数据之后对于需要跟进的 URL），Hi！<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>，我这里有两个结果，这个是我需要跟进的 URL，还有这个是我获取到的 Item 数据。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>：Hi ！<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">管道</code>&nbsp;我这儿有个 item 你帮我处理一下！<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">调度器</code>！这是需要跟进 URL 你帮我处理下。然后从第四步开始循环，直到获取完老大需要全部信息。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">管道``调度器</code>：好的，现在就做！</p></li></ol><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><span style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-weight: 700; font-size: inherit;">注意！只有当<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">调度器</code>中不存在任何 request 了，整个程序才会停止，（也就是说，对于下载失败的 URL，Scrapy 也会重新下载。）</span></p></div></div><h3 id="blogTitle17">组件</h3><div><ul style="font-size: 16px; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Scrapy Engine(引擎)</code>: 负责<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>、<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">ItemPipeline</code>、<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Downloader</code>、<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Scheduler</code>中间的通讯，信号、数据传递等。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Scheduler(调度器)</code>: 它负责接受<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>发送过来的Request请求，并按照一定的方式进行整理排列，入队，当<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>需要时，交还给<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Downloader（下载器）</code>：负责下载<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Scrapy Engine(引擎)</code>发送的所有Requests请求，并将其获取到的Responses交还给<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Scrapy Engine(引擎)</code>，由<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>交给<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>来处理，</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spiders（爬虫）</code>：它负责处理所有Responses,从中分析提取数据，获取Item字段需要的数据，并将需要跟进的URL提交给<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>，再次进入<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Scheduler(调度器)</code>，</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Item Pipeline(管道)</code>：它负责处理<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>中获取到的Item，并进行进行后期处理（详细分析、过滤、存储等）的地方.</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Downloader Middlewares（下载中间件）</code>：你可以当作是一个可以自定义扩展下载功能的组件。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider Middlewares（Spider中间件）</code>：你可以理解为是一个可以自定扩展和操作<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code>和<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>中间<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">通信</code>的功能组件（比如进入<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>的Responses;和从<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spider</code>出去的Requests）</p></li></ul></div><div><br></div><div><h4 id="blogTitle18">Scrapy 引擎<br></h4><div>引擎主要负责控制系统所有组件之间的数据流，和当某些动作发生时触发相应的事件。</div><div><br></div><div><div><code style="letter-spacing: 0.2px; orphans: 3; widows: 3; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Scrapy Engine(引擎)</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3;">: 负责</span><code style="letter-spacing: 0.2px; orphans: 3; widows: 3; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Spiders</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3;">、</span><code style="letter-spacing: 0.2px; orphans: 3; widows: 3; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">ItemPipeline</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3;">、</span><code style="letter-spacing: 0.2px; orphans: 3; widows: 3; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Downloader</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3;">、</span><code style="letter-spacing: 0.2px; orphans: 3; widows: 3; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Scheduler</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3;">中间的通讯，信号、数据传递等。</span><br></div><h4 id="blogTitle19">调度器</h4><div><code style="letter-spacing: 0.2px; orphans: 3; widows: 3; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Scheduler(调度器)</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3;">: 它负责接受</span><code style="letter-spacing: 0.2px; orphans: 3; widows: 3; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3;">发送过来的 Request 请求，并按照一定的方式进行整理排列，入队，当</span><code style="letter-spacing: 0.2px; orphans: 3; widows: 3; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3;">需要时，交还给</span><code style="letter-spacing: 0.2px; orphans: 3; widows: 3; -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">引擎</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3;">。</span><br></div><h4 id="blogTitle20">下载器</h4><div><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">Downloader（下载器）</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">：负责下载&nbsp;</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">Scrapy Engine(引擎)</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">发送的所有 Requests 请求，并将其获取到的 Responses 交还给&nbsp;</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">Scrapy Engine(引擎)</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">，由</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">引擎</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">交给&nbsp;</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">Spider</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">来处理。</span><br></div><h4 id="blogTitle21">Spiders</h4><div><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">Spider（爬虫）</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">：它负责处理所有 Responses，从中分析提取数据，获取 Item 字段需要的数据，并将需要跟进的 URL 提交给</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">引擎</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">，再次进入</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">Scheduler(调度器)</code><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0.2em; margin: 0px; background: rgb(243, 234, 203); letter-spacing: 0.2px; orphans: 3; widows: 3; font-size: 16px;"><font color="#704214" face="Helvetica Neue, Helvetica, Arial, sans-serif">。</font></code><br></div><h4 id="blogTitle22">Item Pipeline</h4><div><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">Item Pipeline(管道)</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">：它负责处理</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">Spider</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">中获取到的 Item，并进行后期处理（详细分析、过滤、存储等）。</span><br></div><h4 id="blogTitle23">下载器中间件</h4><div><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px; orphans: 3; widows: 3;">Downloader Middlewares（下载中间件）</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">：你可以当作是一个可以自定义扩展下载功能的组件。</span><br></div><div><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);"><br></span></div><div><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">Downloader middlewares are specific hooks that sit between the Engine and the Downloader and process requests when they pass from the Engine to the Downloader, and responses that pass from Downloader to the Engine.</p><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">Use a Downloader middleware if you need to do one of the following:</p><ul class="simple" style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style-position: initial; list-style-image: initial; line-height: 24px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);"><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">process a request just before it is sent to the Downloader (i.e. right before Scrapy sends the request to the website);</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">change received response before passing it to a spider;</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">send a new Request instead of passing received response to a spider;</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">pass response to a spider without fetching a web page;</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">silently drop some requests.</li></ul><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">For more information see&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/downloader-middleware.html#topics-downloader-middleware" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Downloader Middleware</a>.</p></div><h4 id="blogTitle24">Spider 中间件</h4></div><div style="orphans: 3; widows: 3;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px;">Spider Middlewares（Spider中间件）</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);">：你可以理解为是一个可以自定义扩展和操作</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px;">引擎</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);">和</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px;">Spider</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);">中间</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px;">通信</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);">的功能组件（比如进入</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px;">Spider</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);">的 Responses; 和从</span><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227); letter-spacing: 0.2px;">Spider</code><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);">出去的 Requests 或 Item）。</span></div></div><div><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);"><br></span></div><div><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">Spider middlewares are specific hooks that sit between the Engine and the Spiders and are able to process spider input (responses) and output (items and requests).</p><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">Use a Spider middleware if you need to</p><ul class="simple" style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style-position: initial; list-style-image: initial; line-height: 24px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);"><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">post-process output of spider callbacks - change/add/remove requests or items;</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">post-process start_requests;</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">handle spider exceptions;</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">call errback instead of callback for some of the requests based on response content.</li></ul><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">For more information see&nbsp;<a class="reference internal" href="http://doc.scrapy.org/en/latest/topics/spider-middleware.html#topics-spider-middleware" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Spider Middleware</a>.</p></div></div><h3 id="blogTitle25">Event-driven networking</h3><div><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">Scrapy is written with&nbsp;<a class="reference external" href="https://twistedmatrix.com/trac/" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Twisted</a>, a popular event-driven networking framework for Python. Thus, it’s implemented using a non-blocking (aka asynchronous) code for concurrency.</p><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">For more information about asynchronous programming and Twisted see these links:</p><ul class="simple" style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style-position: initial; list-style-image: initial; line-height: 24px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);"><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;"><a class="reference external" href="https://twistedmatrix.com/documents/current/core/howto/defer-intro.html" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Introduction to Deferreds in Twisted</a></li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;"><a class="reference external" href="http://jessenoller.com/2009/02/11/twisted-hello-asynchronous-programming/" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Twisted - hello, asynchronous programming</a></li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;"><a class="reference external" href="http://krondo.com/an-introduction-to-asynchronous-programming-and-twisted/" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Twisted Introduction - Krondo</a></li></ul></div><div><br></div><h2 id="blogTitle26">基础概念</h2><h3 id="blogTitle27">命令行工具</h3><h3 id="blogTitle28">Spiders</h3><h4 id="blogTitle29">scrapy.Spider</h4><h4 id="blogTitle30">Generic Spiders</h4><h5 id="blogTitle31">CrawlSpider</h5><h5 id="blogTitle32">XMLSpider</h5><h5 id="blogTitle33">CSVFeedSpider</h5><h5 id="blogTitle34">SitemapSpider</h5><div><br></div><h3 id="blogTitle35">Selectors</h3><h3 id="blogTitle36">Scrapy shell</h3><h3 id="blogTitle37">Items</h3><h3 id="blogTitle38">Item Loaders</h3><h3 id="blogTitle39">Item Pipeline</h3><h3 id="blogTitle40">Feed exports</h3><h3 id="blogTitle41">Requests and Responses</h3><h3 id="blogTitle42">Link Extractors</h3><h3 id="blogTitle43">Settings</h3><h3 id="blogTitle44">Exceptions</h3><h2 id="blogTitle45">Built-in services</h2><h3 id="blogTitle46">Logging</h3><h3 id="blogTitle47">Stats Collection</h3><h3 id="blogTitle48">Sending e-mail</h3><h3 id="blogTitle49">Telnet Console</h3><h3 id="blogTitle50">Web Service</h3><div><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);"><br></span></div><div><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);"><br></span></div><div><span style="color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; background-color: rgb(243, 234, 203);"><br></span></div><div><h2 id="blogTitle51">Extending Scrapy</h2></div><h3 id="blogTitle52">下载器中间件</h3><h3 id="blogTitle53">Spider 中间件</h3><h3 id="blogTitle54">Extensions</h3><h3 id="blogTitle55">核心 API</h3><h3 id="blogTitle56">信号</h3><h3 id="blogTitle57">Item Exporters&nbsp;</h3><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><h2 id="blogTitle58">Scrapy 框架</h2><h3 id="blogTitle59">入门案例</h3><h4 id="blogTitle60">学习目标</h4><div><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">创建一个 Scrapy 项目</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">定义提取的结构化数据 (Item)</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">编写爬取网站的 Spider 并提取出结构化数据 (Item)</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">编写 Item Pipelines 来存储提取到的 Item (即结构化数据)</li></ul></div><h4 id="blogTitle61">新建项目 (scrapy startproject)</h4><div><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">在开始爬取之前，必须创建一个新的 Scrapy 项目。进入自定义的项目目录中，运行下列命令：</li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">scrapy startproject mySpider</code></pre></div><div><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">其中， mySpider 为项目名称，可以看到将会创建一个 mySpider 文件夹，目录结构大致如下：</li></ul></div><pre>.
└── mySpider
    ├── mySpider
    │&nbsp;&nbsp; ├── __init__.py
    │&nbsp;&nbsp; ├── items.py
    │&nbsp;&nbsp; ├── middlewares.py
    │&nbsp;&nbsp; ├── pipelines.py
    │&nbsp;&nbsp; ├── settings.py
    │&nbsp;&nbsp; └── spiders
    │&nbsp;&nbsp;     └── __init__.py
    └── scrapy.cfg

</pre><div><br></div><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">下面来简单介绍一下各个主要文件的作用：</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">scrapy.cfg ：项目的配置文件</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">mySpider/ ：项目的Python模块，将会从这里引用代码</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">mySpider/items.py ：项目的目标文件</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">mySpider/pipelines.py ：项目的管道文件</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">mySpider/settings.py ：项目的设置文件</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">mySpider/spiders/ ：存储爬虫代码目录</p></blockquote></div><h4 id="blogTitle62">明确目标 (mySpider/items.py)</h4><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">我们打算抓取：<a href="http://www.itcast.cn/channel/teacher.shtml" target="_blank" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">http://www.itcast.cn/channel/teacher.shtml</a>&nbsp;网站里的所有讲师的姓名、职称和个人信息。</p><ol style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">打开 mySpider 目录下的 items.py</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">Item 定义结构化数据字段，用来保存爬取到的数据，有点像 Python 中的 dict，但是提供了一些额外的保护，减少错误。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">可以通过创建一个 scrapy.Item 类， 并且定义类型为 scrapy.Field 的类属性来定义一个Item（可以理解成类似于 ORM 的映射关系）。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">接下来，创建一个 ItcastItem 类，和构建 item 模型（model）。</p></li></ol><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">ItcastItem</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Item)</span>:</span>
    name = scrapy.Field()
    level = scrapy.Field()
    info = scrapy.Field()</code></pre></div><div><br></div><h4 id="blogTitle63">制作爬虫 （spiders/itcastSpider.py）</h4><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><span style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-weight: 700; font-size: inherit;">爬虫功能要分两步：</span></p><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle64">1. 爬数据</h5><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">在当前目录下输入命令，将在<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">mySpider/spider</code>目录下创建一个名为<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">itcast</code>的爬虫，并指定爬取域的范围：</li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">scrapy genspider itcast "itcast.cn"
</code></pre><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">打开 mySpider/spider目录里的 itcast.py，默认增加了下列代码:</li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">ItcastSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"itcast"</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"itcast.cn"</span>]
    start_urls = (
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://www.itcast.cn/'</span>,
    )

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">pass</span>
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">其实也可以由我们自行创建 itcast.py 并编写上面的代码，只不过使用命令可以免去编写固定代码的麻烦</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">要建立一个 Spider， 你必须用 scrapy.Spider 类创建一个子类，并确定了三个强制的属性 和 一个方法。</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">name = ""</code>&nbsp;：这个爬虫的识别名称，必须是唯一的，在不同的爬虫必须定义不同的名字。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">allow_domains = []</code>&nbsp;是搜索的域名范围，也就是爬虫的约束区域，规定爬虫只爬取这个域名下的网页，不存在的URL会被忽略。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">start_urls = ()</code>&nbsp;：爬取的 URL 元组/列表。爬虫从这里开始抓取数据，所以，第一次下载的数据将会从这些 urls 开始。其他子 URL 将会从这些起始 URL 中继承性生成。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">parse(self, response)</code>&nbsp;：解析的方法，每个初始 URL 完成下载后将被调用，调用的时候传入从每一个 URL 传回的 Response 对象来作为唯一参数，主要作用如下：</p><ol style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">负责解析返回的网页数据 (response.body)，提取所需的结构化数据 (生成 item)</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">生成需要下一页的URL请求。</li></ol></li></ul><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">将 start_urls 的值修改为需要爬取的第一个url</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">start_urls = (<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://www.itcast.cn/channel/teacher.shtml"</span>,)
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">修改 parse() 方法</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
    filename = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"teacher.html"</span>
    open(filename, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'w'</span>).write(response.body)
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">然后运行一下看看，在 mySpider 目录下执行：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">scrapy crawl itcast
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">是的，就是 itcast，看上面代码，它是 ItcastSpider 类的 name 属性，也就是使用&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">scrapy genspider</code>命令的唯一爬虫名。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">运行之后，如果打印的日志出现&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">[scrapy] INFO: Spider closed (finished)</code>，代表执行完成。 之后当前文件夹中就出现了一个 teacher.html 文件，里面就是我们刚刚要爬取的网页的全部源代码信息。</p><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle65">2. 取数据</h5><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">爬取整个网页完毕，接下来的就是的取过程了，首先观察页面源码：</li></ul><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><img src="../images/teacher_html.png" alt="" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; border: 0px; font-size: inherit; break-inside: avoid; max-width: 100%;"></p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-html" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">div</span> <span class="hljs-attribute" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">class</span>=<span class="hljs-value" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"li_txt"</span>&gt;</span>
    <span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">h3</span>&gt;</span>  xxx  <span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;/<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">h3</span>&gt;</span>
    <span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">h4</span>&gt;</span> xxxxx <span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;/<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">h4</span>&gt;</span>
    <span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">p</span>&gt;</span> xxxxxxxx <span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;/<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">p</span>&gt;</span>
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">是不是一目了然？直接上 XPath 开始提取数据吧。</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">我们之前在 mySpider/items.py 里定义了一个 ItcastItem 类。 这里引入进来</li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">  <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> mySpider.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> ItcastItem
</code></pre><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">然后将我们得到的数据封装到一个&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">ItcastItem</code>&nbsp;对象中，可以保存每个老师的属性：</li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> mySpider.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> ItcastItem

<span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#open("teacher.html","wb").write(response.body).close()</span>

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 存放老师信息的集合</span>
    items = []

    <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> each <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"//div[@class='li_txt']"</span>):
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 将我们得到的数据封装到一个 `ItcastItem` 对象</span>
        item = ItcastItem()
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># extract() 方法返回的都是 unicode 字符串</span>
        name = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"h3/text()"</span>).extract()
        title = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"h4/text()"</span>).extract()
        info = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"p/text()"</span>).extract()

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># xpath 返回的是包含一个元素的列表</span>
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'name'</span>] = name[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'title'</span>] = title[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'info'</span>] = info[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]

        items.append(item)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 直接返回最后数据</span>
    <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> items
</code></pre><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">我们暂时先不处理管道，后面会详细介绍。</li></ul></div><h4 id="blogTitle66">保存数据</h4><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">scrapy保存信息的最简单的方法主要有四种，-o 输出指定格式的文件，，命令如下：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># json格式，默认为Unicode编码</span>
scrapy crawl itcast -o teachers.json

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># json lines格式，默认为Unicode编码</span>
scrapy crawl itcast -o teachers.jsonl

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># csv 逗号表达式，可用Excel打开</span>
scrapy crawl itcast -o teachers.csv

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># xml格式</span>
scrapy crawl itcast -o teachers.xml</code></pre></div><div><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle67">思考</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">如果将代码改成下面形式，结果完全一样。</p><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle68">请思考 yield 在这里的作用：</h5><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> mySpider.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> ItcastItem

<span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#open("teacher.html","wb").write(response.body).close()</span>

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 存放老师信息的集合</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#items = []</span>

    <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> each <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"//div[@class='li_txt']"</span>):
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 将我们得到的数据封装到一个 `ItcastItem` 对象</span>
        item = ItcastItem()
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># extract() 方法返回的都是 unicode 字符串</span>
        name = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"h3/text()"</span>).extract()
        title = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"h4/text()"</span>).extract()
        info = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"p/text()"</span>).extract()

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># xpath 返回的是包含一个元素的列表</span>
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'name'</span>] = name[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'title'</span>] = title[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'info'</span>] = info[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#items.append(item)</span>

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#将获取的数据交给 pipelines</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> item

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 返回数据，不经过 pipeline</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#return items</span></code></pre></div><h3 id="blogTitle69">Item Pipeline</h3><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">当 Item 在 Spider 中被收集之后，它将会被传递到 Item Pipeline，这些 Item Pipeline 组件按定义的顺序处理 Item。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">每个 Item Pipeline 都是实现了简单方法的 Python 类，比如决定此 Item 是丢弃而存储。以下是 item pipeline 的一些典型应用：</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">验证爬取的数据(检查 item 包含某些字段，比如说 name 字段)</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">查重(并丢弃)</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">将爬取结果保存到文件或者数据库中</li></ul><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle70">编写 item pipeline</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">编写 item pipeline 很简单，item pipiline 组件是一个独立的 Python 类，其中 process_item() 方法必须实现:</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> something

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">SomethingPipeline</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object)</span>:</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">__init__</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 可选实现，做参数初始化等</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># doing something</span>

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">process_item</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, item, spider)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># item (Item 对象) – 被爬取的item</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># spider (Spider 对象) – 爬取该 item 的 spider</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 这个方法必须实现，每个 item pipeline 组件都需要调用该方法，</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 这个方法必须返回一个 Item 对象，被丢弃的 item 将不会被之后的 pipeline 组件所处理。</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> item

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">open_spider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, spider)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># spider (Spider 对象) – 被开启的spider</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 可选实现，当spider被开启时，这个方法被调用。</span>

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">close_spider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, spider)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># spider (Spider 对象) – 被关闭的spider</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 可选实现，当spider被关闭时，这个方法被调用</span></code></pre><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle71">完善之前的案例：</h4><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle72">item 写入 JSON 文件</h5><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">以下 pipeline 将所有(从所有 'spider' 中)爬取到的 item，存储到一个独立地 items.json 文件，每行包含一个序列化为 'JSON' 格式的 'item':</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> json

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">ItcastJsonPipeline</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object)</span>:</span>

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">__init__</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        self.file = open(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'teacher.json'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'wb'</span>)

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">process_item</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, item, spider)</span>:</span>
        content = json.dumps(dict(item), ensure_ascii=<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">False</span>) + <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"\n"</span>
        self.file.write(content)
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> item

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">close_spider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, spider)</span>:</span>
        self.file.close()</code></pre><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle73">启用一个 Item Pipeline 组件</h5><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">为了启用 Item Pipeline 组件，必须将它的类添加到 settings.py 文件 ITEM_PIPELINES 配置，就像下面这个例子:</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># Configure item pipelines</span>
<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># See http://scrapy.readthedocs.org/en/latest/topics/item-pipeline.html</span>
ITEM_PIPELINES = {
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#'mySpider.pipelines.SomePipeline': 300,</span>
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"mySpider.pipelines.ItcastJsonPipeline"</span>:<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">300</span>
}
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">分配给每个类的整型值，确定了他们运行的顺序，item 按数字从低到高的顺序，通过 pipeline，通常将这些数字定义在 0-1000 范围内（0-1000 随意设置，数值越低，组件的优先级越高）</p><h4 id="blogTitle74" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">重新启动爬虫</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">将 parse() 方法改为如下代码：</p><pre style="padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); font-size: 16px; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; color: rgb(101, 123, 131); -webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> mySpider.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> ItcastItem

<span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#open("teacher.html","wb").write(response.body).close()</span>

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 存放老师信息的集合</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#items = []</span>

    <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> each <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"//div[@class='li_txt']"</span>):
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 将我们得到的数据封装到一个 `ItcastItem` 对象</span>
        item = ItcastItem()
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># extract() 方法返回的都是 unicode 字符串</span>
        name = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"h3/text()"</span>).extract()
        title = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"h4/text()"</span>).extract()
        info = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"p/text()"</span>).extract()

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># xpath 返回的是包含一个元素的列表</span>
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'name'</span>] = name[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'title'</span>] = title[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'info'</span>] = info[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#items.append(item)</span>

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#将获取的数据交给 pipelines</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> item

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 返回数据，不经过 pipeline</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#return items</span></code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">然后执行下面的命令：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-j" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">scrapy crawl itcast
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">查看当前目录是否生成 teacher.json</p></div><div><br></div><h3 id="blogTitle75">Scrapy Shell</h3><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Scrapy 终端是一个交互终端，我们可以在未启动 spider 的情况下尝试及调试代码，也可以用来测试 XPath 或 CSS 表达式，查看他们的工作方式，方便我们爬取的网页中提取的数据。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">如果安装了 IPython，Scrapy 终端将使用 IPython (替代标准 Python 终端)。 IPython 终端与其他相比更为强大，提供智能的自动补全，高亮输出，及其他特性。（推荐安装IPython）</p><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle76">启动 Scrapy Shell</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">进入项目的根目录，执行下列命令来启动shell:</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">scrapy shell <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://www.itcast.cn/channel/teacher.shtml"</span>
</code></pre></div><div><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px; white-space: normal;">Scrapy Shell 根据下载的页面会自动创建一些方便使用的对象，例如 Response 对象，以及&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Selector 对象 (对HTML及XML内容)</code>。</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px; white-space: normal;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">当 shell 载入后，将得到一个包含 response 数据的本地 response 变量，输入&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">response.body</code>将输出 response 的包体，输出&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">response.headers</code>&nbsp;可以看到 response 的包头。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">输入&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">response.selector</code>&nbsp;时， 将获取到一个 response 初始化的类 Selector 的对象，此时可以通过使用&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">response.selector.xpath()</code>或<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">response.selector.css()</code>&nbsp;来对 response 进行查询。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">Scrapy 也提供了一些快捷方式, 例如&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">response.xpath()</code>或<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">response.css()</code>同样可以生效（如之前的案例）。</p></li></ul></span></code></div><div><h3 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle77">Selectors 选择器</h3><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle78">Scrapy Selectors 内置 XPath 和 CSS Selector 表达式机制</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Selector 有四个基本的方法，最常用的还是 xpath:</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">xpath(): 传入 xpath 表达式，返回该表达式所对应的所有节点的 selector list 列表</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">extract(): 序列化该节点为 Unicode 字符串并返回 list</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">css(): 传入 CSS 表达式，返回该表达式所对应的所有节点的 selector list 列表，语法同&nbsp; BeautifulSoup4</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">re(): 根据传入的正则表达式对数据进行提取，返回 Unicode 字符串 list 列表</li></ul><h4 id="blogTitle79" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">XPath 表达式的例子及对应的含义:</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); white-space: pre-wrap; letter-spacing: 0.2px; font-size: 16px; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; color: rgb(101, 123, 131);"><code class="lang-html" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">/html/head/title: 选择<span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">HTML</span>&gt;</span>文档中 <span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">head</span>&gt;</span> 标签内的 <span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">title</span>&gt;</span> 元素
/html/head/title/text(): 选择上面提到的 <span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">title</span>&gt;</span> 元素的文字
//td: 选择所有的 <span class="hljs-tag" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(200, 40, 41);">&lt;<span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">td</span>&gt;</span> 元素
//div[@class="mine"]: 选择所有具有 class="mine" 属性的 div 元素</code></pre><h4 id="blogTitle80" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">尝试Selector</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">我们用腾讯社招的网站&nbsp;<a href="http://hr.tencent.com/position.php?&amp;start=0#a" target="_blank" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">http://hr.tencent.com/position.php?&amp;start=0#a</a>&nbsp;举例：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"># 启动
scrapy shell "http://hr.tencent.com/position.php?&amp;start=0#a"

# 返回 xpath选择器对象列表
response.xpath('//title')
[&lt;Selector xpath='//title' data=u'&lt;title&gt;\u804c\u4f4d\u641c\u7d22 | \u793e\u4f1a\u62db\u8058 | Tencent \u817e\u8baf\u62db\u8058&lt;/title'&gt;]

# 使用 extract()方法返回 Unicode 字符串列表
response.xpath('//title').extract()
[u'&lt;title&gt;\u804c\u4f4d\u641c\u7d22 | \u793e\u4f1a\u62db\u8058 | Tencent \u817e\u8baf\u62db\u8058&lt;/title&gt;']

# 打印列表第一个元素，终端编码格式显示
print response.xpath('//title').extract()[0]
&lt;title&gt;职位搜索 | 社会招聘 | Tencent 腾讯招聘&lt;/title&gt;

# 返回 xpath 选择器对象列表
response.xpath('//title/text()')
&lt;Selector xpath='//title/text()' data=u'\u804c\u4f4d\u641c\u7d22 | \u793e\u4f1a\u62db\u8058 | Tencent \u817e\u8baf\u62db\u8058'&gt;

# 返回列表第一个元素的 Unicode 字符串
response.xpath('//title/text()')[0].extract()
u'\u804c\u4f4d\u641c\u7d22 | \u793e\u4f1a\u62db\u8058 | Tencent \u817e\u8baf\u62db\u8058'

# 按终端编码格式显示
print response.xpath('//title/text()')[0].extract()
职位搜索 | 社会招聘 | Tencent 腾讯招聘

response.xpath('//*[@class="even"]')
职位名称:

print site[0].xpath('./td[1]/a/text()').extract()[0]
TEG15-运营开发工程师（深圳）
职位名称详情页:

print site[0].xpath('./td[1]/a/@href').extract()[0]
position_detail.php?id=20744&amp;keywords=&amp;tid=0&amp;lid=0
职位类别:

print site[0].xpath('./td[2]/text()').extract()[0]
技术类
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">以后做数据提取的时候，可以把现在 Scrapy Shell 中测试，测试通过后再应用到代码中。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">当然 Scrapy Shell 作用不仅仅如此，但是不属于我们课程重点，不做详细介绍。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">官方文档：<a href="http://scrapy-chs.readthedocs.io/zh_CN/latest/topics/shell.html" target="_blank" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">http://scrapy-chs.readthedocs.io/zh_CN/latest/topics/shell.html</a></p></div><div><br></div><div><br></div><h3 id="blogTitle81">Spider</h3><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Spider 类定义了如何爬取某个(或某些)网站。包括了爬取的动作(例如:是否跟进链接)以及如何从网页的内容中提取结构化数据(爬取 item)。 换句话说，Spider 就是您定义爬取的动作及分析某个网页(或者是有些网页)的地方。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">class scrapy.Spider</code>是最基本的类，所有编写的爬虫必须继承这个类。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">主要用到的函数及调用顺序为：</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">__init__()</code>&nbsp;: 初始化爬虫名字和 start_urls 列表</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">start_requests() 调用 make_requests_from_url()</code>: 生成 Requests 对象交给 Scrapy 下载并返回 response</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">parse()</code>&nbsp;: 解析 response，并返回 Item 或 Requests（需指定回调函数）。Item 传给 Item pipline 持久化 ， 而 Requests 交由 Scrapy 下载，并由指定的回调函数处理（默认 parse())，一直进行循环，直到处理完所有的数据为止。</p><h4 id="blogTitle82" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">源码参考</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#所有爬虫的基类，用户定义的爬虫必须从这个类继承</span>
<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">Spider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object_ref)</span>:</span>

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 定义 spider 名字的字符串(string)。spider 的名字定义了 Scrapy 如何定位(并初始化) spider，所以其必须是唯一的。</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># name 是 spider 最重要的属性，而且是必须的。</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 一般做法是以该网站(domain)(加或不加 后缀 )来命名 spider。 例如，如果 spider 爬取 mywebsite.com ，该 spider 通常会被命名为 mywebsite</span>
    name = <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">None</span>

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 初始化，提取爬虫名字，start_ruls</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">__init__</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, name=None, **kwargs)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> name <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">is</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">None</span>:
            self.name = name
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 如果爬虫没有名字，中断后续操作并报错</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">elif</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> getattr(self, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'name'</span>, <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">None</span>):
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">raise</span> ValueError(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"%s must have a name"</span> % type(self).__name__)

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># python 对象或类型通过内置成员 __dict__ 来存储成员信息</span>
        self.__dict__.update(kwargs)

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># URL 列表。当没有指定的 URL 时，spider 将从该列表中开始进行爬取。 因此，第一个被获取到的页面的 URL 将是该列表之一。 后续的 URL 将会从获取到的数据中提取。</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> hasattr(self, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'start_urls'</span>):
            self.start_urls = []

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 打印 Scrapy 执行后的 log 信息</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">log</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, message, level=log.DEBUG, **kw)</span>:</span>
        log.msg(message, spider=self, level=level, **kw)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 判断对象 object 的属性是否存在，不存在做断言处理</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">set_crawler</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, crawler)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">assert</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> hasattr(self, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'_crawler'</span>), <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Spider already bounded to %s"</span> % crawler
        self._crawler = crawler

<span class="hljs-decorator" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">    @property</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">crawler</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">assert</span> hasattr(self, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'_crawler'</span>), <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Spider not bounded to any crawler"</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> self._crawler

<span class="hljs-decorator" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">    @property</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">settings</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> self.crawler.settings

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#该方法将读取start_urls内的地址，并为每一个地址生成一个Request对象，交给Scrapy下载并返回Response</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#该方法仅调用一次</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">start_requests</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> url <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> self.start_urls:
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> self.make_requests_from_url(url)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#start_requests()中调用，实际生成Request的函数。</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#Request对象默认的回调函数为parse()，提交的方式为get</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">make_requests_from_url</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, url)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> Request(url, dont_filter=<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#默认的 Request 对象回调函数，处理返回的 response。</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#生成 Item 或者 Request 对象。用户必须实现这个类</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">raise</span> NotImplementedError

<span class="hljs-decorator" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">    @classmethod</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">handles_request</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(cls, request)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> url_is_from_spider(request.url, cls)

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">__str__</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"&lt;%s %r at 0x%0x&gt;"</span> % (type(self).__name__, self.name, id(self))

    __repr__ = __str__</code></pre><h4 id="blogTitle83" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">主要属性和方法</h4><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">name</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; break-inside: avoid; margin: 0px; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">定义spider名字的字符串。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">例如，如果spider爬取 mywebsite.com ，该spider通常会被命名为 mywebsite</p></blockquote></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">allowed_domains</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; break-inside: avoid; margin: 0px; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">包含了spider允许爬取的域名(domain)的列表，可选。</p></blockquote></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">start_urls</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; break-inside: avoid; margin: 0px; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">初始URL元祖/列表。当没有制定特定的URL时，spider将从该列表中开始进行爬取。</p></blockquote></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">start_requests(self)</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; break-inside: avoid; margin: 0px; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">该方法必须返回一个可迭代对象(iterable)。该对象包含了spider用于爬取（默认实现是使用 start_urls 的url）的第一个Request。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">当spider启动爬取并且未指定start_urls时，该方法被调用。</p></blockquote></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">parse(self, response)</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; break-inside: avoid; margin: 0px; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">当请求url返回网页没有指定回调函数时，默认的Request对象回调函数。用来处理网页返回的response，以及生成Item或者Request对象。</p></blockquote></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">log(self, message[, level, component])</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; break-inside: avoid; margin: 0px; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">使用 scrapy.log.msg() 方法记录(log)message。 更多数据请参见&nbsp;<a href="4.7.html" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">logging</a></p></blockquote></li></ul><h3 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle84">案例：腾讯招聘网自动翻页采集</h3><p></p><h4 id="blogTitle85">创建一个新的爬虫</h4><p></p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">scrapy genspider tencent "tencent.com"</code></p><h4 id="blogTitle86">编写 items.py<br></h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">获取职位名称、详细信息、</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); white-space: pre-wrap; letter-spacing: 0.2px; font-size: 16px; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; color: rgb(101, 123, 131);"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">TencentItem</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Item)</span>:</span>
    name = scrapy.Field()
    detailLink = scrapy.Field()
    positionInfo = scrapy.Field()
    peopleNumber = scrapy.Field()
    workLocation = scrapy.Field()
    publishTime = scrapy.Field()</code></pre><h4 id="blogTitle87">编写 Spider：tencent.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># tencent.py</span>

<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> mySpider.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> TencentItem
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> re

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">TencentSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"tencent"</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"hr.tencent.com"</span>]
    start_urls = [
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://hr.tencent.com/position.php?&amp;start=0#a"</span>
    ]

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> each <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//*[@class="even"]'</span>):

            item = TencentItem()
            name = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[1]/a/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            detailLink = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[1]/a/@href'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            positionInfo = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[2]/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            peopleNumber = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[3]/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            workLocation = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[4]/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            publishTime = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[5]/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]

            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#print name, detailLink, catalog, peopleNumber, workLocation,publishTime</span>

            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'name'</span>] = name.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'detailLink'</span>] = detailLink.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'positionInfo'</span>] = positionInfo.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'peopleNumber'</span>] = peopleNumber.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'workLocation'</span>] = workLocation.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'publishTime'</span>] = publishTime.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)

            curpage = re.search(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'(\d+)'</span>,response.url).group(<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1</span>)
            page = int(curpage) + <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">10</span>
            url = re.sub(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'\d+'</span>, str(page), response.url)

            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 发送新的 url 请求加入待爬队列，并调用回调函数 self.parse</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.Request(url, callback = self.parse)

            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 将获取的数据交给 pipeline</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> item</code></pre><h4 id="blogTitle88"><span style="font-size: inherit; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">编写 pipeline.py 文件</span></h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> json

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">TencentJsonPipeline</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object)</span>:</span>

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">__init__</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        self.file = open(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'tencent.json'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'wb'</span>)

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">process_item</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, item, spider)</span>:</span>
        content = json.dumps(dict(item), ensure_ascii=<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">False</span>) + <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"\n"</span>
        self.file.write(content)
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> item

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">close_spider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, spider)</span>:</span>
        self.file.close()</code></pre><h4 id="blogTitle89"><span style="font-size: inherit; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">在 setting.py 里设置 ITEM_PIPELINES</span></h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">ITEM_PIPELINES = {
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#'mySpider.pipelines.SomePipeline': 300,</span>
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"mySpider.pipelines.TencentJsonPipeline"</span>:<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">300</span>
}</code></pre><h4 id="blogTitle90"><span style="font-size: inherit; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">执行爬虫</span></h4><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">scrapy crawl tencent</code></li></ul><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle91">思考</h4><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle92">请思考 parse() 方法的工作机制：</h5><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">
<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1.</span> 因为使用的 <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span>，而不是 <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span>。parse 函数将会被当做一个生成器使用。scrapy 会逐一获取 parse 方法中生成的结果，并判断该结果是一个什么样的类型；
<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">2.</span> 如果是 request 则加入爬取队列，如果是 item 类型则使用 pipeline 处理，其他类型则返回错误信息。
<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">3.</span> scrapy 取到第一部分的 request 不会立马就去发送这个 request，只是把这个 request 放到队列里，然后接着从生成器里获取；
<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">4.</span> 取尽第一部分的 request，然后再获取第二部分的 item，取到 item了，就会放到对应的 pipeline 里处理；
<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">5.</span> parse() 方法作为回调函数(callback)赋值给了 Request，指定 parse() 方法来处理这些请求 scrapy.Request(url, callback=self.parse)
<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">6.</span> Request 对象经过调度，执行生成 scrapy.http.response() 的响应对象，并送回给 parse() 方法，直到调度器中没有 Request（递归的思路）
<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">7.</span> 取尽之后，parse() 工作结束，引擎再根据队列和 pipelines 中的内容去执行相应的操作；
<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">8.</span> 程序在取得各个页面的 items 前，会先处理完之前所有的 request 队列里的请求，然后再提取 items。
<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">7.</span> 这一切的一切，Scrapy 引擎和调度器将负责到底。</code></pre></div><h3 id="blogTitle93">CrawlSpiders</h3><div><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">通过下面的命令可以快速创建 CrawlSpider 模板 的代码：</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">scrapy genspider -t crawl tencent tencent.com</code></p></blockquote><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">上一个案例中，我们通过正则表达式，制作了新的 url 作为 Request 请求参数，现在我们可以换个花样...</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">class scrapy.spiders.CrawlSpider</code></p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">它是 Spider 的派生类，Spider 类的设计原则是只爬取 start_urls 列表中的网页，而 CrawlSpider 类定义了一些规则 (rule) 来提供跟进 link，从爬取的网页中获取 link 并继续爬取。</p><h4 id="blogTitle94" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">源码参考</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">CrawlSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(Spider)</span>:</span>
    rules = ()
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">__init__</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, *a, **kw)</span>:</span>
        super(CrawlSpider, self).__init__(*a, **kw)
        self._compile_rules()

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 首先调用 parse()来处理 start_urls 中返回的 response 对象</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># parse() 则将这些 response 对象传递给了 _parse_response() 函数处理，并设置回调函数为 parse_start_url()</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 设置了跟进标志位 True</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># parse 将返回 item 和跟进了的 Request 对象    </span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> self._parse_response(response, self.parse_start_url, cb_kwargs={}, follow=<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 处理 start_url 中返回的 response，需要重写</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse_start_url</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> []

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">process_results</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response, results)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> results

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 从 response 中抽取符合任一用户定义'规则'的链接，并构造成 Resquest 对象返回</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">_requests_to_follow</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> isinstance(response, HtmlResponse):
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span>
        seen = set()
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 抽取之内的所有链接，只要通过任意一个'规则'，即表示合法</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> n, rule <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> enumerate(self._rules):
            links = [l <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> l <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> rule.link_extractor.extract_links(response) <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> l <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> seen]
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 使用用户指定的 process_links 处理每个连接</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> links <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">and</span> rule.process_links:
                links = rule.process_links(links)
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 将链接加入 seen 集合，为每个链接生成 Request 对象，并设置回调函数为 _repsonse_downloaded()</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> link <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> links:
                seen.add(link)
                <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 构造 Request 对象，并将 Rule 规则中定义的回调函数作为这个 Request 对象的回调函数</span>
                r = Request(url=link.url, callback=self._response_downloaded)
                r.meta.update(rule=n, link_text=link.text)
                <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 对每个 Request 调用 process_request() 函数。该函数默认为 indentify，即不做任何处理，直接返回该Request.</span>
                <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> rule.process_request(r)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 处理通过 rule 提取出的连接，并返回 item 以及 request</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">_response_downloaded</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        rule = self._rules[response.meta[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'rule'</span>]]
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> self._parse_response(response, rule.callback, rule.cb_kwargs, rule.follow)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 解析 response 对象，会用 callback 解析处理他，并返回 request 或 Item 对象</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">_parse_response</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response, callback, cb_kwargs, follow=True)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 首先判断是否设置了回调函数。（该回调函数可能是 rule 中的解析函数，也可能是 parse_start_url函数）</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 如果设置了回调函数（parse_start_url()），那么首先用parse_start_url()处理response对象，</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 然后再交给 process_results 处理。返回 cb_res 的一个列表</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> callback:
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#如果是parse调用的，则会解析成Request对象</span>
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#如果是rule callback，则会解析成 Item</span>
            cb_res = callback(response, **cb_kwargs) <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">or</span> ()
            cb_res = self.process_results(response, cb_res)
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> requests_or_item <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> iterate_spider_output(cb_res):
                <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> requests_or_item

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#如果需要跟进，那么使用定义的Rule规则提取并返回这些Request对象</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> follow <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">and</span> self._follow_links:
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#返回每个Request对象</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> request_or_item <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> self._requests_to_follow(response):
                <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> request_or_item

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">_compile_rules</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">get_method</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(method)</span>:</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> callable(method):
                <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> method
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">elif</span> isinstance(method, basestring):
                <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> getattr(self, method, <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">None</span>)

        self._rules = [copy.copy(r) <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> r <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> self.rules]
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> rule <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> self._rules:
            rule.callback = get_method(rule.callback)
            rule.process_links = get_method(rule.process_links)
            rule.process_request = get_method(rule.process_request)

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">set_crawler</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, crawler)</span>:</span>
        super(CrawlSpider, self).set_crawler(crawler)
        self._follow_links = crawler.settings.getbool(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'CRAWLSPIDER_FOLLOW_LINKS'</span>, <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>)
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">CrawlSpider 继承于 Spider 类，除了继承过来的属性外（name、allow_domains），还提供了新的属性和方法:</p><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle95">LinkExtractors</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">class scrapy.linkextractors.LinkExtractor
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Link Extractors 的目的很简单: 提取链接｡</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">每个 LinkExtractor 有唯一的公共方法是 extract_links()，它接收一个 Response 对象，并返回一个 scrapy.link.Link 对象。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Link Extractors 要实例化一次，并且 extract_links 方法会根据不同的 response 调用多次提取链接｡</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">class scrapy.linkextractors.LinkExtractor(
    allow = (),
    deny = (),
    allow_domains = (),
    deny_domains = (),
    deny_extensions = None,
    restrict_xpaths = (),
    tags = ('a','area'),
    attrs = ('href'),
    canonicalize = True,
    unique = True,
    process_value = None
)
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">主要参数：</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">allow</code>：满足括号中“正则表达式”的值会被提取，如果为空，则全部匹配。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">deny</code>：与这个正则表达式(或正则表达式列表)不匹配的 URL 一定不提取。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">allow_domains</code>：会被提取的链接的 domains。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">deny_domains</code>：一定不会被提取链接的 domains。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">restrict_xpaths</code>：使用 xpath 表达式，和 allow 共同作用过滤链接。</p></li></ul><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle96">rules</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">在 rules 中包含一个或多个 Rule 对象，每个 Rule 对爬取网站的动作定义了特定操作。如果多个 rule 匹配了相同的链接，则根据规则在本集合中被定义的顺序，第一个会被使用。</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">
class scrapy.spiders.Rule(
        link_extractor,
        callback = None,
        cb_kwargs = None,
        follow = None,
        process_links = None,
        process_request = None
)
</code></pre><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">link_extractor</code>：是一个 Link Extractor 对象，用于定义需要提取的链接。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">callback</code>： 从 link_extractor 中每获取到链接时，参数所指定的值作为回调函数，该回调函数接受一个 response 作为其第一个参数。</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; break-inside: avoid; margin: 0px; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">注意：当编写爬虫规则时，避免使用 parse 作为回调函数。由于 CrawlSpider 使用 parse 方法来实现其逻辑，如果覆盖了 parse 方法，crawl spider 将会运行失败。</p></blockquote></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">follow</code>：是一个布尔(boolean)值，指定了根据该规则从 response 提取的链接是否需要跟进。 如果 callback 为 None，follow 默认设置为 True ，否则默认为 False。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">process_links</code>：指定该 spider 中哪个的函数将会被调用，从 link_extractor 中获取到链接列表时将会调用该函数。该方法主要用来过滤。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">process_request</code>：指定该 spider 中哪个的函数将会被调用， 该规则提取到每个 request 时都会调用该函数。 (用来过滤 request)</p></li></ul><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle97">爬取规则 (Crawling rules)</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">继续用腾讯招聘为例，给出配合 rule 使用 CrawlSpider 的例子:</p><ol style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">首先运行</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: inherit; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227);"><code class="lang-sh" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"> scrapy shell <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://hr.tencent.com/position.php?&amp;start=0#a"</span>
</code></pre></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">导入 LinkExtractor，创建 LinkExtractor 实例对象。：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: inherit; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227);"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.linkextractors <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> LinkExtractor

 page_lx = LinkExtractor(allow=(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'position.php?&amp;start=\d+'</span>))
</code></pre><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; break-inside: avoid; margin: 0px; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">allow : LinkExtractor 对象最重要的参数之一，这是一个正则表达式，必须要匹配这个正则表达式(或正则表达式列表)的 URL 才会被提取，如果没有给出(或为空), 它会匹配所有的链接｡</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">deny : 用法同 allow，只不过与这个正则表达式匹配的 URL 不会被提取)｡它的优先级高于 allow 的参数，如果没有给出(或 None), 将不排除任何链接｡</p></blockquote></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">调用 LinkExtractor 实例的 extract_links() 方法查询匹配结果：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: inherit; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227);"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"> page_lx.extract_links(response)
</code></pre></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">没有查到：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: inherit; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227);"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"> []
</code></pre></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">注意转义字符的问题，继续重新匹配：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: inherit; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227);"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"> page_lx = LinkExtractor(allow=(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'position\.php\?&amp;start=\d+'</span>))
 <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># page_lx = LinkExtractor(allow = ('start=\d+'))</span>

 page_lx.extract_links(response)
</code></pre></li></ol><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><img src="../images/tencent_rule.png" alt="" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; border: 0px; font-size: inherit; break-inside: avoid; max-width: 100%;"></p><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle98">CrawlSpider 版本</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">那么，scrapy shell 测试完成之后，修改以下代码</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#提取匹配 'http://hr.tencent.com/position.php?&amp;start=\d+'的链接</span>
page_lx = LinkExtractor(allow = (<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'start=\d+'</span>))

rules = [
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#提取匹配,并使用spider的parse方法进行分析;并跟进链接(没有callback意味着follow默认为True)</span>
    Rule(page_lx, callback = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parse'</span>, follow = <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>)
]
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><span style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-weight: 700; font-size: inherit;">这么写对吗？</span></p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><span style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-weight: 700; font-size: inherit;">不对！千万记住 callback 千万不能写 parse，再次强调：由于 CrawlSpider 使用 parse 方法来实现其逻辑，如果覆盖了 parse 方法，crawl spider 将会运行失败。</span></p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># tencent.py</span>

<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.spiders <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> CrawlSpider, Rule
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.linkextractors <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> LinkExtractor
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> mySpider.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> TencentItem

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">TencentSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(CrawlSpider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"tencent"</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"hr.tencent.com"</span>]
    start_urls = [
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://hr.tencent.com/position.php?&amp;start=0#a"</span>
    ]

    page_lx = LinkExtractor(allow=(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"start=\d+"</span>))

    rules = [
        Rule(page_lx, callback = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"parseContent"</span>, follow = <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>)
    ]

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parseContent</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> each <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//*[@class="even"]'</span>):
            name = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[1]/a/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            detailLink = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[1]/a/@href'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            positionInfo = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[2]/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]

            peopleNumber = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[3]/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            workLocation = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[4]/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            publishTime = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'./td[5]/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#print name, detailLink, catalog,recruitNumber,workLocation,publishTime</span>

            item = TencentItem()
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'name'</span>]=name.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'detailLink'</span>]=detailLink.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'positionInfo'</span>]=positionInfo.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'peopleNumber'</span>]=peopleNumber.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'workLocation'</span>]=workLocation.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'publishTime'</span>]=publishTime.encode(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)

            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> item

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># parse() 方法不需要写     </span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># def parse(self, response):                                              </span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#     pass</span>
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">运行：&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">scrapy crawl tencent</code></p><h3 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle99">Logging</h3><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Scrapy 提供了 log 功能，可以通过 logging 模块使用。</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">可以修改配置文件 settings.py，任意位置添加下面两行，效果会清爽很多。</p></blockquote><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); white-space: pre-wrap; letter-spacing: 0.2px; font-size: 16px; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; color: rgb(101, 123, 131);"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">LOG_FILE = "TencentSpider.log"
LOG_LEVEL = "INFO"</code></pre><h4 id="blogTitle100" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">Log levels</h4><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">Scrapy 提供 5 层 logging 级别:</p></li><ul><li>CRITICAL - 严重错误(critical)</li><li>ERROR - 一般错误(regular errors)</li><li>WARNING - 警告信息(warning messages)</li><li>INFO - 一般信息(informational messages)</li><li>DEBUG - 调试信息(debugging messages)</li></ul></ul><h4 id="blogTitle101" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">logging 设置</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">通过在 setting.py 中进行以下设置可以被用来配置 logging:</p><ol style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">LOG_ENABLED</code>&nbsp;默认: True，启用 logging</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">LOG_ENCODING</code>&nbsp;默认: 'utf-8'，logging 使用的编码</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">LOG_FILE</code>&nbsp;默认: None，在当前目录里创建 logging 输出文件的文件名</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">LOG_LEVEL</code>&nbsp;默认: 'DEBUG'，log 的最低级别</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">LOG_STDOUT</code>&nbsp;默认: False 如果为 True，进程所有的标准输出(及错误)将会被重定向到 log 中。例如，执行 print "hello" ，其将会在 Scrapy log 中显示。</li></ol></div><h3 id="blogTitle102">Request/Response</h3><h4 id="blogTitle103">Request</h4><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Request 部分源码：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 部分代码</span>
<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">Request</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object_ref)</span>:</span>

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">__init__</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, url, callback=None, method=<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'GET'</span>, headers=None, body=None,
                 cookies=None, meta=None, encoding=<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>, priority=<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>,
                 dont_filter=False, errback=None)</span>:</span>

        self._encoding = encoding  <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># this one has to be set first</span>
        self.method = str(method).upper()
        self._set_url(url)
        self._set_body(body)
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">assert</span> isinstance(priority, int), <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Request priority not an integer: %r"</span> % priority
        self.priority = priority

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">assert</span> callback <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">or</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> errback, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Cannot use errback without a callback"</span>
        self.callback = callback
        self.errback = errback

        self.cookies = cookies <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">or</span> {}
        self.headers = Headers(headers <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">or</span> {}, encoding=encoding)
        self.dont_filter = dont_filter

        self._meta = dict(meta) <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> meta <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">else</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">None</span>

<span class="hljs-decorator" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">    @property</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">meta</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> self._meta <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">is</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">None</span>:
            self._meta = {}
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> self._meta
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">其中，比较常用的参数：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">url: 就是需要请求，并进行下一步处理的 url

callback: 指定该请求返回的 Response，由那个函数来处理。

method: 请求一般不需要指定，默认GET方法，可设置为<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"GET"</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"POST"</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"PUT"</span>等，且保证字符串大写

headers: 请求时，包含的头文件。一般不需要。内容一般如下：
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 自己写过爬虫的肯定知道</span>
        Host: media.readthedocs.org
        User-Agent: Mozilla/<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">5.0</span> (Windows NT <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">6.2</span>; WOW64; rv:<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">33.0</span>) Gecko/<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">20100101</span> Firefox/<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">33.0</span>
        Accept: text/css,*/*;q=<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0.1</span>
        Accept-Language: zh-cn,zh;q=<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0.8</span>,en-us;q=<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0.5</span>,en;q=<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0.3</span>
        Accept-Encoding: gzip, deflate
        Referer: http://scrapy-chs.readthedocs.org/zh_CN/<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0.24</span>/
        Cookie: _ga=GA1<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">.2</span><span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">.1612165614</span><span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">.1415584110</span>;
        Connection: keep-alive
        If-Modified-Since: Mon, <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">25</span> Aug <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">2014</span> <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">21</span>:<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">59</span>:<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">35</span> GMT
        Cache-Control: max-age=<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>

meta: 比较常用，在不同的请求之间传递数据使用的。字典 dict 型

        request_with_cookies = Request(
            url=<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://www.example.com"</span>,
            cookies={<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'currency'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'USD'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'country'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'UY'</span>},
            meta={<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'dont_merge_cookies'</span>: <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>}
        )

encoding: 使用默认的 <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span> 就行。

dont_filter: 表明该请求不由调度器过滤。这是当你想使用多次执行相同的请求,忽略重复的过滤器。默认为<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">False</span>。

errback: 指定错误处理函数</code></pre><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; margin: 1.275em 0px 0.85em; break-after: avoid; border-color: inherit;" id="blogTitle104">Response</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 部分代码</span>
<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">Response</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object_ref)</span>:</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">__init__</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, url, status=<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">200</span>, headers=None, body=<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">''</span>, flags=None, request=None)</span>:</span>
        self.headers = Headers(headers <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">or</span> {})
        self.status = int(status)
        self._set_body(body)
        self._set_url(url)
        self.request = request
        self.flags = [] <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> flags <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">is</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">None</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">else</span> list(flags)

<span class="hljs-decorator" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">    @property</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">meta</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">try</span>:
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> self.request.meta
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">except</span> AttributeError:
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">raise</span> AttributeError(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Response.meta not available, this response "</span> \
                <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"is not tied to any request"</span>)
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">大部分参数和上面的差不多：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">
status: 响应码
_set_body(body)： 响应体
_set_url(url)：响应url
self.request = request</code></pre><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle105">发送 POST 请求</h4><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">可以使用&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">yield scrapy.FormRequest(url, formdata, callback)</code>方法发送 POST 请求。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">如果希望程序执行一开始就发送 POST 请求，可以重写 Spider 类的&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">start_requests(self)</code>&nbsp;方法，并且不再调用 start_urls 里的url。</p></li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">mySpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># start_urls = ["http://www.example.com/"]</span>

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">start_requests</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        url = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://www.renren.com/PLogin.do'</span>

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># FormRequest 是Scrapy发送POST请求的方法</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.FormRequest(
            url = url,
            formdata = {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"email"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"mr_mao_hacker@163.com"</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"password"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"axxxxxxxe"</span>},
            callback = self.parse_page
        )
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse_page</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># do something</span></code></pre><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle106">模拟登陆</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">使用 FormRequest.from_response() 方法<a href="http://docs.pythontab.com/scrapy/scrapy0.24/topics/request-response.html#topics-request-response-ref-request-userlogin" target="_blank" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">模拟用户登录</a></p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">通常网站通过&nbsp;实现对某些表单字段（如数据或是登录界面中的认证令牌等）的预填充。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">使用 Scrapy 抓取网页时，如果想要预填充或重写像用户名、用户密码这些表单字段， 可以使用 FormRequest.from_response() 方法实现。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">下面是使用这种方法的爬虫例子:</p></blockquote><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">LoginSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'example.com'</span>
    start_urls = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://www.example.com/users/login.php'</span>]

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> scrapy.FormRequest.from_response(
            response,
            formdata={<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'username'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'john'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'password'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'secret'</span>},
            callback=self.after_login
        )

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">after_login</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># check login succeed before going on</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"authentication failed"</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> response.body:
            self.log(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Login failed"</span>, level=log.ERROR)
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span>

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># continue scraping with authenticated session...</span></code></pre><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle107">知乎爬虫案例参考：</h4><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle108">zhihuSpider.py 爬虫代码</h5><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#!/usr/bin/env python</span>
<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># -*- coding:utf-8 -*-</span>
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.spiders <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> CrawlSpider, Rule
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.selector <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> Selector
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.linkextractors <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> LinkExtractor
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> Request, FormRequest
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> zhihu.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> ZhihuItem

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">ZhihuSipder</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(CrawlSpider)</span> :</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"zhihu"</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"www.zhihu.com"</span>]
    start_urls = [
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://www.zhihu.com"</span>
    ]
    rules = (
        Rule(LinkExtractor(allow = (<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'/question/\d+#.*?'</span>, )), callback = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parse_page'</span>, follow = <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>),
        Rule(LinkExtractor(allow = (<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'/question/\d+'</span>, )), callback = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parse_page'</span>, follow = <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>),
    )

    headers = {
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Accept"</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"*/*"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Accept-Encoding"</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"gzip,deflate"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Accept-Language"</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"en-US,en;q=0.8,zh-TW;q=0.6,zh;q=0.4"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Connection"</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"keep-alive"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Content-Type"</span>:<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">" application/x-www-form-urlencoded; charset=UTF-8"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"User-Agent"</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.111 Safari/537.36"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Referer"</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://www.zhihu.com/"</span>
    }

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#重写了爬虫类的方法, 实现了自定义请求, 运行成功后会调用callback回调函数</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">start_requests</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> [Request(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"https://www.zhihu.com/login"</span>, meta = {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'cookiejar'</span> : <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1</span>}, callback = self.post_login)]

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">post_login</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">print</span> <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'Preparing login'</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#下面这句话用于抓取请求网页后返回网页中的_xsrf字段的文字, 用于成功提交表单</span>
        xsrf = Selector(response).xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//input[@name="_xsrf"]/@value'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">print</span> xsrf
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#FormRequeset.from_response是Scrapy提供的一个函数, 用于post表单</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#登陆成功后, 会调用after_login回调函数</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> [FormRequest.from_response(response,   <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#"http://www.zhihu.com/login",</span>
                            meta = {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'cookiejar'</span> : response.meta[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'cookiejar'</span>]},
                            headers = self.headers,  <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#注意此处的headers</span>
                            formdata = {
                            <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'_xsrf'</span>: xsrf,
                            <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'email'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'1095511864@qq.com'</span>,
                            <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'password'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'123456'</span>
                            },
                            callback = self.after_login,
                            dont_filter = <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>
                            )]

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">after_login</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span> :</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> url <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> self.start_urls :
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> self.make_requests_from_url(url)

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse_page</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        problem = Selector(response)
        item = ZhihuItem()
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'url'</span>] = response.url
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'name'</span>] = problem.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//span[@class="name"]/text()'</span>).extract()
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">print</span> item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'name'</span>]
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'title'</span>] = problem.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//h2[@class="zm-item-title zm-editable-content"]/text()'</span>).extract()
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'description'</span>] = problem.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[@class="zm-editable-content"]/text()'</span>).extract()
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'answer'</span>]= problem.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[@class=" zm-editable-content clearfix"]/text()'</span>).extract()
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> item
</code></pre><h4 id="blogTitle109" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Item 类设置</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.item <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> Item, Field

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">ZhihuItem</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(Item)</span>:</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># define the fields for your item here like:</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># name = scrapy.Field()</span>
    url = Field()  <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#保存抓取问题的url</span>
    title = Field()  <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#抓取问题的标题</span>
    description = Field()  <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#抓取问题的描述</span>
    answer = Field()  <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#抓取问题的答案</span>
    name = Field()  <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#个人用户的名称</span></code></pre><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle110">setting.py 设置抓取间隔</h5><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">BOT_NAME = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'zhihu'</span>

SPIDER_MODULES = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'zhihu.spiders'</span>]
NEWSPIDER_MODULE = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'zhihu.spiders'</span>
DOWNLOAD_DELAY = <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0.25</span>   <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#设置下载间隔为250ms</span></code></pre></div><h3 id="blogTitle111">反反爬虫相关机制</h3><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Some websites implement certain measures to prevent bots from crawling them, with varying degrees of sophistication. Getting around those measures can be difficult and tricky, and may sometimes require special infrastructure. Please consider contacting commercial support if in doubt.</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">(有些网站使用特定的不同程度的复杂性规则防止爬虫访问，绕过这些规则是困难和复杂的，有时可能需要特殊的基础设施，如果有疑问，请联系商业支持。)</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">来自于Scrapy官方文档描述：<a href="http://doc.scrapy.org/en/master/topics/practices.html#avoiding-getting-banned" target="_blank" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">http://doc.scrapy.org/en/master/topics/practices.html#avoiding-getting-banned</a></p></blockquote><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle112">通常防止爬虫被反主要有以下几个策略：</h4><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">动态设置 User-Agent（随机切换 User-Agent，模拟不同用户的浏览器信息）</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">禁用 Cookies（也就是不启用 cookies middleware，不向 Server 发送 cookies，有些网站通过 cookie 的使用发现爬虫行为）</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">可以通过<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">COOKIES_ENABLED</code>&nbsp;控制 CookiesMiddleware 开启或关闭</li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">设置延迟下载（防止访问过于频繁，设置为 2秒 或更高）</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">Google Cache 和 Baidu Cache：如果可能的话，使用谷歌/百度等搜索引擎服务器页面缓存获取页面数据。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">使用 IP 地址池：VPN 和代理 IP，现在大部分网站都是根据 IP 来 ban 的。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">使用&nbsp;<a href="https://scrapinghub.com/crawlera" target="_blank" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">Crawlera</a>（专用于爬虫的代理组件），正确配置和设置下载中间件后，项目所有的 request 都是通过 crawlera 发出。</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: inherit; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227);"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">  DOWNLOADER_MIDDLEWARES = {
      'scrapy_crawlera.CrawleraMiddleware': 600
  }

  CRAWLERA_ENABLED = True
  CRAWLERA_USER = '注册/购买的UserKey'
  CRAWLERA_PASS = '注册/购买的Password'</code></pre></li></ul><h3 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle113">下载中间件（Downloader Middlewares）</h3><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">下载中间件是处于引擎 (crawler.engine) 和下载器 (crawler.engine.download()) 之间的一层组件，可以有多个下载中间件被加载运行。</p><ol style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">当引擎传递请求给下载器的过程中，下载中间件可以对请求进行处理 （例如增加 http header 信息，增加 proxy 信息等）；</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">在下载器完成 http 请求，传递响应给引擎的过程中，下载中间件可以对响应进行处理（例如进行 gzip 的解压等）</p></li></ol><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">要激活下载器中间件组件，将其加入到 DOWNLOADER_MIDDLEWARES 设置中。 该设置是一个字典(dict)，键为中间件类的路径，值为其中间件的顺序(order)。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">这里是一个例子:</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">DOWNLOADER_MIDDLEWARES = {
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'mySpider.middlewares.MyDownloaderMiddleware'</span>: <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">543</span>,
}
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">编写下载器中间件十分简单。每个中间件组件是一个定义了以下一个或多个方法的 Python 类:</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">class scrapy.contrib.downloadermiddleware.DownloaderMiddleware</code></pre><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle114">process_request(self, request, spider)</h4><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">当每个 request 通过下载中间件时，该方法被调用。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">process_request() 必须返回以下其中之一：一个 None 、一个 Response 对象、一个 Request 对象或 raise IgnoreRequest:</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">如果其返回 None ，Scrapy 将继续处理该 request，执行其他的中间件的相应方法，直到合适的下载器处理函数(download handler)被调用， 该 request 被执行(其 response 被下载)。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">如果其返回 Response 对象，Scrapy 将不会调用 任何 其他的 process_request() 或 process_exception() 方法，或相应地下载函数； 其将返回该 response。 已安装的中间件的 process_response() 方法则会在每个 response 返回时被调用。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">如果其返回 Request 对象，Scrapy 则停止调用 process_request 方法并重新调度返回的request。当新返回的 request 被执行后， 相应地中间件链将会根据下载的 response 被调用。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">如果其raise一个 IgnoreRequest 异常，则安装的下载中间件的 process_exception() 方法会被调用。如果没有任何一个方法处理该异常， 则 request 的 errback(Request.errback) 方法会被调用。如果没有代码处理抛出的异常， 则该异常被忽略且不记录(不同于其他异常那样)。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">参数:</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">request (Request 对象)</code>&nbsp;– 处理的request</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">spider (Spider 对象)</code>&nbsp;– 该request对应的spider</li></ul></li></ul><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle115">process_response(self, request, response, spider)</h4><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">当下载器完成 http 请求，传递响应给引擎的时候调用</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">process_request() 必须返回以下其中之一: 返回一个 Response 对象、 返回一个 Request 对象或 raise 一个 IgnoreRequest 异常。</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">如果其返回一个 Response (可以与传入的response相同，也可以是全新的对象)， 该response会被在链中的其他中间件的 process_response() 方法处理。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">如果其返回一个 Request 对象，则中间件链停止， 返回的request会被重新调度下载。处理类似于 process_request() 返回request所做的那样。</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">如果其抛出一个 IgnoreRequest 异常，则调用request的errback(Request.errback)。 如果没有代码处理抛出的异常，则该异常被忽略且不记录(不同于其他异常那样)。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">参数:</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">request (Request 对象)</code>&nbsp;– response所对应的request</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">response (Response 对象)</code>&nbsp;– 被处理的response</li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">spider (Spider 对象)</code>&nbsp;– response所对应的spider</li></ul></li></ul><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle116">使用案例：</h4><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle117">1. 创建<font color="#657b83" face="Consolas, Liberation Mono, Menlo, Courier, monospace"><span style="font-size: 0.85em; letter-spacing: 0.2px; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-inside: avoid; border-width: initial; border-color: rgb(248, 223, 156); border-image: initial; padding: 0.2em; background: rgb(253, 246, 227);">middlewares.py</span></font>文件。</h5><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Scrapy 代理 IP、Uesr-Agent 的切换都是通过<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">DOWNLOADER_MIDDLEWARES</code>进行控制，我们在<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">settings.py</code>同级目录下创建<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">middlewares.py</code>文件，包装所有请求。</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># middlewares.py</span>

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#!/usr/bin/env python</span>
<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># -*- coding:utf-8 -*-</span>

<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> random
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> base64

<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> settings <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> USER_AGENTS
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> settings <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> PROXIES

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 随机的 User-Agent</span>
<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">RandomUserAgent</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object)</span>:</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">process_request</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, request, spider)</span>:</span>
        useragent = random.choice(USER_AGENTS)

        request.headers.setdefault(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"User-Agent"</span>, useragent)

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">RandomProxy</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object)</span>:</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">process_request</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, request, spider)</span>:</span>
        proxy = random.choice(PROXIES)

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> proxy[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'user_passwd'</span>] <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">is</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">None</span>:
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 没有代理账户验证的代理使用方式</span>
            request.meta[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'proxy'</span>] = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://"</span> + proxy[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'ip_port'</span>]
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">else</span>:
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 对账户密码进行base64编码转换</span>
            base64_userpasswd = base64.b64encode(proxy[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'user_passwd'</span>])
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 对应到代理服务器的信令格式里</span>
            request.headers[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'Proxy-Authorization'</span>] = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'Basic '</span> + base64_userpasswd
            request.meta[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'proxy'</span>] = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://"</span> + proxy[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'ip_port'</span>]
</code></pre><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">为什么 HTTP 代理要使用 base64 编码：</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">HTTP代理的原理很简单，就是通过HTTP协议与代理服务器建立连接，协议信令中包含要连接到的远程主机的IP和端口号，如果有需要身份验证的话还需要加上授权信息，服务器收到信令后首先进行身份验证，通过后便与远程主机建立连接，连接成功之后会返回给客户端200，表示验证通过，就这么简单，下面是具体的信令格式：</p></blockquote><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">CONNECT 59.64.128.198:21 HTTP/1.1
Host: 59.64.128.198:21
Proxy-Authorization: Basic bGV2I1TU5OTIz
User-Agent: OpenFetion
</code></pre><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">其中<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">Proxy-Authorization</code>是身份验证信息，Basic后面的字符串是用户名和密码组合后进行base64编码的结果，也就是对username:password进行base64编码。</p></blockquote><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">HTTP/1.0 200 Connection established
</code></pre><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">OK，客户端收到收面的信令后表示成功建立连接，接下来要发送给远程主机的数据就可以发送给代理服务器了，代理服务器建立连接后会在根据IP地址和端口号对应的连接放入缓存，收到信令后再根据IP地址和端口号从缓存中找到对应的连接，将数据通过该连接转发出去。</p></blockquote><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;" id="blogTitle118">2. 修改 settings.py 配置 USER_AGENTS 和 PROXIES</h5><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">添加 USER_AGENTS：</li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">　　USER_AGENTS = [
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5"</span>
    ]
</code></pre><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">添加代理 IP 设置 PROXIES：</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">免费代理 IP 可以网上搜索，或者付费购买一批可用的私密代理 IP：</p></li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">PROXIES = [
    {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'ip_port'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'111.8.60.9:8123'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'user_passwd'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'user1:pass1'</span>},
    {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'ip_port'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'101.71.27.120:80'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'user_passwd'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'user2:pass2'</span>},
    {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'ip_port'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'122.96.59.104:80'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'user_passwd'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'user3:pass3'</span>},
    {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'ip_port'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'122.224.249.122:8088'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'user_passwd'</span>: <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'user4:pass4'</span>},
]
</code></pre><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">除非特殊需要，禁用 cookies，防止某些网站根据 Cookie 来封锁爬虫。</li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">COOKIES_ENABLED = False
</code></pre><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">设置下载延迟</li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">DOWNLOAD_DELAY = 3
</code></pre><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">最后设置 setting.py 里的 DOWNLOADER_MIDDLEWARES，添加自己编写的下载中间件类。</li></ul><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">DOWNLOADER_MIDDLEWARES = {
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#'mySpider.middlewares.MyCustomDownloaderMiddleware': 543,</span>
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'mySpider.middlewares.RandomUserAgent'</span>: <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'mySpider.middlewares.ProxyMiddleware'</span>: <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">100</span>
}</code></pre></div><h3 id="blogTitle119">Settings</h3><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">Scrapy 设置(settings)提供了定制 Scrapy 组件的方法。可以控制包括核心(core)，插件(extension)，pipeline 及 spider 组件。比如 设置 Json Pipeliine、LOG_LEVEL 等。</p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">参考文档：<a href="http://scrapy-chs.readthedocs.io/zh_CN/1.0/topics/settings.html#topics-settings-ref" target="_blank" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">http://scrapy-chs.readthedocs.io/zh_CN/1.0/topics/settings.html#topics-settings-ref</a></p><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; border-color: inherit;" id="blogTitle120">内置设置参考手册</h4><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">BOT_NAME</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: 'scrapybot'</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">当您使用 startproject 命令创建项目时其也被自动赋值。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">CONCURRENT_ITEMS</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: 100</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">Item Processor(即 Item Pipeline) 同时处理(每个response的)item的最大值。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">CONCURRENT_REQUESTS</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: 16</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">Scrapy downloader 并发请求(concurrent requests)的最大值。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">DEFAULT_REQUEST_HEADERS</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: 如下</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: inherit; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227);"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">{
'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
'Accept-Language': 'en',
}
</code></pre><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">Scrapy HTTP Request 使用的默认 header。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">DEPTH_LIMIT</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: 0</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">爬取网站最大允许的深度(depth)值。如果为0，则没有限制。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">DOWNLOAD_DELAY</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: 0</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">下载器在下载同一个网站下一个页面前需要等待的时间。该选项可以用来限制爬取速度， 减轻服务器压力。同时也支持小数:</p></li></ul><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">DOWNLOAD_DELAY = 0.25 # 250 ms of delay</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">默认情况下，Scrapy 在两个请求间不等待一个固定的值， 而是使用0.5到1.5之间的一个随机值 * DOWNLOAD_DELAY 的结果作为等待间隔。</li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">DOWNLOAD_TIMEOUT</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: 180</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">下载器超时时间(单位: 秒)。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">ITEM_PIPELINES</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: {}</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">保存项目中启用的 pipeline 及其顺序的字典。该字典默认为空，值(value)任意，不过值(value)习惯设置在0-1000范围内，值越小优先级越高。</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: inherit; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227);"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">ITEM_PIPELINES = {
'mySpider.pipelines.SomethingPipeline': 300,
'mySpider.pipelines.ItcastJsonPipeline': 800,
}
</code></pre></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">LOG_ENABLED</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: True</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">是否启用logging。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">LOG_ENCODING</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: 'utf-8'</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">logging使用的编码。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">LOG_LEVEL</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: 'DEBUG'</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">log的最低级别。可选的级别有: CRITICAL、 ERROR、WARNING、INFO、DEBUG 。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">USER_AGENT</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">默认: "Scrapy/VERSION (+<a href="http://scrapy.org" target="_blank" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">http://scrapy.org</a>)"</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">爬取的默认User-Agent，除非被覆盖。</p></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">PROXIES</code>： 代理设置</p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">示例：</p><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: inherit; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227);"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">PROXIES = [
  {'ip_port': '111.11.228.75:80', 'password': ''},
  {'ip_port': '120.198.243.22:80', 'password': ''},
  {'ip_port': '111.8.60.9:8123', 'password': ''},
  {'ip_port': '101.71.27.120:80', 'password': ''},
  {'ip_port': '122.96.59.104:80', 'password': ''},
  {'ip_port': '122.224.249.122:8088', 'password':''},
]
</code></pre></li></ul></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: inherit;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">COOKIES_ENABLED = False</code></p><ul style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;">禁用Cookies</li></ul></li></ul></div><h2 id="blogTitle121">实战项目</h2><h3 id="blogTitle122">（案例一）手机 App 抓包爬虫</h3><div><h4 id="blogTitle123" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">1. items.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); white-space: pre-wrap; letter-spacing: 0.2px; font-size: 16px; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; color: rgb(101, 123, 131);"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">DouyuspiderItem</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Item)</span>:</span>
    name = scrapy.Field()<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 存储照片的名字</span>
    imagesUrls = scrapy.Field()<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 照片的url路径</span>
    imagesPath = scrapy.Field()<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 照片保存在本地的路径</span></code></pre><h4 id="blogTitle124" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">2. spiders/douyu.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> json
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> douyuSpider.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> DouyuspiderItem

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">DouyuSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"douyu"</span>
    allowd_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://capi.douyucdn.cn"</span>]

    offset = <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>
    url = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://capi.douyucdn.cn/api/v1/getVerticalRoom?limit=20&amp;offset="</span>
    start_urls = [url + str(offset)]

  <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
      <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 返回从json里获取 data段数据集合</span>
      data = json.loads(response.text)[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"data"</span>]

      <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> each <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> data:
          item = DouyuspiderItem()
          item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"name"</span>] = each[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"nickname"</span>]
          item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"imagesUrls"</span>] = each[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"vertical_src"</span>]

          <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> item

      self.offset += <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">20</span>
      <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.Request(self.url + str(self.offset), callback = self.parse)</code></pre><h4 id="blogTitle125" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">3. 设置 setting.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">
ITEM_PIPELINES = {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'douyuSpider.pipelines.ImagesPipeline'</span>: <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1</span>}

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># Images 的存放位置，之后会在pipelines.py里调用</span>
IMAGES_STORE = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"/Users/Power/lesson_python/douyuSpider/Images"</span>

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># user-agent</span>
USER_AGENT = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'DYZB/2.290 (iPhone; iOS 9.3.4; Scale/2.00)'</span></code></pre><h4 id="blogTitle126" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">4. pipelines.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> os
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.pipelines.images <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> ImagesPipeline
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.utils.project <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> get_project_settings

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">ImagesPipeline</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(ImagesPipeline)</span>:</span>
    IMAGES_STORE = get_project_settings().get(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"IMAGES_STORE"</span>)

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">get_media_requests</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, item, info)</span>:</span>
        image_url = item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"imagesUrls"</span>]
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.Request(image_url)

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">item_completed</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, results, item, info)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 固定写法，获取图片路径，同时判断这个路径是否正确，如果正确，就放到 image_path里，ImagesPipeline源码剖析可见</span>
        image_path = [x[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"path"</span>] <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> ok, x <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> results <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> ok]

        os.rename(self.IMAGES_STORE + <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"/"</span> + image_path[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>], self.IMAGES_STORE + <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"/"</span> + item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"name"</span>] + <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">".jpg"</span>)
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"imagesPath"</span>] = self.IMAGES_STORE + <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"/"</span> + item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"name"</span>]

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> item

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#get_media_requests的作用就是为每一个图片链接生成一个Request对象，这个方法的输出将作为item_completed的输入中的results，results是一个元组，每个元组包括(success, imageinfoorfailure)。如果success=true，imageinfoor_failure是一个字典，包括url/path/checksum三个key。</span></code></pre><h4 id="blogTitle127" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">在项目根目录下新建 main.py 文件,用于调试</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> cmdline
cmdline.execute(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'scrapy crawl douyu'</span>.split())</code></pre><h4 id="blogTitle128" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em;">执行程序</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">py2 main.py</code></pre></div><h3 id="blogTitle129">（案例二）阳光热线问政平台</h3><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><a href="http://wz.sun0769.com/index.php/question/questionType?type=4" target="_blank" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">http://wz.sun0769.com/index.php/question/questionType?type=4</a></p><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">爬取投诉帖子的编号、帖子的 url、帖子的标题，和帖子里的内容。</p><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.5em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;" id="blogTitle130">items.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">DongguanItem</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Item)</span>:</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 每个帖子的标题</span>
    title = scrapy.Field()
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 每个帖子的编号</span>
    number = scrapy.Field()
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 每个帖子的文字内容</span>
    content = scrapy.Field()
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 每个帖子的url</span>
    url = scrapy.Field()
</code></pre><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.5em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;" id="blogTitle131">spiders/sunwz.py</h4><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;" id="blogTitle132">Spider 版本</h5><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># -*- coding: utf-8 -*-</span>

<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> dongguan.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> DongguanItem

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">SunSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(CrawlSpider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'sun'</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'wz.sun0769.com'</span>]
    url = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://wz.sun0769.com/index.php/question/questionType?type=4&amp;page='</span>
    offset = <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>
    start_urls = [url + str(offset)]

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 取出每个页面里帖子链接列表</span>
        links = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"//div[@class='greyframe']/table//td/a[@class='news14']/@href"</span>).extract()
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 迭代发送每个帖子的请求，调用parse_item方法处理</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> link <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> links:
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.Request(link, callback = self.parse_item)
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 设置页码终止条件，并且每次发送新的页面请求调用parse方法处理</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> self.offset &lt;= <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">71130</span>:
            self.offset += <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">30</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.Request(self.url + str(self.offset), callback = self.parse)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 处理每个帖子里</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse_item</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        item = DongguanItem()
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 标题</span>
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'title'</span>] = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[contains(@class, "pagecenter p3")]//strong/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 编号</span>
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'number'</span>] = item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'title'</span>].split(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">' '</span>)[-<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1</span>].split(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">":"</span>)[-<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1</span>]

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 文字内容，默认先取出有图片情况下的文字内容列表</span>
        content = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[@class="contentext"]/text()'</span>).extract()
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 如果没有内容，则取出没有图片情况下的文字内容列表</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> len(content) == <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>:
            content = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[@class="c1 text14_2"]/text()'</span>).extract()
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># content为列表，通过join方法拼接为字符串，并去除首尾空格</span>
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'content'</span>] = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">""</span>.join(content).strip()
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">else</span>:
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'content'</span>] = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">""</span>.join(content).strip()

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 链接</span>
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'url'</span>] = response.url

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> item
</code></pre><h5 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1em; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;" id="blogTitle133">CrawlSpider 版本</h5><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">
<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># -*- coding: utf-8 -*-</span>
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.linkextractors <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> LinkExtractor
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.spiders <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> CrawlSpider, Rule
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> dongguan.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> DongguanItem
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> time


<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">SunSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(CrawlSpider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'sun'</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'wz.sun0769.com'</span>]
    start_urls = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://wz.sun0769.com/index.php/question/questionType?type=4&amp;page='</span>]

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 每一页的匹配规则</span>
    pagelink = LinkExtractor(allow=(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'type=4'</span>))
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 每个帖子的匹配规则</span>
    contentlink = LinkExtractor(allow=<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">r'/html/question/\d+/\d+.shtml'</span>)

    rules = [
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 本案例为特殊情况，需要调用deal_links方法处理每个页面里的链接</span>
        Rule(pagelink, process_links = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"deal_links"</span>, follow = <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>),
        Rule(contentlink, callback = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parse_item'</span>)
    ]

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 需要重新处理每个页面里的链接，将链接里的‘Type&amp;type=4?page=xxx’替换为‘Type?type=4&amp;page=xxx’（或者是Type&amp;page=xxx?type=4’替换为‘Type?page=xxx&amp;type=4’），否则无法发送这个链接</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">deal_links</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, links)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> link <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> links:
            link.url = link.url.replace(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"?"</span>,<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"&amp;"</span>).replace(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Type&amp;"</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"Type?"</span>)
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">print</span> link.url
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> links


    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse_item</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">print</span> response.url
        item = DongguanItem()
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 标题</span>
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'title'</span>] = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[contains(@class, "pagecenter p3")]//strong/text()'</span>).extract()[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 编号</span>
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'number'</span>] = item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'title'</span>].split(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">' '</span>)[-<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1</span>].split(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">":"</span>)[-<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1</span>]

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 文字内容，默认先取出有图片情况下的文字内容列表</span>
        content = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[@class="contentext"]/text()'</span>).extract()
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 如果没有内容，则取出没有图片情况下的文字内容列表</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> len(content) == <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>:
            content = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[@class="c1 text14_2"]/text()'</span>).extract()
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># content为列表，通过join方法拼接为字符串，并去除首尾空格</span>
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'content'</span>] = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">""</span>.join(content).strip()
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">else</span>:
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'content'</span>] = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">""</span>.join(content).strip()

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 链接</span>
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'url'</span>] = response.url

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> item
</code></pre><h4 id="blogTitle134" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">pipelines.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># -*- coding: utf-8 -*-</span>

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 文件处理类库，可以指定编码格式</span>
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> codecs
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> json

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">JsonWriterPipeline</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object)</span>:</span>

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">__init__</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 创建一个只写文件，指定文本编码格式为utf-8</span>
        self.filename = codecs.open(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'sunwz.json'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'w'</span>, encoding=<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'utf-8'</span>)

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">process_item</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, item, spider)</span>:</span>
        content = json.dumps(dict(item), ensure_ascii=<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">False</span>) + <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"\n"</span>
        self.filename.write(content)
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> item

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">spider_closed</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, spider)</span>:</span>
        self.file.close()
</code></pre><h4 id="blogTitle135" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">settings.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">ITEM_PIPELINES = {
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'dongguan.pipelines.DongguanPipeline'</span>: <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">300</span>,
}

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 日志文件名和处理等级</span>
LOG_FILE = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"dg.log"</span>
LOG_LEVEL = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"DEBUG"</span>
</code></pre><h4 id="blogTitle136" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">在项目根目录下新建main.py文件,用于调试</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> cmdline
cmdline.execute(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'scrapy crawl sunwz'</span>.split())
</code></pre><h4 id="blogTitle137" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">执行程序</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">py2 main.py</code></pre></div><div><br></div><h3 id="blogTitle138">（案例三）新浪网分类资讯爬虫</h3><div><span style="color: rgb(133, 133, 133); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; letter-spacing: 0.2px; orphans: 3; widows: 3; background-color: rgb(243, 234, 203);">爬取新浪网导航页所有下所有大类、小类、小类里的子链接，以及子链接页面的新闻内容。</span><br></div><div><br></div><div><h4 id="blogTitle139" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">新建项目</h4><pre>scrapy startproject sina</pre><div><br></div><h4 id="blogTitle139" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">items.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> sys
reload(sys)
sys.setdefaultencoding(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"utf-8"</span>)

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">SinaItem</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Item)</span>:</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 大类的标题 和 url</span>
    parentTitle = scrapy.Field()
    parentUrls = scrapy.Field()

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 小类的标题 和 子url</span>
    subTitle = scrapy.Field()
    subUrls = scrapy.Field()

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 小类目录存储路径</span>
    subFilename = scrapy.Field()

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 小类下的子链接</span>
    sonUrls = scrapy.Field()

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 文章标题和内容</span>
    head = scrapy.Field()
    content = scrapy.Field()
</code></pre><h4 id="blogTitle140" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">spiders/sina.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># -*- coding: utf-8 -*-</span>

<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> Sina.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> SinaItem
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> os

<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> sys
reload(sys)
sys.setdefaultencoding(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"utf-8"</span>)


<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">SinaSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    name= <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"sina"</span>
    allowed_domains= [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"sina.com.cn"</span>]
    start_urls= [
       <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://news.sina.com.cn/guide/"</span>
    ]

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        items= []
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 所有大类的url 和 标题</span>
        parentUrls = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[@id=\"tab01\"]/div/h3/a/@href'</span>).extract()
        parentTitle = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"//div[@id=\"tab01\"]/div/h3/a/text()"</span>).extract()

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 所有小类的ur 和 标题</span>
        subUrls  = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[@id=\"tab01\"]/div/ul/li/a/@href'</span>).extract()
        subTitle = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[@id=\"tab01\"]/div/ul/li/a/text()'</span>).extract()

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#爬取所有大类</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> i <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> range(<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>, len(parentTitle)):
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 指定大类目录的路径和目录名</span>
            parentFilename = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"./Data/"</span> + parentTitle[i]

            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#如果目录不存在，则创建目录</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span>(<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> os.path.exists(parentFilename)):
                os.makedirs(parentFilename)

            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 爬取所有小类</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> j <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> range(<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>, len(subUrls)):
                item = SinaItem()

                <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 保存大类的title和urls</span>
                item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parentTitle'</span>] = parentTitle[i]
                item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parentUrls'</span>] = parentUrls[i]

                <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 检查小类的url是否以同类别大类url开头，如果是返回True (sports.sina.com.cn 和 sports.sina.com.cn/nba)</span>
                if_belong = subUrls[j].startswith(item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parentUrls'</span>])

                <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 如果属于本大类，将存储目录放在本大类目录下</span>
                <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span>(if_belong):
                    subFilename =parentFilename + <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'/'</span>+ subTitle[j]
                    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 如果目录不存在，则创建目录</span>
                    <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span>(<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> os.path.exists(subFilename)):
                        os.makedirs(subFilename)

                    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 存储 小类url、title和filename字段数据</span>
                    item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subUrls'</span>] = subUrls[j]
                    item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subTitle'</span>] =subTitle[j]
                    item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subFilename'</span>] = subFilename

                    items.append(item)

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#发送每个小类url的Request请求，得到Response连同包含meta数据 一同交给回调函数 second_parse 方法处理</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> item <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> items:
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.Request( url = item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subUrls'</span>], meta={<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'meta_1'</span>: item}, callback=self.second_parse)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#对于返回的小类的url，再进行递归请求</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">second_parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 提取每次Response的meta数据</span>
        meta_1= response.meta[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'meta_1'</span>]

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 取出小类里所有子链接</span>
        sonUrls = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//a/@href'</span>).extract()

        items= []
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> i <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> range(<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>, len(sonUrls)):
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 检查每个链接是否以大类url开头、以.shtml结尾，如果是返回True</span>
            if_belong = sonUrls[i].endswith(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'.shtml'</span>) <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">and</span> sonUrls[i].startswith(meta_1[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parentUrls'</span>])

            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 如果属于本大类，获取字段值放在同一个item下便于传输</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span>(if_belong):
                item = SinaItem()
                item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parentTitle'</span>] =meta_1[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parentTitle'</span>]
                item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parentUrls'</span>] =meta_1[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'parentUrls'</span>]
                item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subUrls'</span>] = meta_1[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subUrls'</span>]
                item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subTitle'</span>] = meta_1[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subTitle'</span>]
                item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subFilename'</span>] = meta_1[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subFilename'</span>]
                item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'sonUrls'</span>] = sonUrls[i]
                items.append(item)

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#发送每个小类下子链接url的Request请求，得到Response后连同包含meta数据 一同交给回调函数 detail_parse 方法处理</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> item <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> items:
                <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.Request(url=item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'sonUrls'</span>], meta={<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'meta_2'</span>:item}, callback = self.detail_parse)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 数据解析方法，获取文章标题和内容</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">detail_parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        item = response.meta[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'meta_2'</span>]
        content = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">""</span>
        head = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//h1[@id=\"main_title\"]/text()'</span>)
        content_list = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//div[@id=\"artibody\"]/p/text()'</span>).extract()

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 将p标签里的文本内容合并到一起</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> content_one <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> content_list:
            content += content_one

        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'head'</span>]= head
        item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'content'</span>]= content

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> item
</code></pre><h4 id="blogTitle141" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">pipelines.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> signals
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> sys
reload(sys)
sys.setdefaultencoding(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"utf-8"</span>)

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">SinaPipeline</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object)</span>:</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">process_item</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, item, spider)</span>:</span>
        sonUrls = item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'sonUrls'</span>]

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 文件名为子链接url中间部分，并将 / 替换为 _，保存为 .txt格式</span>
        filename = sonUrls[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">7</span>:-<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">6</span>].replace(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'/'</span>,<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'_'</span>)
        filename += <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">".txt"</span>

        fp = open(item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'subFilename'</span>]+<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'/'</span>+filename, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'w'</span>)
        fp.write(item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'content'</span>])
        fp.close()

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> item
</code></pre><h4 id="blogTitle142" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">settings.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">BOT_NAME = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'Sina'</span>

SPIDER_MODULES = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'Sina.spiders'</span>]
NEWSPIDER_MODULE = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'Sina.spiders'</span>

ITEM_PIPELINES = {
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'Sina.pipelines.SinaPipeline'</span>: <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">300</span>,
}

LOG_LEVEL = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'DEBUG'</span>
</code></pre><h4 id="blogTitle143" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">在项目根目录下新建main.py文件,用于调试</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> cmdline
cmdline.execute(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'scrapy crawl sina'</span>.split())
</code></pre><h4 id="blogTitle144" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">执行程序</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">py2 main.py</code></pre></div><div><h3 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; break-after: avoid; margin-bottom: 0.85em; margin-top: 0px !important;" id="blogTitle145">（案例四）图片下载器爬虫</h3><h4 id="blogTitle146" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px; margin-top: 0px !important;">items.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">CoserItem</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Item)</span>:</span>
    url = scrapy.Field()
    name = scrapy.Field()
    info = scrapy.Field()
    image_urls = scrapy.Field()
    images = scrapy.Field()
</code></pre><h4 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.5em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;" id="blogTitle147">spiders/coser.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># -*- coding: utf-8 -*-</span>
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.selector <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> Selector
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.contrib.loader <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> ItemLoader
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> Cosplay.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> CoserItem


<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">CoserSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"coser"</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"bcy.net"</span>]
    start_urls = (
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://bcy.net/cn125101'</span>,
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://bcy.net/cn126487'</span>,
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://bcy.net/cn126173'</span>
    )

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        sel = Selector(response)

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> link <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> sel.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"//ul[@class='js-articles l-works']/li[@class='l-work--big']/article[@class='work work--second-created']/h2[@class='work__title']/a/@href"</span>).extract():
            link = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://bcy.net%s'</span> % link
            request = scrapy.Request(link, callback=self.parse_item)
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> request

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse_item</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        l = ItemLoader(item=CoserItem(), response=response)
        l.add_xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'name'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"//h1[@class='js-post-title']/text()"</span>)
        l.add_xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'info'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"//div[@class='post__info']/div[@class='post__type post__info-group']/span/text()"</span>)
        urls = l.get_xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'//img[@class="detail_std detail_clickable"]/@src'</span>)
        urls = [url.replace(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'/w650'</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">''</span>) <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> url <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> urls]
        l.add_value(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'image_urls'</span>, urls)
        l.add_value(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'url'</span>, response.url)

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> l.load_item()
</code></pre><h4 id="blogTitle148" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">pipelines.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> requests
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> Cosplay <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> settings
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> os


<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">ImageDownloadPipeline</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object)</span>:</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">process_item</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, item, spider)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'image_urls'</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> item:
            images = []
            dir_path = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'%s/%s'</span> % (settings.IMAGES_STORE, spider.name)

            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> os.path.exists(dir_path):
                os.makedirs(dir_path)
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> image_url <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'image_urls'</span>]:
                us = image_url.split(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'/'</span>)[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">3</span>:]
                image_file_name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'_'</span>.join(us)
                file_path = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'%s/%s'</span> % (dir_path, image_file_name)
                images.append(file_path)
                <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> os.path.exists(file_path):
                    <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">continue</span>

                <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">with</span> open(file_path, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'wb'</span>) <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">as</span> handle:
                    response = requests.get(image_url, stream=<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">True</span>)
                    <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> block <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> response.iter_content(<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1024</span>):
                        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">not</span> block:
                            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">break</span>

                        handle.write(block)

            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'images'</span>] = images
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> item
</code></pre><h4 id="blogTitle149" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">settings.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">
ITEM_PIPELINES = {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'Cosplay.pipelines.ImageDownloadPipeline'</span>: <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">1</span>}

IMAGES_STORE = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'../Images'</span>

DOWNLOAD_DELAY = <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0.25</span>    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 250 ms of delay</span>
</code></pre><h4 id="blogTitle150" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">在项目根目录下新建main.py文件,用于调试</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> cmdline
cmdline.execute(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'scrapy crawl coser'</span>.split())
</code></pre><h4 id="blogTitle151" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">执行程序</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">py2 main.py</code></pre></div><div><h3 style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; margin-right: 0px; margin-bottom: 0.85em; margin-left: 0px; break-after: avoid; border-color: inherit; margin-top: 0px !important;" id="blogTitle152">（案例五）用 Pymongo 保存数据</h3><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">爬取豆瓣电影top250<a href="movie.douban.com/top250" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; text-decoration-line: none; font-size: inherit; background: 0px 0px;">movie.douban.com/top250</a>的电影数据，并保存在MongoDB中。</p><h4 id="blogTitle153" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">items.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">DoubanspiderItem</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Item)</span>:</span>
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 电影标题</span>
    title = scrapy.Field()
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 电影评分</span>
    score = scrapy.Field()
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 电影信息</span>
    content = scrapy.Field()
    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 简介</span>
    info = scrapy.Field()
</code></pre><h4 id="blogTitle154" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">spiders/douban.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> doubanSpider.items <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> DoubanspiderItem


<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">DoubanSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"douban"</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"movie.douban.com"</span>]
    start = <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>
    url = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'https://movie.douban.com/top250?start='</span>
    end = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'&amp;filter='</span>
    start_urls = [url + str(start) + end]

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>

        item = DoubanspiderItem()

        movies = response.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"//div[@class=\'info\']"</span>)

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> each <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> movies:
            title = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'div[@class="hd"]/a/span[@class="title"]/text()'</span>).extract()
            content = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'div[@class="bd"]/p/text()'</span>).extract()
            score = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'div[@class="bd"]/div[@class="star"]/span[@class="rating_num"]/text()'</span>).extract()
            info = each.xpath(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'div[@class="bd"]/p[@class="quote"]/span/text()'</span>).extract()

            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'title'</span>] = title[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 以;作为分隔，将content列表里所有元素合并成一个新的字符串</span>
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'content'</span>] = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">';'</span>.join(content)
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'score'</span>] = score[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            item[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'info'</span>] = info[<span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">0</span>]
            <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 提交item</span>

            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> item

        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">if</span> self.start &lt;= <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">225</span>:
            self.start += <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">25</span>
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.Request(self.url + str(self.start) + self.end, callback=self.parse)
</code></pre><h4 id="blogTitle155" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">pipelines.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">from</span> scrapy.conf <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> settings
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> pymongo

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">DoubanspiderPipeline</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(object)</span>:</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">__init__</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 获取setting主机名、端口号和数据库名</span>
        host = settings[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'MONGODB_HOST'</span>]
        port = settings[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'MONGODB_PORT'</span>]
        dbname = settings[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'MONGODB_DBNAME'</span>]

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># pymongo.MongoClient(host, port) 创建MongoDB链接</span>
        client = pymongo.MongoClient(host=host,port=port)

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 指向指定的数据库</span>
        mdb = client[dbname]
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 获取数据库里存放数据的表名</span>
        self.post = mdb[settings[<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'MONGODB_DOCNAME'</span>]]


    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">process_item</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, item, spider)</span>:</span>
        data = dict(item)
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 向指定的表里添加数据</span>
        self.post.insert(data)
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">return</span> item
</code></pre><h4 id="blogTitle156" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">settings.py</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">BOT_NAME = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'doubanSpider'</span>

SPIDER_MODULES = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'doubanSpider.spiders'</span>]
NEWSPIDER_MODULE = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'doubanSpider.spiders'</span>

ITEM_PIPELINES = {
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'doubanSpider.pipelines.DoubanspiderPipeline'</span> : <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">300</span>
        }

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>
USER_AGENT = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.116 Safari/537.36'</span>

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># MONGODB 主机环回地址127.0.0.1</span>
MONGODB_HOST = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'127.0.0.1'</span>
<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 端口号，默认是27017</span>
MONGODB_PORT = <span class="hljs-number" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">27017</span>
<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 设置数据库名称</span>
MONGODB_DBNAME = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'DouBan'</span>
<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 存放本次数据的表名称</span>
MONGODB_DOCNAME = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'DouBanMovies'</span>
</code></pre><h4 id="blogTitle157" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">运行</h4><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-sh" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;">启动MongoDB数据库需要两个命令：

mongod：是mongoDB数据库进程本身
mongo：是命令行shell客户端


sudo mongod <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 首先启动数据库服务，再执行Scrapy</span>
sudo mongo <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 启动数据库shell</span>

在mongo shell下使用命令:

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 查看当前数据库</span>
&gt; db

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 列出所有的数据库</span>
&gt; show dbs

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 连接DouBan数据库</span>
&gt; use DouBan

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 列出所有表</span>
&gt; show collections

<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 查看表里的数据</span>
&gt; db.DouBanMoives.find()</code></pre></div><h3 id="blogTitle158">(案例六)三种 scrapy 模拟登陆策略</h3><div><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.5em; orphans: 3; widows: 3; break-after: avoid; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px; margin-top: 0px !important;">注意：模拟登陆时，必须保证settings.py里的&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">COOKIES_ENABLED</code>(Cookies中间件) 处于开启状态</p><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;"><code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);">COOKIES_ENABLED = True</code>&nbsp;或&nbsp;<code style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); padding: 0.2em; margin: 0px; background: rgb(253, 246, 227);"># COOKIES_ENABLED = False</code></p></blockquote><h4 id="blogTitle159" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">策略一：直接POST数据（比如需要登陆的账户信息)</h4><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">只要是需要提供post数据的，就可以用这种方法。下面示例里post的数据是账户密码：</p></blockquote><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># -*- coding: utf-8 -*-</span>
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy


<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">Renren1Spider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"renren1"</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"renren.com"</span>]

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">start_requests</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        url = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://www.renren.com/PLogin.do'</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># FormRequest 是Scrapy发送POST请求的方法</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.FormRequest(
                url = url,
                formdata = {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"email"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"mr_mao_hacker@163.com"</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"password"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"axxxxxxxe"</span>},
                callback = self.parse_page)

    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse_page</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">with</span> open(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"mao2.html"</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"w"</span>) <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">as</span> filename:
            filename.write(response.body)
</code></pre><h4 id="blogTitle160" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">策略二：标准的模拟登陆步骤</h4><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">正统模拟登录方法：</p><ol style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; margin: 0px 0px 0.85em; padding: 0px 0px 0px 2em;"><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">首先发送登录页面的get请求，获取到页面里的登录必须的参数（比如说zhihu登陆界面的 _xsrf）</p></li><li style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">然后和账户密码一起post到服务器，登录成功</p></li></ol></blockquote><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># -*- coding: utf-8 -*-</span>
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">Renren2Spider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"renren2"</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"renren.com"</span>]
    start_urls = (
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://www.renren.com/PLogin.do"</span>,
    )

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 处理start_urls里的登录url的响应内容，提取登陆需要的参数（如果需要的话)</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 提取登陆需要的参数</span>
        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#_xsrf = response.xpath("//_xsrf").extract()[0]</span>

        <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 发送请求参数，并调用指定回调函数处理</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.FormRequest.from_response(
                response,
                formdata = {<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"email"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"mr_mao_hacker@163.com"</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"password"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"axxxxxxxe"</span>},<span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);">#, "_xsrf" = _xsrf},</span>
                callback = self.parse_page
            )

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 获取登录成功状态，访问需要登录后才能访问的页面</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse_page</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        url = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"http://www.renren.com/422167102/profile"</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.Request(url, callback = self.parse_newpage)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 处理响应内容</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse_newpage</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">with</span> open(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"xiao.html"</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"w"</span>) <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">as</span> filename:
            filename.write(response.body)
</code></pre><h4 id="blogTitle161" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 1.25em; orphans: 3; widows: 3; break-after: avoid; margin-top: 1.275em; margin-bottom: 0.85em; color: rgb(112, 66, 20); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;">策略三：直接使用保存登陆状态的 Cookie 模拟登陆</h4><blockquote style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: 16px; break-inside: avoid; margin: 0px 0px 0.85em; padding: 0px 15px; color: rgb(133, 133, 133); border-color: inherit; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; letter-spacing: 0.2px;"><p style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; orphans: 3; widows: 3; margin-top: 0px; margin-bottom: 0.85em;">如果实在没办法了，可以用这种方法模拟登录，虽然麻烦一点，但是成功率100%</p></blockquote><pre style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 16px; white-space: pre-wrap; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); color: rgb(101, 123, 131); overflow-wrap: normal; margin-top: 0px; margin-bottom: 1.275em; padding-top: 0.85em; padding-bottom: 0.85em; background-color: rgb(253, 246, 227); letter-spacing: 0.2px;"><code class="lang-python" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-family: Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 0.85em; break-inside: avoid; direction: ltr; border: none rgb(248, 223, 156); padding: 0px; margin: 0px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; display: inline; max-width: initial; overflow: initial; line-height: inherit; white-space: pre;"><span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># -*- coding: utf-8 -*-</span>
<span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">import</span> scrapy

<span class="hljs-class" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit;"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">class</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(181, 137, 0);">RenrenSpider</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(scrapy.Spider)</span>:</span>
    name = <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"renren"</span>
    allowed_domains = [<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"renren.com"</span>]
    start_urls = (
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://www.renren.com/111111'</span>,
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://www.renren.com/222222'</span>,
        <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">'http://www.renren.com/333333'</span>,
    )

    cookies = {
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"anonymid"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"ixrna3fysufnwv"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"_r01_"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"1"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"ap"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"327550029"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"JSESSIONID"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"abciwg61A_RvtaRS3GjOv"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"depovince"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"GW"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"springskin"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"set"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"jebe_key"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"f6fb270b-d06d-42e6-8b53-e67c3156aa7e%7Cc13c37f53bca9e1e7132d4b58ce00fa3%7C1484060607478%7C1%7C1486198628950"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"t"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"691808127750a83d33704a565d8340ae9"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"societyguester"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"691808127750a83d33704a565d8340ae9"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"id"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"327550029"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"xnsid"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"f42b25cf"</span>,
    <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"loginfrom"</span> : <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"syshome"</span>
    }

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 可以重写Spider类的start_requests方法，附带Cookie值，发送POST请求</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">start_requests</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">for</span> url <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">in</span> self.start_urls:
            <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">yield</span> scrapy.FormRequest(url, cookies = self.cookies, callback = self.parse_page)

    <span class="hljs-comment" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(147, 161, 161);"># 处理响应内容</span>
    <span class="hljs-function" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(66, 113, 174);"><span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">def</span> <span class="hljs-title" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(38, 139, 210);">parse_page</span><span class="hljs-params" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(245, 135, 31);">(self, response)</span>:</span>
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">print</span> <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"==========="</span> + response.url
        <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">with</span> open(<span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"deng.html"</span>, <span class="hljs-string" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(42, 161, 152);">"w"</span>) <span class="hljs-keyword" style="-webkit-font-smoothing: antialiased; box-sizing: border-box; -webkit-tap-highlight-color: transparent; text-size-adjust: none; font-size: inherit; color: rgb(133, 153, 0);">as</span> filename:
            filename.write(response.body)</code></pre></div><div><br></div><h2 id="blogTitle162">scrapy-redis 分布式组件</h2><h3 id="blogTitle163">源码分析：Connection</h3><h3 id="blogTitle164">源码分析：Dupefilter</h3><h3 id="blogTitle165">源码分析：Picklecompat</h3><h3 id="blogTitle166">源码分析：Pipelines</h3><h3 id="blogTitle167">源码分析：Queue</h3><h3 id="blogTitle168">源码分析：Schedular</h3><h3 id="blogTitle169">源码分析：Spider</h3><h2 id="blogTitle170">scrapy-redis 实战</h2><h3 id="blogTitle171">有缘网分布式爬虫</h3><h3 id="blogTitle172">新浪网分布式咨询爬虫</h3><h3 id="blogTitle173">IT 桔子分布式爬虫</h3><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div>
</article>
{% endblock point1 %}
