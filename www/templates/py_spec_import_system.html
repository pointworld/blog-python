{% extends 'c-word.html' %}

{% block title %} The import system - Python | specification {% endblock title %}

{% block point1 %}
<article contenteditable="true">
  <p><span style="background-color: yellow;"><b>Category: 计算机 | 程序设计语言 | Python | specification | The import system</b></span></p>
  <h1 id="blogTitle0">The import system</h1><h2>模块</h2><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">如果你从Python解释器退出并再次进入，之前的定义（函数和变量）都会丢失。因此，如果你想编写一个稍长些的程序，最好使用文本编辑器为解释器准备输入并将该文件作为输入运行。这被称作编写&nbsp;<em>脚本</em>&nbsp;。随着程序变得越来越长，你或许会想把它拆分成几个文件，以方便维护。你亦或想在不同的程序中使用一个便捷的函数， 而不必把这个函数复制到每一个程序中去。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">为支持这些，Python有一种方法可以把定义放在一个文件里，并在脚本或解释器的交互式实例中使用它们。这样的文件被称作&nbsp;<em>模块</em>&nbsp;；模块中的定义可以&nbsp;<em>导入</em>&nbsp;到其它模块或者&nbsp;<em>主</em>&nbsp;模块（你在顶级和计算器模式下执行的脚本中可以访问的变量集合）。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">模块是一个包含Python定义和语句的文件。文件名就是模块名后跟文件后缀&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.py</span></code>&nbsp;。在一个模块内部，模块名（作为一个字符串）可以通过全局变量&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__name__</span></code>&nbsp;的值获得。例如，使用你最喜爱的文本编辑器在当前目录下创建一个名为&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">fibo.py</span></code>&nbsp;的文件， 文件中含有以下内容:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="c1" style="color: rgb(64, 128, 144); font-style: italic;"># Fibonacci numbers module</span>

<span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="color: rgb(6, 40, 126);">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>    <span class="c1" style="color: rgb(64, 128, 144); font-style: italic;"># write Fibonacci series up to n</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="mi" style="color: rgb(32, 128, 80);">0</span><span class="p">,</span> <span class="mi" style="color: rgb(32, 128, 80);">1</span>
    <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">while</span> <span class="n">a</span> <span class="o" style="color: rgb(102, 102, 102);">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="nb" style="color: rgb(0, 112, 32);">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">end</span><span class="o" style="color: rgb(102, 102, 102);">=</span><span class="s1" style="color: rgb(64, 112, 160);">' '</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o" style="color: rgb(102, 102, 102);">+</span><span class="n">b</span>
    <span class="nb" style="color: rgb(0, 112, 32);">print</span><span class="p">()</span>

<span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="color: rgb(6, 40, 126);">fib2</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>   <span class="c1" style="color: rgb(64, 128, 144); font-style: italic;"># return Fibonacci series up to n</span>
    <span class="n">result</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="p">[]</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="mi" style="color: rgb(32, 128, 80);">0</span><span class="p">,</span> <span class="mi" style="color: rgb(32, 128, 80);">1</span>
    <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">while</span> <span class="n">a</span> <span class="o" style="color: rgb(102, 102, 102);">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">result</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o" style="color: rgb(102, 102, 102);">+</span><span class="n">b</span>
    <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">return</span> <span class="n">result</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">现在进入Python解释器，并用以下命令导入该模块:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">fibo</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">在当前的符号表中，这并不会直接进入到定义在&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">fibo</span></code>&nbsp;函数内的名称；它只是进入到模块名&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">fibo</span></code>中。你可以用模块名访问这些函数:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">fibo</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">fib</span><span class="p">(</span><span class="mi" style="color: rgb(32, 128, 80);">1000</span><span class="p">)</span>
<span class="go">0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">fibo</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">fib2</span><span class="p">(</span><span class="mi" style="color: rgb(32, 128, 80);">100</span><span class="p">)</span>
<span class="go">[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89]</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">fibo</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="vm" style="color: rgb(187, 96, 213);">__name__</span>
<span class="go">'fibo'</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">如果你想经常使用某个函数，你可以把它赋值给一个局部变量:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">fib</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="n">fibo</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">fib</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">fib</span><span class="p">(</span><span class="mi" style="color: rgb(32, 128, 80);">500</span><span class="p">)</span>
<span class="go">0 1 1 2 3 5 8 13 21 34 55 89 144 233 377</span></pre></div></div><h3>有关模块的更多信息</h3><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">模块可以包含可执行的语句以及函数定义。这些语句用于初始化模块。它们仅在模块&nbsp;<em>第一次</em>&nbsp;在 import 语句中被导入时才执行。&nbsp;<a class="footnote-reference" href="https://docs.python.org/zh-cn/3/tutorial/modules.html#id2" id="id1" style="color: rgb(99, 99, 187); text-decoration-line: none;">[1]</a>&nbsp;(当文件被当作脚本运行时，它们也会执行。)</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">每个模块都有它自己的私有符号表，该表用作模块中定义的所有函数的全局符号表。因此，模块的作者可以在模块内使用全局变量，而不必担心与用户的全局变量发生意外冲突。另一方面，如果你知道自己在做什么，则可以用跟访问模块内的函数的同样标记方法，去访问一个模块的全局变量，<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">modname.itemname</span></code>。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">模块可以导入其它模块。习惯上但不要求把所有&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;语句放在模块（或脚本）的开头。被导入的模块名存放在调入模块的全局符号表中。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;语句有一个变体，它可以把名字从一个被调模块内直接导入到现模块的符号表里。例如:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">fibo</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n">fib</span><span class="p">,</span> <span class="n">fib2</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">fib</span><span class="p">(</span><span class="mi" style="color: rgb(32, 128, 80);">500</span><span class="p">)</span>
<span class="go">0 1 1 2 3 5 8 13 21 34 55 89 144 233 377</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">这并不会把被调模块名引入到局部变量表里（因此在这个例子里，<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">fibo</span></code>&nbsp;是未被定义的）。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">还有一个变体甚至可以导入模块内定义的所有名称:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">fibo</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="o" style="color: rgb(102, 102, 102);">*</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">fib</span><span class="p">(</span><span class="mi" style="color: rgb(32, 128, 80);">500</span><span class="p">)</span>
<span class="go">0 1 1 2 3 5 8 13 21 34 55 89 144 233 377</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">这会调入所有非以下划线（<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">_</span></code>）开头的名称。 在多数情况下，Python程序员都不会使用这个功能，因为它在解释器中引入了一组未知的名称，而它们很可能会覆盖一些你已经定义过的东西。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">注意通常情况下从一个模块或者包内调入&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">*</span></code>&nbsp;的做法是不太被接受的， 因为这通常会导致代码的可读性很差。不过，在交互式编译器中为了节省打字可以这么用。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">如果模块名后跟有&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#as" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">as</span></code></a>，那么&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#as" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">as</span></code></a>&nbsp;后的名称会直接跟被导入的模块绑定。</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">fibo</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">as</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">fib</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">fib</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">fib</span><span class="p">(</span><span class="mi" style="color: rgb(32, 128, 80);">500</span><span class="p">)</span>
<span class="go">0 1 1 2 3 5 8 13 21 34 55 89 144 233 377</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">这会和&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">fibo</span></code>&nbsp;方式一样有效地调入模块， 唯一的区别是它以&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">fib</span></code>&nbsp;的名称存在的。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">It can also be used when utilising&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#from" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">from</span></code></a>&nbsp;with similar effects:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">fibo</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n">fib</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">as</span> <span class="n">fibonacci</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">fibonacci</span><span class="p">(</span><span class="mi" style="color: rgb(32, 128, 80);">500</span><span class="p">)</span>
<span class="go">0 1 1 2 3 5 8 13 21 34 55 89 144 233 377</span>
</pre></div></div><div class="admonition note" style="margin-top: 10px; margin-bottom: 10px; padding: 7px; background-color: rgb(238, 238, 238); border: 1px solid rgb(204, 204, 204); border-radius: 3px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px;"><p class="first admonition-title" style="margin: 0px 10px 5px 0px; font-weight: bold; display: inline; hyphens: auto; text-align: justify; line-height: 22.4px;">注解</p>&nbsp;<p class="last" style="hyphens: auto; text-align: justify; line-height: 22.4px; margin-bottom: 5px; display: inline;">出于效率的考虑，每个模块在每个解释器会话中只被导入一次。因此，如果你更改了你的模块，则必须重新启动解释器， 或者，如果它只是一个要交互式地测试的模块，请使用<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.reload" title="importlib.reload" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background: rgb(214, 214, 214); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib.reload()</span></code></a>，例如&nbsp;<code class="docutils literal notranslate" style="background: rgb(214, 214, 214); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">importlib;</span>&nbsp;<span class="pre" style="hyphens: none;">importlib.reload(modulename)</span></code>。</p></div><h4>以脚本的方式执行模块</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">当你用下面方式运行一个Python模块:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="n">python</span> <span class="n">fibo</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">py</span> <span class="o" style="color: rgb(102, 102, 102);">&lt;</span><span class="n">arguments</span><span class="o" style="color: rgb(102, 102, 102);">&gt;</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">模块里的代码会被执行，就好像你导入了模块一样，但是&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__name__</span></code>&nbsp;被赋值为&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">"__main__"</span></code>。 这意味着通过在你的模块末尾添加这些代码:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">if</span> <span class="vm" style="color: rgb(187, 96, 213);">__name__</span> <span class="o" style="color: rgb(102, 102, 102);">==</span> <span class="s2" style="color: rgb(64, 112, 160);">"__main__"</span><span class="p">:</span>
    <span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">sys</span>
    <span class="n">fib</span><span class="p">(</span><span class="nb" style="color: rgb(0, 112, 32);">int</span><span class="p">(</span><span class="n">sys</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">argv</span><span class="p">[</span><span class="mi" style="color: rgb(32, 128, 80);">1</span><span class="p">]))</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">你既可以把这个文件当作脚本又可当作一个可调入的模块来使用， 因为那段解析命令行的代码只有在当模块是以“main”文件的方式执行的时候才会运行:</p><div class="highlight-shell-session notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">$</span> python fibo.py <span class="m" style="color: rgb(32, 128, 80);">50</span>
<span class="go">0 1 1 2 3 5 8 13 21 34</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">如果模块是被导入的，那些代码是不运行的:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">fibo</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">这经常用于为模块提供一个方便的用户接口，或用于测试（以脚本的方式运行模块从而执行一些测试套件）。</p><h4>模块搜索路径</h4><p id="index-0" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">当一个名为&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">spam</span></code>&nbsp;的模块被导入的时候，解释器首先寻找具有该名称的内置模块。如果没有找到，然后解释器从&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>&nbsp;变量给出的目录列表里寻找名为&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">spam.py</span></code>&nbsp;的文件。<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>&nbsp;初始有这些目录地址:</p><ul class="simple" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">包含输入脚本的目录（ 或者未指定文件时的当前目录）。</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;"><span class="target" id="index-14"></span><a class="reference internal" href="https://docs.python.org/zh-cn/3/using/cmdline.html#envvar-PYTHONPATH" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-envvar docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">PYTHONPATH</span></code></a>&nbsp;（一个包含目录名称的列表，它和shell变量&nbsp;<span class="target" id="index-15"></span><code class="xref std std-envvar docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">PATH</span></code>&nbsp;有一样的语法）。</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">取决于安装的默认设置</li></ul><div class="admonition note" style="margin-top: 10px; margin-bottom: 10px; padding: 7px; background-color: rgb(238, 238, 238); border: 1px solid rgb(204, 204, 204); border-radius: 3px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px;"><p class="first admonition-title" style="margin: 0px 10px 5px 0px; font-weight: bold; display: inline; hyphens: auto; text-align: justify; line-height: 22.4px;">注解</p>&nbsp;<p class="last" style="hyphens: auto; text-align: justify; line-height: 22.4px; margin-bottom: 5px; display: inline;">在支持符号链接的文件系统上，包含输入脚本的目录是在追加符号链接后才计算出来的。换句话说，包含符号链接的目录并&nbsp;<strong>没有</strong>&nbsp;被添加到模块的搜索路径上。</p></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">在初始化后，Python程序可以更改&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>。包含正在运行脚本的文件目录被放在搜索路径的开头处， 在标准库路径之前。这意味着将加载此目录里的脚本，而不是标准库中的同名模块。 除非有意更换，否则这是错误。更多信息请参阅&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/tutorial/modules.html#tut-standardmodules" style="color: rgb(99, 99, 187); text-decoration-line: none;">标准模块</a>。</p><h4>“编译过的”Python文件</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">为了加速模块载入，Python在&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__pycache__</span></code>&nbsp;目录里缓存了每个模块的编译后版本，名称为&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">module.</span><em><span class="pre" style="hyphens: none;">version</span></em><span class="pre" style="hyphens: none;">.pyc</span></code>&nbsp;，其中名称中的版本字段对编译文件的格式进行编码； 它一般使用Python版本号。例如，在CPython版本3.3中，spam.py的编译版本将被缓存为&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__pycache__/spam.cpython-33.pyc</span></code>。此命名约定允许来自不同发行版和不同版本的Python的已编译模块共存。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Python根据编译版本检查源的修改日期，以查看它是否已过期并需要重新编译。这是一个完全自动化的过程。此外，编译的模块与平台无关，因此可以在具有不同体系结构的系统之间共享相同的库。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Python在两种情况下不会检查缓存。首先，对于从命令行直接载入的模块，它从来都是重新编译并且不存储编译结果；其次，如果没有源模块，它不会检查缓存。为了支持无源文件（仅编译）发行版本， 编译模块必须是在源目录下，并且绝对不能有源模块。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">给专业人士的一些小建议:</p><ul class="simple" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">你可以在Python命令中使用&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/using/cmdline.html#cmdoption-o" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-option docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">-O</span></code></a>&nbsp;或者&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/using/cmdline.html#cmdoption-oo" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-option docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">-OO</span></code></a>&nbsp;开关， 以减小编译后模块的大小。&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">-O</span></code>&nbsp;开关去除断言语句，<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">-OO</span></code>&nbsp;开关同时去除断言语句和 __doc__ 字符串。由于有些程序可能依赖于这些，你应当只在清楚自己在做什么时才使用这个选项。“优化过的”模块有一个&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">opt-</span></code>&nbsp;标签并且通常小些。将来的发行版本或许会更改优化的效果。</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">一个从&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.pyc</span></code>&nbsp;文件读出的程序并不会比它从&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.py</span></code>&nbsp;读出时运行的更快，<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.pyc</span></code>&nbsp;文件唯一快的地方在于载入速度。</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;"><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/compileall.html#module-compileall" title="compileall: Tools for byte-compiling all Python source files in a directory tree." style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">compileall</span></code></a>&nbsp;模块可以为一个目录下的所有模块创建.pyc文件。</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">关于这个过程，<span class="target" id="index-16"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-3147" style="color: rgb(99, 99, 187); text-decoration-line: none;"><strong>PEP 3147</strong></a>&nbsp;中有更多细节，包括一个决策流程图。</li></ul><h3>标准模块</h3><p id="index-4" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Python附带了一个标准模块库，在单独的文档Python库参考（以下称为“库参考”）中进行了描述。一些模块内置于解释器中；它们提供对不属于语言核心但仍然内置的操作的访问，以提高效率或提供对系统调用等操作系统原语的访问。这些模块的集合是一个配置选项，它也取决于底层平台。例如，<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/winreg.html#module-winreg" title="winreg: Routines and objects for manipulating the Windows registry. (Windows)" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">winreg</span></code></a>&nbsp;模块只在Windows操作系统上提供。一个特别值得注意的模块&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#module-sys" title="sys: Access system-specific parameters and functions." style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys</span></code></a>，它被内嵌到每一个Python解释器中。变量&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.ps1</span></code>&nbsp;和&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.ps2</span></code>&nbsp;定义用作主要和辅助提示的字符串:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">sys</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">ps1</span>
<span class="go">'&gt;&gt;&gt; '</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">ps2</span>
<span class="go">'... '</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">ps1</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="s1" style="color: rgb(64, 112, 160);">'C&gt; '</span>
<span class="go">C&gt; print('Yuck!')</span>
<span class="go">Yuck!</span>
<span class="go">C&gt;</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">这两个变量只有在编译器是交互模式下才被定义。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code>&nbsp;变量是一个字符串列表，用于确定解释器的模块搜索路径。该变量被初始化为从环境变量&nbsp;<span class="target" id="index-17"></span><a class="reference internal" href="https://docs.python.org/zh-cn/3/using/cmdline.html#envvar-PYTHONPATH" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-envvar docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">PYTHONPATH</span></code></a>&nbsp;获取的默认路径，或者如果&nbsp;<span class="target" id="index-18"></span><a class="reference internal" href="https://docs.python.org/zh-cn/3/using/cmdline.html#envvar-PYTHONPATH" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-envvar docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">PYTHONPATH</span></code></a>&nbsp;未设置，则从内置默认路径初始化。你可以使用标准列表操作对其进行修改:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">sys</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">path</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">append</span><span class="p">(</span><span class="s1" style="color: rgb(64, 112, 160);">'/ufs/guido/lib/python'</span><span class="p">)</span></pre></div></div><h3>dir() 函数</h3><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">内置函数&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#dir" title="dir" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">dir()</span></code></a>&nbsp;用于查找模块定义的名称。 它返回一个排序过的字符串列表:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">fibo</span><span class="o" style="color: rgb(102, 102, 102);">,</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">sys</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="nb" style="color: rgb(0, 112, 32);">dir</span><span class="p">(</span><span class="n">fibo</span><span class="p">)</span>
<span class="go">['__name__', 'fib', 'fib2']</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="nb" style="color: rgb(0, 112, 32);">dir</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="go">['__displayhook__', '__doc__', '__excepthook__', '__loader__', '__name__',</span>
<span class="go"> '__package__', '__stderr__', '__stdin__', '__stdout__',</span>
<span class="go"> '_clear_type_cache', '_current_frames', '_debugmallocstats', '_getframe',</span>
<span class="go"> '_home', '_mercurial', '_xoptions', 'abiflags', 'api_version', 'argv',</span>
<span class="go"> 'base_exec_prefix', 'base_prefix', 'builtin_module_names', 'byteorder',</span>
<span class="go"> 'call_tracing', 'callstats', 'copyright', 'displayhook',</span>
<span class="go"> 'dont_write_bytecode', 'exc_info', 'excepthook', 'exec_prefix',</span>
<span class="go"> 'executable', 'exit', 'flags', 'float_info', 'float_repr_style',</span>
<span class="go"> 'getcheckinterval', 'getdefaultencoding', 'getdlopenflags',</span>
<span class="go"> 'getfilesystemencoding', 'getobjects', 'getprofile', 'getrecursionlimit',</span>
<span class="go"> 'getrefcount', 'getsizeof', 'getswitchinterval', 'gettotalrefcount',</span>
<span class="go"> 'gettrace', 'hash_info', 'hexversion', 'implementation', 'int_info',</span>
<span class="go"> 'intern', 'maxsize', 'maxunicode', 'meta_path', 'modules', 'path',</span>
<span class="go"> 'path_hooks', 'path_importer_cache', 'platform', 'prefix', 'ps1',</span>
<span class="go"> 'setcheckinterval', 'setdlopenflags', 'setprofile', 'setrecursionlimit',</span>
<span class="go"> 'setswitchinterval', 'settrace', 'stderr', 'stdin', 'stdout',</span>
<span class="go"> 'thread_info', 'version', 'version_info', 'warnoptions']</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">如果没有参数，<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#dir" title="dir" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">dir()</span></code></a>&nbsp;会列出你当前定义的名称:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="p">[</span><span class="mi" style="color: rgb(32, 128, 80);">1</span><span class="p">,</span> <span class="mi" style="color: rgb(32, 128, 80);">2</span><span class="p">,</span> <span class="mi" style="color: rgb(32, 128, 80);">3</span><span class="p">,</span> <span class="mi" style="color: rgb(32, 128, 80);">4</span><span class="p">,</span> <span class="mi" style="color: rgb(32, 128, 80);">5</span><span class="p">]</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">fibo</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">fib</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="n">fibo</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">fib</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="nb" style="color: rgb(0, 112, 32);">dir</span><span class="p">()</span>
<span class="go">['__builtins__', '__name__', 'a', 'fib', 'fibo', 'sys']</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">注意：它列出所有类型的名称：变量，模块，函数，等等。</p><p id="index-7" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#dir" title="dir" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">dir()</span></code></a>&nbsp;不会列出内置函数和变量的名称。如果你想要这些，它们的定义是在标准模块&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/builtins.html#module-builtins" title="builtins: The module that provides the built-in namespace." style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">builtins</span></code></a>中:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">builtins</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="nb" style="color: rgb(0, 112, 32);">dir</span><span class="p">(</span><span class="n">builtins</span><span class="p">)</span>
<span class="go">['ArithmeticError', 'AssertionError', 'AttributeError', 'BaseException',</span>
<span class="go"> 'BlockingIOError', 'BrokenPipeError', 'BufferError', 'BytesWarning',</span>
<span class="go"> 'ChildProcessError', 'ConnectionAbortedError', 'ConnectionError',</span>
<span class="go"> 'ConnectionRefusedError', 'ConnectionResetError', 'DeprecationWarning',</span>
<span class="go"> 'EOFError', 'Ellipsis', 'EnvironmentError', 'Exception', 'False',</span>
<span class="go"> 'FileExistsError', 'FileNotFoundError', 'FloatingPointError',</span>
<span class="go"> 'FutureWarning', 'GeneratorExit', 'IOError', 'ImportError',</span>
<span class="go"> 'ImportWarning', 'IndentationError', 'IndexError', 'InterruptedError',</span>
<span class="go"> 'IsADirectoryError', 'KeyError', 'KeyboardInterrupt', 'LookupError',</span>
<span class="go"> 'MemoryError', 'NameError', 'None', 'NotADirectoryError', 'NotImplemented',</span>
<span class="go"> 'NotImplementedError', 'OSError', 'OverflowError',</span>
<span class="go"> 'PendingDeprecationWarning', 'PermissionError', 'ProcessLookupError',</span>
<span class="go"> 'ReferenceError', 'ResourceWarning', 'RuntimeError', 'RuntimeWarning',</span>
<span class="go"> 'StopIteration', 'SyntaxError', 'SyntaxWarning', 'SystemError',</span>
<span class="go"> 'SystemExit', 'TabError', 'TimeoutError', 'True', 'TypeError',</span>
<span class="go"> 'UnboundLocalError', 'UnicodeDecodeError', 'UnicodeEncodeError',</span>
<span class="go"> 'UnicodeError', 'UnicodeTranslateError', 'UnicodeWarning', 'UserWarning',</span>
<span class="go"> 'ValueError', 'Warning', 'ZeroDivisionError', '_', '__build_class__',</span>
<span class="go"> '__debug__', '__doc__', '__import__', '__name__', '__package__', 'abs',</span>
<span class="go"> 'all', 'any', 'ascii', 'bin', 'bool', 'bytearray', 'bytes', 'callable',</span>
<span class="go"> 'chr', 'classmethod', 'compile', 'complex', 'copyright', 'credits',</span>
<span class="go"> 'delattr', 'dict', 'dir', 'divmod', 'enumerate', 'eval', 'exec', 'exit',</span>
<span class="go"> 'filter', 'float', 'format', 'frozenset', 'getattr', 'globals', 'hasattr',</span>
<span class="go"> 'hash', 'help', 'hex', 'id', 'input', 'int', 'isinstance', 'issubclass',</span>
<span class="go"> 'iter', 'len', 'license', 'list', 'locals', 'map', 'max', 'memoryview',</span>
<span class="go"> 'min', 'next', 'object', 'oct', 'open', 'ord', 'pow', 'print', 'property',</span>
<span class="go"> 'quit', 'range', 'repr', 'reversed', 'round', 'set', 'setattr', 'slice',</span>
<span class="go"> 'sorted', 'staticmethod', 'str', 'sum', 'super', 'tuple', 'type', 'vars',</span>
<span class="go"> 'zip']</span></pre></div></div><h3>包</h3><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">包是一种通过用“带点号的模块名”来构造 Python 模块命名空间的方法。 例如，模块名&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">A.B</span></code>&nbsp;表示&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">A</span></code>&nbsp;包中名为&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">B</span></code>&nbsp;的子模块。正如模块的使用使得不同模块的作者不必担心彼此的全局变量名称一样，使用加点的模块名可以使得 NumPy 或 Pillow 等多模块软件包的作者不必担心彼此的模块名称一样。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">假设你想为声音文件和声音数据的统一处理，设计一个模块集合（一个“包”）。由于存在很多不同的声音文件格式（通常由它们的扩展名来识别，例如：<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.wav</span></code>，&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.aiff</span></code>，&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.au</span></code>），因此为了不同文件格式间的转换，你可能需要创建和维护一个不断增长的模块集合。 你可能还想对声音数据还做很多不同的处理（例如，混声，添加回声，使用均衡器功能，创造人工立体声效果）， 因此为了实现这些处理，你将另外写一个无穷尽的模块流。这是你的包的可能结构（以分层文件系统的形式表示）：</p><div class="highlight-text notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;">sound/                          Top-level package
      __init__.py               Initialize the sound package
      formats/                  Subpackage for file format conversions
              __init__.py
              wavread.py
              wavwrite.py
              aiffread.py
              aiffwrite.py
              auread.py
              auwrite.py
              ...
      effects/                  Subpackage for sound effects
              __init__.py
              echo.py
              surround.py
              reverse.py
              ...
      filters/                  Subpackage for filters
              __init__.py
              equalizer.py
              vocoder.py
              karaoke.py
              ...
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">当导入这个包时，Python搜索&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code>&nbsp;里的目录，查找包的子目录。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">为了让 Python 将目录当做包，目录中必须包含&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py</span></code>&nbsp;文件；这样做是为了防止具有通用名称的目录无意中隐藏稍后在模块搜索路径上出现的有效模块，例如&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">string</span></code>&nbsp;。最简单的情况下，只需要一个空的&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py</span></code>&nbsp;文件即可，当然它也可以执行包的初始化代码，或者定义稍后会介绍的&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__all__</span></code>&nbsp;变量。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">包的用户可以从包中导入单个模块，例如:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">sound.effects.echo</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">这会加载子模块&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sound.effects.echo</span></code>&nbsp;。但引用它时必须使用它的全名。</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="n">sound</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">effects</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">echo</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">echofilter</span><span class="p">(</span><span class="nb" style="color: rgb(0, 112, 32);">input</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">delay</span><span class="o" style="color: rgb(102, 102, 102);">=</span><span class="mf" style="color: rgb(32, 128, 80);">0.7</span><span class="p">,</span> <span class="n">atten</span><span class="o" style="color: rgb(102, 102, 102);">=</span><span class="mi" style="color: rgb(32, 128, 80);">4</span><span class="p">)</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">导入子模块的另一种方法是</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">sound.effects</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n">echo</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">这也会加载子模块&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">echo</span></code>&nbsp;，并使其在没有包前缀的情况下可用，因此可以按如下方式使用:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="n">echo</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">echofilter</span><span class="p">(</span><span class="nb" style="color: rgb(0, 112, 32);">input</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">delay</span><span class="o" style="color: rgb(102, 102, 102);">=</span><span class="mf" style="color: rgb(32, 128, 80);">0.7</span><span class="p">,</span> <span class="n">atten</span><span class="o" style="color: rgb(102, 102, 102);">=</span><span class="mi" style="color: rgb(32, 128, 80);">4</span><span class="p">)</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">另一种形式是直接导入所需的函数或变量:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">sound.effects.echo</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n">echofilter</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">同样，这也会加载子模块&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">echo</span></code>，但这会使其函数&nbsp;<code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">echofilter()</span></code>&nbsp;直接可用:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="n">echofilter</span><span class="p">(</span><span class="nb" style="color: rgb(0, 112, 32);">input</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">delay</span><span class="o" style="color: rgb(102, 102, 102);">=</span><span class="mf" style="color: rgb(32, 128, 80);">0.7</span><span class="p">,</span> <span class="n">atten</span><span class="o" style="color: rgb(102, 102, 102);">=</span><span class="mi" style="color: rgb(32, 128, 80);">4</span><span class="p">)</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">请注意，当使用&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">from</span>&nbsp;<span class="pre" style="hyphens: none;">package</span>&nbsp;<span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">item</span></code>&nbsp;时，item可以是包的子模块（或子包），也可以是包中定义的其他名称，如函数，类或变量。&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code>&nbsp;语句首先测试是否在包中定义了item；如果没有，它假定它是一个模块并尝试加载它。如果找不到它，则引发&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ImportError" title="ImportError" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ImportError</span></code></a>&nbsp;异常。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">相反，当使用&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">item.subitem.subsubitem</span></code>&nbsp;这样的语法时，除了最后一项之外的每一项都必须是一个包；最后一项可以是模块或包，但不能是前一项中定义的类或函数或变量。</p><h4>从包中导入 *</h4><p id="index-8" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">当用户写&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">from</span>&nbsp;<span class="pre" style="hyphens: none;">sound.effects</span>&nbsp;<span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">*</span></code>&nbsp;会发生什么？理想情况下，人们希望这会以某种方式传递给文件系统，找到包中存在哪些子模块，并将它们全部导入。这可能需要很长时间，导入子模块可能会产生不必要的副作用，这种副作用只有在显式导入子模块时才会发生。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">唯一的解决方案是让包作者提供一个包的显式索引。<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;语句使用下面的规范：如果一个包的&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py</span></code>&nbsp;代码定义了一个名为&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__all__</span></code>&nbsp;的列表，它会被视为在遇到&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">from</span>&nbsp;<span class="pre" style="hyphens: none;">package&nbsp;</span><span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">*</span></code>&nbsp;时应该导入的模块名列表。在发布该包的新版本时，包作者可以决定是否让此列表保持更新。包作者如果认为从他们的包中导入 * 的操作没有必要被使用，也可以决定不支持此列表。例如，文件&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sound/effects/__init__.py</span></code>&nbsp;可以包含以下代码:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="n">__all__</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="p">[</span><span class="s2" style="color: rgb(64, 112, 160);">"echo"</span><span class="p">,</span> <span class="s2" style="color: rgb(64, 112, 160);">"surround"</span><span class="p">,</span> <span class="s2" style="color: rgb(64, 112, 160);">"reverse"</span><span class="p">]</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">这意味着&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">from</span>&nbsp;<span class="pre" style="hyphens: none;">sound.effects</span>&nbsp;<span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">*</span></code>&nbsp;将导入&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sound</span></code>&nbsp;包的三个命名子模块。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">如果没有定义&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__all__</span></code>，<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">from</span>&nbsp;<span class="pre" style="hyphens: none;">sound.effects</span>&nbsp;<span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">*</span></code>&nbsp;语句&nbsp;<em>不</em>&nbsp;会从包&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sound.effects</span></code>中导入所有子模块到当前命名空间；它只确保导入了包&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sound.effects</span></code>&nbsp;（可能运行任何在&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py</span></code>&nbsp;中的初始化代码），然后导入包中定义的任何名称。这包括&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py`</span></code>&nbsp;定义的任何名称（以及显式加载的子模块）。它还包括由之前的&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;语句显式加载的包的任何子模块。思考下面的代码:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">sound.effects.echo</span>
<span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">sound.effects.surround</span>
<span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">sound.effects</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="o" style="color: rgb(102, 102, 102);">*</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">在这个例子中，&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">echo</span></code>&nbsp;和&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">surround</span></code>&nbsp;模块是在执行&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">from...import</span></code>&nbsp;语句时导入到当前命名空间中的，因为它们定义在&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sound.effects</span></code>&nbsp;包中。（这在定义了&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__all__</span></code>&nbsp;时也有效。）</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">虽然某些模块被设计为在使用&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">*</span></code>&nbsp;时只导出遵循某些模式的名称，但在生产代码中它仍然被认为是不好的做法。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">请记住，使用&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">from</span>&nbsp;<span class="pre" style="hyphens: none;">Package</span>&nbsp;<span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">specific_submodule</span></code>&nbsp;没有任何问题！实际上，除非导入模块需要使用来自不同包的同名子模块，否则这是推荐的表示法。</p><h4>子包参考</h4><div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">当包被构造成子包时（与示例中的&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sound</span></code>&nbsp;包一样），你可以使用绝对导入来引用兄弟包的子模块。例如，如果模块&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sound.filters.vocoder</span></code>&nbsp;需要在&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sound.effects</span></code>&nbsp;包中使用&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">echo</span></code>&nbsp;模块，它可以使用&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">from</span>&nbsp;<span class="pre" style="hyphens: none;">sound.effects</span>&nbsp;<span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">echo</span></code>&nbsp;。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">你还可以使用import语句的&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">from</span>&nbsp;<span class="pre" style="hyphens: none;">module</span>&nbsp;<span class="pre" style="hyphens: none;">import</span>&nbsp;<span class="pre" style="hyphens: none;">name</span></code>&nbsp;形式编写相对导入。这些导入使用前导点来指示相对导入中涉及的当前包和父包。例如，从&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">surround</span></code>&nbsp;模块，你可以使用:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">.</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n">echo</span>
<span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">..</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n">formats</span>
<span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">..filters</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n">equalizer</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">请注意，相对导入是基于当前模块的名称进行导入的。由于主模块的名称总是&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">"__main__"</span></code>&nbsp;，因此用作Python应用程序主模块的模块必须始终使用绝对导入。</p></div><h4>多个目录中的包</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">包支持另一个特殊属性，&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/import.html#__path__" title="__path__" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-attr docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code></a>&nbsp;。它被初始化为一个列表，其中包含在执行该文件中的代码之前保存包的文件&nbsp;<code class="file docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py</span></code>&nbsp;的目录的名称。这个变量可以修改；这样做会影响将来对包中包含的模块和子包的搜索。</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">虽然通常不需要此功能，但它可用于扩展程序包中的模块集。</p><h2>The import system</h2><p id="index-0" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Python code in one&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-module" style="color: rgb(99, 99, 187); text-decoration-line: none;">module</a>&nbsp;gains access to the code in another module by the process of&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-importing" style="color: rgb(99, 99, 187); text-decoration-line: none;">importing</a>&nbsp;it. The&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;statement is the most common way of invoking the import machinery, but it is not the only way. Functions such as&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.import_module" title="importlib.import_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib.import_module()</span></code></a>and built-in&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#__import__" title="__import__" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__import__()</span></code></a>&nbsp;can also be used to invoke the import machinery.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;statement combines two operations; it searches for the named module, then it binds the results of that search to a name in the local scope. The search operation of the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;statement is defined as a call to the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#__import__" title="__import__" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__import__()</span></code></a>&nbsp;function, with the appropriate arguments. The return value of&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#__import__" title="__import__" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__import__()</span></code></a>&nbsp;is used to perform the name binding operation of the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;statement. See the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;statement for the exact details of that name binding operation.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">A direct call to&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#__import__" title="__import__" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__import__()</span></code></a>&nbsp;performs only the module search and, if found, the module creation operation. While certain side-effects may occur, such as the importing of parent packages, and the updating of various caches (including&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>), only the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;statement performs a name binding operation.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">When an&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;statement is executed, the standard builtin&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#__import__" title="__import__" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__import__()</span></code></a>&nbsp;function is called. Other mechanisms for invoking the import system (such as&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.import_module" title="importlib.import_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib.import_module()</span></code></a>) may choose to bypass&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#__import__" title="__import__" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__import__()</span></code></a>&nbsp;and use their own solutions to implement import semantics.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">When a module is first imported, Python searches for the module and if found, it creates a module object&nbsp;<a class="footnote-reference" href="https://docs.python.org/zh-cn/3/reference/import.html#fnmo" id="id1" style="color: rgb(99, 99, 187); text-decoration-line: none;">[1]</a>, initializing it. If the named module cannot be found, a&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ModuleNotFoundError" title="ModuleNotFoundError" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ModuleNotFoundError</span></code></a>&nbsp;is raised. Python implements various strategies to search for the named module when the import machinery is invoked. These strategies can be modified and extended by using various hooks described in the sections below.</p><div class="versionchanged" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.3 版更改:&nbsp;</span>The import system has been updated to fully implement the second phase of&nbsp;<span class="target" id="index-1"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0302" style="color: rgb(99, 99, 187); text-decoration-line: none;"><strong>PEP 302</strong></a>. There is no longer any implicit import machinery - the full import system is exposed through&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.meta_path" title="sys.meta_path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.meta_path</span></code></a>. In addition, native namespace package support has been implemented (see&nbsp;<span class="target" id="index-2"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0420" style="color: rgb(99, 99, 187); text-decoration-line: none;"><strong>PEP 420</strong></a>).</p></div><h3>importlib</h3><p><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">The&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery." style="color: rgb(99, 99, 187); text-decoration-line: none; font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib</span></code></a><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">&nbsp;module provides a rich API for interacting with the import system. For example&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.import_module" title="importlib.import_module" style="color: rgb(99, 99, 187); text-decoration-line: none; font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib.import_module()</span></code></a><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">&nbsp;provides a recommended, simpler API than built-in&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#__import__" title="__import__" style="color: rgb(99, 99, 187); text-decoration-line: none; font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__import__()</span></code></a><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">&nbsp;for invoking the import machinery. Refer to the&nbsp;</span><code class="xref py py-mod docutils literal notranslate" style="color: rgb(99, 99, 187); text-decoration-line: none; font-family: monospace, sans-serif; font-size: 15.44px; text-align: justify; background-color: transparent; padding: 0px 1px; border-radius: 3px;"><span class="pre" style="hyphens: none;"><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery." style="color: rgb(99, 99, 187); text-decoration-line: none; font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">importlib</a>&nbsp;</span></code><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">library documentation for additional detail.</span><br></p><h3>包</h3><div><p class="first" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); margin-top: 0px !important;">一种可包含子模块或递归地包含子包的 Python&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-module" style="color: rgb(99, 99, 187); text-decoration-line: none;">module</a>。从技术上说，包是带有&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;属性的 Python 模块。</p></div><p id="index-3" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Python has only one type of module object, and all modules are of this type, regardless of whether the module is implemented in Python, C, or something else. To help organize modules and provide a naming hierarchy, Python has a concept of&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-package" style="color: rgb(99, 99, 187); text-decoration-line: none;">packages</a>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">You can think of packages as the directories on a file system and modules as files within directories, but don’t take this analogy too literally since packages and modules need not originate from the file system. For the purposes of this documentation, we’ll use this convenient analogy of directories and files. Like file system directories, packages are organized hierarchically, and packages may themselves contain subpackages, as well as regular modules.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">It’s important to keep in mind that all packages are modules, but not all modules are packages. Or put another way, packages are just a special kind of module. Specifically, any module that contains a&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;attribute is considered a package.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">All modules have a name. Subpackage names are separated from their parent package name by dots, akin to Python’s standard attribute access syntax. Thus you might have a module called&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#module-sys" title="sys: Access system-specific parameters and functions." style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys</span></code></a>&nbsp;and a package called&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/email.html#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages." style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">email</span></code></a>, which in turn has a subpackage called&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/email.mime.html#module-email.mime" title="email.mime: Build MIME messages." style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">email.mime</span></code></a>&nbsp;and a module within that subpackage called&nbsp;<code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">email.mime.text</span></code>.</p><h4>Regular packages</h4><p id="index-4" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Python defines two types of packages,&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-regular-package" style="color: rgb(99, 99, 187); text-decoration-line: none;">regular packages</a>&nbsp;and&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-namespace-package" style="color: rgb(99, 99, 187); text-decoration-line: none;">namespace packages</a>. Regular packages are traditional packages as they existed in Python 3.2 and earlier. A regular package is typically implemented as a directory containing an&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py</span></code>&nbsp;file. When a regular package is imported, this&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py</span></code>&nbsp;file is implicitly executed, and the objects it defines are bound to names in the package’s namespace. The&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py</span></code>&nbsp;file can contain the same Python code that any other module can contain, and Python will add some additional attributes to the module when it is imported.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">For example, the following file system layout defines a top level&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent</span></code>&nbsp;package with three subpackages:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="n">parent</span><span class="o" style="color: rgb(102, 102, 102);">/</span>
    <span class="fm" style="color: rgb(6, 40, 126);">__init__</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">py</span>
    <span class="n">one</span><span class="o" style="color: rgb(102, 102, 102);">/</span>
        <span class="fm" style="color: rgb(6, 40, 126);">__init__</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">py</span>
    <span class="n">two</span><span class="o" style="color: rgb(102, 102, 102);">/</span>
        <span class="fm" style="color: rgb(6, 40, 126);">__init__</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">py</span>
    <span class="n">three</span><span class="o" style="color: rgb(102, 102, 102);">/</span>
        <span class="fm" style="color: rgb(6, 40, 126);">__init__</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">py</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Importing&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent.one</span></code>&nbsp;will implicitly execute&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent/__init__.py</span></code>&nbsp;and&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent/one/__init__.py</span></code>. Subsequent imports of&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent.two</span></code>&nbsp;or&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent.three</span></code>&nbsp;will execute&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent/two/__init__.py</span></code>&nbsp;and&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent/three/__init__.py</span></code>&nbsp;respectively.</p><h4>Namespace packages</h4><p id="index-5" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">A namespace package is a composite of various&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-portion" style="color: rgb(99, 99, 187); text-decoration-line: none;">portions</a>, where each portion contributes a subpackage to the parent package. Portions may reside in different locations on the file system. Portions may also be found in zip files, on the network, or anywhere else that Python searches during import. Namespace packages may or may not correspond directly to objects on the file system; they may be virtual modules that have no concrete representation.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Namespace packages do not use an ordinary list for their&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;attribute. They instead use a custom iterable type which will automatically perform a new search for package portions on the next import attempt within that package if the path of their parent package (or&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>&nbsp;for a top level package) changes.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">With namespace packages, there is no&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent/__init__.py</span></code>&nbsp;file. In fact, there may be multiple&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent</span></code>&nbsp;directories found during import search, where each one is provided by a different portion. Thus&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent/one</span></code>&nbsp;may not be physically located next to&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent/two</span></code>. In this case, Python will create a namespace package for the top-level&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">parent</span></code>&nbsp;package whenever it or one of its subpackages is imported.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">See also&nbsp;<span class="target" id="index-6"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0420" style="color: rgb(99, 99, 187); text-decoration-line: none;"><strong>PEP 420</strong></a>&nbsp;for the namespace package specification.</p><h3>Searching</h3><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">To begin the search, Python needs the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-qualified-name" style="color: rgb(99, 99, 187); text-decoration-line: none;">fully qualified</a>&nbsp;name of the module (or package, but for the purposes of this discussion, the difference is immaterial) being imported. This name may come from various arguments to the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#import" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-keyword docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code></a>&nbsp;statement, or from the parameters to the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.import_module" title="importlib.import_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib.import_module()</span></code></a>&nbsp;or&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#__import__" title="__import__" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__import__()</span></code></a>&nbsp;functions.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">This name will be used in various phases of the import search, and it may be the dotted path to a submodule, e.g.&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo.bar.baz</span></code>. In this case, Python first tries to import&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo</span></code>, then&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo.bar</span></code>, and finally&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo.bar.baz</span></code>. If any of the intermediate imports fail, a&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ModuleNotFoundError" title="ModuleNotFoundError" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ModuleNotFoundError</span></code></a>&nbsp;is raised.</p><h4>The module cache</h4><p id="index-7" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The first place checked during import search is&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>. This mapping serves as a cache of all modules that have been previously imported, including the intermediate paths. So if&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo.bar.baz</span></code>&nbsp;was previously imported,&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>&nbsp;will contain entries for&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo</span></code>,&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo.bar</span></code>, and&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo.bar.baz</span></code>. Each key will have as its value the corresponding module object.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">During import, the module name is looked up in&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>&nbsp;and if present, the associated value is the module satisfying the import, and the process completes. However, if the value is&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>, then a&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ModuleNotFoundError" title="ModuleNotFoundError" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ModuleNotFoundError</span></code></a>&nbsp;is raised. If the module name is missing, Python will continue searching for the module.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>&nbsp;is writable. Deleting a key may not destroy the associated module (as other modules may hold references to it), but it will invalidate the cache entry for the named module, causing Python to search anew for the named module upon its next import. The key can also be assigned to&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>, forcing the next import of the module to result in a&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ModuleNotFoundError" title="ModuleNotFoundError" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ModuleNotFoundError</span></code></a>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Beware though, as if you keep a reference to the module object, invalidate its cache entry in&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>, and then re-import the named module, the two module objects will&nbsp;<em>not</em>&nbsp;be the same. By contrast,&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.reload" title="importlib.reload" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib.reload()</span></code></a>&nbsp;will reuse the&nbsp;<em>same</em>&nbsp;module object, and simply reinitialise the module contents by rerunning the module’s code.</p><h4>Finders and loaders</h4><p id="index-8" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">If the named module is not found in&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>, then Python’s import protocol is invoked to find and load the module. This protocol consists of two conceptual objects,&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-finder" style="color: rgb(99, 99, 187); text-decoration-line: none;">finders</a>&nbsp;and&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-loader" style="color: rgb(99, 99, 187); text-decoration-line: none;">loaders</a>. A finder’s job is to determine whether it can find the named module using whatever strategy it knows about. Objects that implement both of these interfaces are referred to as&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-importer" style="color: rgb(99, 99, 187); text-decoration-line: none;">importers</a>&nbsp;- they return themselves when they find that they can load the requested module.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Python includes a number of default finders and importers. The first one knows how to locate built-in modules, and the second knows how to locate frozen modules. A third default finder searches an&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-import-path" style="color: rgb(99, 99, 187); text-decoration-line: none;">import path</a>&nbsp;for modules. The&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-import-path" style="color: rgb(99, 99, 187); text-decoration-line: none;">import path</a>&nbsp;is a list of locations that may name file system paths or zip files. It can also be extended to search for any locatable resource, such as those identified by URLs.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The import machinery is extensible, so new finders can be added to extend the range and scope of module searching.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Finders do not actually load modules. If they can find the named module, they return a&nbsp;<em class="dfn">module spec</em>, an encapsulation of the module’s import-related information, which the import machinery then uses when loading the module.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The following sections describe the protocol for finders and loaders in more detail, including how you can create and register new ones to extend the import machinery.</p><div class="versionchanged" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.4 版更改:&nbsp;</span>In previous versions of Python, finders returned&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-loader" style="color: rgb(99, 99, 187); text-decoration-line: none;">loaders</a>&nbsp;directly, whereas now they return module specs which&nbsp;<em>contain</em>&nbsp;loaders. Loaders are still used during import but have fewer responsibilities.</p></div><h4>Import hooks</h4><p id="index-9" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The import machinery is designed to be extensible; the primary mechanism for this are the&nbsp;<em>import hooks</em>. There are two types of import hooks:&nbsp;<em>meta hooks</em>&nbsp;and&nbsp;<em>import path hooks</em>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Meta hooks are called at the start of import processing, before any other import processing has occurred, other than&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>&nbsp;cache look up. This allows meta hooks to override&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>&nbsp;processing, frozen modules, or even built-in modules. Meta hooks are registered by adding new finder objects to&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.meta_path" title="sys.meta_path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.meta_path</span></code></a>, as described below.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Import path hooks are called as part of&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>&nbsp;(or&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">package.__path__</span></code>) processing, at the point where their associated path item is encountered. Import path hooks are registered by adding new callables to&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_hooks" title="sys.path_hooks" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_hooks</span></code></a>&nbsp;as described below.</p><h4>The meta path</h4><p id="index-10" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">When the named module is not found in&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>, Python next searches&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.meta_path" title="sys.meta_path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.meta_path</span></code></a>, which contains a list of meta path finder objects. These finders are queried in order to see if they know how to handle the named module. Meta path finders must implement a method called&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.MetaPathFinder.find_spec" title="importlib.abc.MetaPathFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a>&nbsp;which takes three arguments: a name, an import path, and (optionally) a target module. The meta path finder can use any strategy it wants to determine whether it can handle the named module or not.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">If the meta path finder knows how to handle the named module, it returns a spec object. If it cannot handle the named module, it returns&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>. If&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.meta_path" title="sys.meta_path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.meta_path</span></code></a>processing reaches the end of its list without returning a spec, then a&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ModuleNotFoundError" title="ModuleNotFoundError" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ModuleNotFoundError</span></code></a>&nbsp;is raised. Any other exceptions raised are simply propagated up, aborting the import process.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.MetaPathFinder.find_spec" title="importlib.abc.MetaPathFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a>&nbsp;method of meta path finders is called with two or three arguments. The first is the fully qualified name of the module being imported, for example&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo.bar.baz</span></code>. The second argument is the path entries to use for the module search. For top-level modules, the second argument is&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>, but for submodules or subpackages, the second argument is the value of the parent package’s&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>attribute. If the appropriate&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;attribute cannot be accessed, a&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ModuleNotFoundError" title="ModuleNotFoundError" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ModuleNotFoundError</span></code></a>&nbsp;is raised. The third argument is an existing module object that will be the target of loading later. The import system passes in a target module only during reload.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The meta path may be traversed multiple times for a single import request. For example, assuming none of the modules involved has already been cached, importing&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo.bar.baz</span></code>&nbsp;will first perform a top level import, calling&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">mpf.find_spec("foo",</span><span class="pre" style="hyphens: none;">None,</span>&nbsp;<span class="pre" style="hyphens: none;">None)</span></code>&nbsp;on each meta path finder (<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">mpf</span></code>). After&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo</span></code>&nbsp;has been imported,&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo.bar</span></code>will be imported by traversing the meta path a second time, calling<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">mpf.find_spec("foo.bar",</span>&nbsp;<span class="pre" style="hyphens: none;">foo.__path__,</span>&nbsp;<span class="pre" style="hyphens: none;">None)</span></code>. Once&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo.bar</span></code>&nbsp;has been imported, the final traversal will call&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">mpf.find_spec("foo.bar.baz",</span><span class="pre" style="hyphens: none;">foo.bar.__path__,</span>&nbsp;<span class="pre" style="hyphens: none;">None)</span></code>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Some meta path finders only support top level imports. These importers will always return&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>&nbsp;when anything other than&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>&nbsp;is passed as the second argument.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Python’s default&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.meta_path" title="sys.meta_path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.meta_path</span></code></a>&nbsp;has three meta path finders, one that knows how to import built-in modules, one that knows how to import frozen modules, and one that knows how to import modules from an&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-import-path" style="color: rgb(99, 99, 187); text-decoration-line: none;">import path</a>&nbsp;(i.e. the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-based-finder" style="color: rgb(99, 99, 187); text-decoration-line: none;">path based finder</a>).</p><div class="versionchanged" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.4 版更改:&nbsp;</span>The&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.MetaPathFinder.find_spec" title="importlib.abc.MetaPathFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a>&nbsp;method of meta path finders replaced&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.MetaPathFinder.find_module" title="importlib.abc.MetaPathFinder.find_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_module()</span></code></a>, which is now deprecated. While it will continue to work without change, the import machinery will try it only if the finder does not implement&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code>.</p></div><h3>Loading</h3><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">If and when a module spec is found, the import machinery will use it (and the loader it contains) when loading the module. Here is an approximation of what happens during the loading portion of import:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="n">module</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="kc" style="color: rgb(0, 112, 32); font-weight: bold;">None</span>
<span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">if</span> <span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">loader</span> <span class="ow" style="color: rgb(0, 112, 32); font-weight: bold;">is</span> <span class="ow" style="color: rgb(0, 112, 32); font-weight: bold;">not</span> <span class="kc" style="color: rgb(0, 112, 32); font-weight: bold;">None</span> <span class="ow" style="color: rgb(0, 112, 32); font-weight: bold;">and</span> <span class="nb" style="color: rgb(0, 112, 32);">hasattr</span><span class="p">(</span><span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">loader</span><span class="p">,</span> <span class="s1" style="color: rgb(64, 112, 160);">'create_module'</span><span class="p">):</span>
    <span class="c1" style="color: rgb(64, 128, 144); font-style: italic;"># It is assumed 'exec_module' will also be defined on the loader.</span>
    <span class="n">module</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">loader</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">create_module</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
<span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">if</span> <span class="n">module</span> <span class="ow" style="color: rgb(0, 112, 32); font-weight: bold;">is</span> <span class="kc" style="color: rgb(0, 112, 32); font-weight: bold;">None</span><span class="p">:</span>
    <span class="n">module</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="n">ModuleType</span><span class="p">(</span><span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1" style="color: rgb(64, 128, 144); font-style: italic;"># The import-related module attributes get set here:</span>
<span class="n">_init_module_attrs</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>

<span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">if</span> <span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">loader</span> <span class="ow" style="color: rgb(0, 112, 32); font-weight: bold;">is</span> <span class="kc" style="color: rgb(0, 112, 32); font-weight: bold;">None</span><span class="p">:</span>
    <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">if</span> <span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">submodule_search_locations</span> <span class="ow" style="color: rgb(0, 112, 32); font-weight: bold;">is</span> <span class="ow" style="color: rgb(0, 112, 32); font-weight: bold;">not</span> <span class="kc" style="color: rgb(0, 112, 32); font-weight: bold;">None</span><span class="p">:</span>
        <span class="c1" style="color: rgb(64, 128, 144); font-style: italic;"># namespace package</span>
        <span class="n">sys</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">modules</span><span class="p">[</span><span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">name</span><span class="p">]</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="n">module</span>
    <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">else</span><span class="p">:</span>
        <span class="c1" style="color: rgb(64, 128, 144); font-style: italic;"># unsupported</span>
        <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">raise</span> <span class="ne" style="color: rgb(0, 112, 32);">ImportError</span>
<span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">elif</span> <span class="ow" style="color: rgb(0, 112, 32); font-weight: bold;">not</span> <span class="nb" style="color: rgb(0, 112, 32);">hasattr</span><span class="p">(</span><span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">loader</span><span class="p">,</span> <span class="s1" style="color: rgb(64, 112, 160);">'exec_module'</span><span class="p">):</span>
    <span class="n">module</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">loader</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">load_module</span><span class="p">(</span><span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">name</span><span class="p">)</span>
    <span class="c1" style="color: rgb(64, 128, 144); font-style: italic;"># Set __loader__ and __package__ if missing.</span>
<span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">else</span><span class="p">:</span>
    <span class="n">sys</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">modules</span><span class="p">[</span><span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">name</span><span class="p">]</span> <span class="o" style="color: rgb(102, 102, 102);">=</span> <span class="n">module</span>
    <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">try</span><span class="p">:</span>
        <span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">loader</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">exec_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
    <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">except</span> <span class="ne" style="color: rgb(0, 112, 32);">BaseException</span><span class="p">:</span>
        <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">try</span><span class="p">:</span>
            <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">del</span> <span class="n">sys</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">modules</span><span class="p">[</span><span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">name</span><span class="p">]</span>
        <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">except</span> <span class="ne" style="color: rgb(0, 112, 32);">KeyError</span><span class="p">:</span>
            <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">pass</span>
        <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">raise</span>
<span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">return</span> <span class="n">sys</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">modules</span><span class="p">[</span><span class="n">spec</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">name</span><span class="p">]</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Note the following details:</p><blockquote style="hyphens: auto; text-align: justify; line-height: 20.8px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><ul class="simple"><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">If there is an existing module object with the given name in<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>, import will have already returned it.</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">The module will exist in&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>&nbsp;before the loader executes the module code. This is crucial because the module code may (directly or indirectly) import itself; adding it to&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>&nbsp;beforehand prevents unbounded recursion in the worst case and multiple loading in the best.</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">If loading fails, the failing module – and only the failing module – gets removed from&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>. Any module already in the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>cache, and any module that was successfully loaded as a side-effect, must remain in the cache. This contrasts with reloading where even the failing module is left in&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>.</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">After the module is created but before execution, the import machinery sets the import-related module attributes (“_init_module_attrs” in the pseudo-code example above), as summarized in a&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/import.html#import-mod-attrs" style="color: rgb(99, 99, 187); text-decoration-line: none;">later section</a>.</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">Module execution is the key moment of loading in which the module’s namespace gets populated. Execution is entirely delegated to the loader, which gets to decide what gets populated and how.</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">The module created during loading and passed to exec_module() may not be the one returned at the end of import&nbsp;<a class="footnote-reference" href="https://docs.python.org/zh-cn/3/reference/import.html#fnlo" id="id2" style="color: rgb(99, 99, 187); text-decoration-line: none;">[2]</a>.</li></ul></blockquote><div class="versionchanged" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.4 版更改:&nbsp;</span>The import system has taken over the boilerplate responsibilities of loaders. These were previously performed by the<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.Loader.load_module" title="importlib.abc.Loader.load_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib.abc.Loader.load_module()</span></code></a>&nbsp;method.</p></div><h4>Loaders</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Module loaders provide the critical function of loading: module execution. The import machinery calls the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.Loader.exec_module" title="importlib.abc.Loader.exec_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib.abc.Loader.exec_module()</span></code></a>&nbsp;method with a single argument, the module object to execute. Any value returned from&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.Loader.exec_module" title="importlib.abc.Loader.exec_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">exec_module()</span></code></a>&nbsp;is ignored.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Loaders must satisfy the following requirements:</p><blockquote style="hyphens: auto; text-align: justify; line-height: 20.8px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><ul class="simple"><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">If the module is a Python module (as opposed to a built-in module or a dynamically loaded extension), the loader should execute the module’s code in the module’s global name space (<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">module.__dict__</span></code>).</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">If the loader cannot execute the module, it should raise an<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ImportError" title="ImportError" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ImportError</span></code></a>, although any other exception raised during<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.Loader.exec_module" title="importlib.abc.Loader.exec_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">exec_module()</span></code></a>&nbsp;will be propagated.</li></ul></blockquote><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">In many cases, the finder and loader can be the same object; in such cases the<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.MetaPathFinder.find_spec" title="importlib.abc.MetaPathFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a>&nbsp;method would just return a spec with the loader set to&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">self</span></code>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Module loaders may opt in to creating the module object during loading by implementing a&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.Loader.create_module" title="importlib.abc.Loader.create_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">create_module()</span></code></a>&nbsp;method. It takes one argument, the module spec, and returns the new module object to use during loading.&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">create_module()</span></code>&nbsp;does not need to set any attributes on the module object. If the method returns&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>, the import machinery will create the new module itself.</p><div class="versionadded" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">3.4 新版功能:&nbsp;</span>The&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.Loader.create_module" title="importlib.abc.Loader.create_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">create_module()</span></code></a>&nbsp;method of loaders.</p></div><div class="versionchanged" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.4 版更改:&nbsp;</span>The&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.Loader.load_module" title="importlib.abc.Loader.load_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">load_module()</span></code></a>&nbsp;method was replaced by&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.Loader.exec_module" title="importlib.abc.Loader.exec_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">exec_module()</span></code></a>&nbsp;and the import machinery assumed all the boilerplate responsibilities of loading.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">For compatibility with existing loaders, the import machinery will use the&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">load_module()</span></code>&nbsp;method of loaders if it exists and the loader does not also implement&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">exec_module()</span></code>. However,&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">load_module()</span></code>&nbsp;has been deprecated and loaders should implement&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">exec_module()</span></code>&nbsp;instead.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">The&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">load_module()</span></code>&nbsp;method must implement all the boilerplate loading functionality described above in addition to executing the module. All the same constraints apply, with some additional clarification:</p><blockquote style="hyphens: auto; text-align: justify; line-height: 20.8px;"><ul class="simple"><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">If there is an existing module object with the given name in<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>, the loader must use that existing module. (Otherwise,&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.reload" title="importlib.reload" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib.reload()</span></code></a>&nbsp;will not work correctly.) If the named module does not exist in&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>, the loader must create a new module object and add it to&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>.</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">The module&nbsp;<em>must</em>&nbsp;exist in&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>&nbsp;before the loader executes the module code, to prevent unbounded recursion or multiple loading.</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">If loading fails, the loader must remove any modules it has inserted into&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules</span></code></a>, but it must remove&nbsp;<strong>only</strong>&nbsp;the failing module(s), and only if the loader itself has loaded the module(s) explicitly.</li></ul></blockquote></div><div class="versionchanged" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.5 版更改:&nbsp;</span>A&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#DeprecationWarning" title="DeprecationWarning" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">DeprecationWarning</span></code></a>&nbsp;is raised when&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">exec_module()</span></code>&nbsp;is defined but<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">create_module()</span></code>&nbsp;is not.</p></div><div class="versionchanged" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.6 版更改:&nbsp;</span>An&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ImportError" title="ImportError" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ImportError</span></code></a>&nbsp;is raised when&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">exec_module()</span></code>&nbsp;is defined but<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">create_module()</span></code>&nbsp;is not.</p></div><h4>Submodules</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">When a submodule is loaded using any mechanism (e.g.&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib</span></code>&nbsp;APIs, the&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import</span></code>&nbsp;or&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">import-from</span></code>&nbsp;statements, or built-in&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__import__()</span></code>) a binding is placed in the parent module’s namespace to the submodule object. For example, if package&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">spam</span></code>&nbsp;has a submodule&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo</span></code>, after importing&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">spam.foo</span></code>,&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">spam</span></code>&nbsp;will have an attribute&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo</span></code>&nbsp;which is bound to the submodule. Let’s say you have the following directory structure:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="n">spam</span><span class="o" style="color: rgb(102, 102, 102);">/</span>
    <span class="fm" style="color: rgb(6, 40, 126);">__init__</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">py</span>
    <span class="n">foo</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">py</span>
    <span class="n">bar</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">py</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">and&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">spam/__init__.py</span></code>&nbsp;has the following lines in it:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">.foo</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n">Foo</span>
<span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">.bar</span> <span class="k" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n">Bar</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">then executing the following puts a name binding to&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo</span></code>&nbsp;and&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">bar</span></code>&nbsp;in the&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">spam</span></code>&nbsp;module:</p><div class="highlight-python3 notranslate" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255); position: relative;"><div class="highlight" style="background: rgb(238, 255, 204);"><span class="copybutton" title="Hide the prompts and output" style="cursor: pointer; position: absolute; top: 0px; right: 0px; border-color: rgb(170, 204, 153); border-style: solid; border-width: 1px; color: rgb(170, 204, 153); font-family: monospace; padding-left: 0.2em; padding-right: 0.2em; border-radius: 0px 3px 0px 0px;">&gt;&gt;&gt;</span><pre style="overflow-y: hidden; padding: 5px; background-color: rgb(238, 255, 204); color: rgb(51, 51, 51); line-height: 18.528px; border: 1px solid rgb(170, 204, 153); font-family: monospace, sans-serif; font-size: 15.44px;"><span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="kn" style="color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="color: rgb(14, 132, 181); font-weight: bold;">spam</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">spam</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">foo</span>
<span class="go">&lt;module 'spam.foo' from '/tmp/imports/spam/foo.py'&gt;</span>
<span class="gp" style="color: rgb(198, 93, 9); font-weight: bold;">&gt;&gt;&gt; </span><span class="n">spam</span><span class="o" style="color: rgb(102, 102, 102);">.</span><span class="n">bar</span>
<span class="go">&lt;module 'spam.bar' from '/tmp/imports/spam/bar.py'&gt;</span>
</pre></div></div><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Given Python’s familiar name binding rules this might seem surprising, but it’s actually a fundamental feature of the import system. The invariant holding is that if you have&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules['spam']</span></code>&nbsp;and&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.modules['spam.foo']</span></code>&nbsp;(as you would after the above import), the latter must appear as the&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">foo</span></code>&nbsp;attribute of the former.</p><h4>Module spec</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The import machinery uses a variety of information about each module during import, especially before loading. Most of the information is common to all modules. The purpose of a module’s spec is to encapsulate this import-related information on a per-module basis.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Using a spec during import allows state to be transferred between import system components, e.g. between the finder that creates the module spec and the loader that executes it. Most importantly, it allows the import machinery to perform the boilerplate operations of loading, whereas without a module spec the loader had that responsibility.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The module’s spec is exposed as the&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__</span></code>&nbsp;attribute on a module object. See&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.machinery.ModuleSpec" title="importlib.machinery.ModuleSpec" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-class docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ModuleSpec</span></code></a>&nbsp;for details on the contents of the module spec.</p><div class="versionadded" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">3.4 新版功能.</span></p></div><h4>Import-related module attributes</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The import machinery fills in these attributes on each module object during loading, based on the module’s spec, before the loader executes the module.</p><dl class="attribute" style="margin-bottom: 15px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><dt id="__name__"><code class="descname" style="background-color: transparent; padding: 0px 1px; font-size: 19.2px; font-family: monospace, sans-serif; font-weight: bold; border-radius: 3px;">__name__</code><a class="headerlink" href="https://docs.python.org/zh-cn/3/reference/import.html#__name__" title="永久链接至目标" style="color: rgb(99, 99, 187); text-decoration-line: none; visibility: hidden; font-size: 0.8em; padding: 0px 4px;"></a></dt><dd style="margin-top: 3px; margin-bottom: 10px; margin-left: 30px; hyphens: auto; text-align: justify; line-height: 20.8px;"><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;">The&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__name__</span></code>&nbsp;attribute must be set to the fully-qualified name of the module. This name is used to uniquely identify the module in the import system.</p></dd></dl><dl class="attribute" style="margin-bottom: 15px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><dt id="__loader__"><code class="descname" style="background-color: transparent; padding: 0px 1px; font-size: 19.2px; font-family: monospace, sans-serif; font-weight: bold; border-radius: 3px;">__loader__</code><a class="headerlink" href="https://docs.python.org/zh-cn/3/reference/import.html#__loader__" title="永久链接至目标" style="color: rgb(99, 99, 187); text-decoration-line: none; visibility: hidden; font-size: 0.8em; padding: 0px 4px;"></a></dt><dd style="margin-top: 3px; margin-bottom: 10px; margin-left: 30px; hyphens: auto; text-align: justify; line-height: 20.8px;"><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;">The&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__loader__</span></code>&nbsp;attribute must be set to the loader object that the import machinery used when loading the module. This is mostly for introspection, but can be used for additional loader-specific functionality, for example getting data associated with a loader.</p></dd></dl><dl class="attribute" style="margin-bottom: 15px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><dt id="__package__"><code class="descname" style="background-color: transparent; padding: 0px 1px; font-size: 19.2px; font-family: monospace, sans-serif; font-weight: bold; border-radius: 3px;">__package__</code><a class="headerlink" href="https://docs.python.org/zh-cn/3/reference/import.html#__package__" title="永久链接至目标" style="color: rgb(99, 99, 187); text-decoration-line: none; visibility: hidden; font-size: 0.8em; padding: 0px 4px;"></a></dt><dd style="margin-top: 3px; margin-bottom: 10px; margin-left: 30px; hyphens: auto; text-align: justify; line-height: 20.8px;"><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;">The module’s&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__package__</span></code>&nbsp;attribute must be set. Its value must be a string, but it can be the same value as its&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__name__</span></code>. When the module is a package, its&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__package__</span></code>&nbsp;value should be set to its&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__name__</span></code>. When the module is not a package,&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__package__</span></code>&nbsp;should be set to the empty string for top-level modules, or for submodules, to the parent package’s name. See&nbsp;<span class="target" id="index-11"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0366" style="color: rgb(99, 99, 187); text-decoration-line: none;"><strong>PEP 366</strong></a>&nbsp;for further details.</p><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;">This attribute is used instead of&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__name__</span></code>&nbsp;to calculate explicit relative imports for main modules, as defined in&nbsp;<span class="target" id="index-12"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0366" style="color: rgb(99, 99, 187); text-decoration-line: none;"><strong>PEP 366</strong></a>. It is expected to have the same value as&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__.parent</span></code>.</p><div class="versionchanged"><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.6 版更改:&nbsp;</span>The value of&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__package__</span></code>&nbsp;is expected to be the same as<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__.parent</span></code>.</p></div></dd></dl><dl class="attribute" style="margin-bottom: 15px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><dt id="__spec__"><code class="descname" style="background-color: transparent; padding: 0px 1px; font-size: 19.2px; font-family: monospace, sans-serif; font-weight: bold; border-radius: 3px;">__spec__</code><a class="headerlink" href="https://docs.python.org/zh-cn/3/reference/import.html#__spec__" title="永久链接至目标" style="color: rgb(99, 99, 187); text-decoration-line: none; visibility: hidden; font-size: 0.8em; padding: 0px 4px;"></a></dt><dd style="margin-top: 3px; margin-bottom: 10px; margin-left: 30px; hyphens: auto; text-align: justify; line-height: 20.8px;"><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;">The&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__</span></code>&nbsp;attribute must be set to the module spec that was used when importing the module. Setting&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__</span></code>&nbsp;appropriately applies equally to&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/toplevel_components.html#programs" style="color: rgb(99, 99, 187); text-decoration-line: none;">modules initialized during interpreter startup</a>. The one exception is&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__</span></code>, where&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__</span></code>&nbsp;is&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/import.html#main-spec" style="color: rgb(99, 99, 187); text-decoration-line: none;">set to None in some cases</a>.</p><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;">When&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__package__</span></code>&nbsp;is not defined,&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__.parent</span></code>&nbsp;is used as a fallback.</p><div class="versionadded"><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">3.4 新版功能.</span></p></div><div class="versionchanged"><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.6 版更改:&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__.parent</span></code>&nbsp;is used as a fallback when&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__package__</span></code>&nbsp;is not defined.</p></div></dd></dl><dl class="attribute" style="margin-bottom: 15px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><dt id="__path__"><code class="descname" style="background-color: transparent; padding: 0px 1px; font-size: 19.2px; font-family: monospace, sans-serif; font-weight: bold; border-radius: 3px;">__path__</code><a class="headerlink" href="https://docs.python.org/zh-cn/3/reference/import.html#__path__" title="永久链接至目标" style="color: rgb(99, 99, 187); text-decoration-line: none; visibility: hidden; font-size: 0.8em; padding: 0px 4px;"></a></dt><dd style="margin-top: 3px; margin-bottom: 10px; margin-left: 30px; hyphens: auto; text-align: justify; line-height: 20.8px;"><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;">If the module is a package (either regular or namespace), the module object’s&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;attribute must be set. The value must be iterable, but may be empty if&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;has no further significance. If&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;is not empty, it must produce strings when iterated over. More details on the semantics of&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;are given<a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/import.html#package-path-rules" style="color: rgb(99, 99, 187); text-decoration-line: none;">below</a>.</p><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;">Non-package modules should not have a&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;attribute.</p></dd></dl><dl class="attribute" style="margin-bottom: 15px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><dt id="__file__"><code class="descname" style="background-color: transparent; padding: 0px 1px; font-size: 19.2px; font-family: monospace, sans-serif; font-weight: bold; border-radius: 3px;">__file__</code><a class="headerlink" href="https://docs.python.org/zh-cn/3/reference/import.html#__file__" title="永久链接至目标" style="color: rgb(99, 99, 187); text-decoration-line: none; visibility: hidden; font-size: 0.8em; padding: 0px 4px;"></a></dt><dd style="margin-top: 3px; margin-bottom: 10px; margin-left: 30px; hyphens: auto; text-align: justify; line-height: 20.8px;"></dd></dl><dl class="attribute" style="margin-bottom: 15px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><dt id="__cached__"><code class="descname" style="background-color: transparent; padding: 0px 1px; font-size: 19.2px; font-family: monospace, sans-serif; font-weight: bold; border-radius: 3px;">__cached__</code><a class="headerlink" href="https://docs.python.org/zh-cn/3/reference/import.html#__cached__" title="永久链接至目标" style="color: rgb(99, 99, 187); text-decoration-line: none; visibility: hidden; font-size: 0.8em; padding: 0px 4px;"></a></dt><dd style="margin-top: 3px; margin-bottom: 10px; margin-left: 30px; hyphens: auto; text-align: justify; line-height: 20.8px;"><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;"><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__file__</span></code>&nbsp;is optional. If set, this attribute’s value must be a string. The import system may opt to leave&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__file__</span></code>&nbsp;unset if it has no semantic meaning (e.g. a module loaded from a database).</p><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;">If&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__file__</span></code>&nbsp;is set, it may also be appropriate to set the&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__cached__</span></code>&nbsp;attribute which is the path to any compiled version of the code (e.g. byte-compiled file). The file does not need to exist to set this attribute; the path can simply point to where the compiled file would exist (see&nbsp;<span class="target" id="index-13"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-3147" style="color: rgb(99, 99, 187); text-decoration-line: none;"><strong>PEP 3147</strong></a>).</p><p style="margin-top: 0px; hyphens: auto; line-height: 22.4px;">It is also appropriate to set&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__cached__</span></code>&nbsp;when&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__file__</span></code>&nbsp;is not set. However, that scenario is quite atypical. Ultimately, the loader is what makes use of&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__file__</span></code>and/or&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__cached__</span></code>. So if a loader can load from a cached module but otherwise does not load from a file, that atypical scenario may be appropriate.</p></dd></dl><h4>module.__path__</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">By definition, if a module has a&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;attribute, it is a package.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">A package’s&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;attribute is used during imports of its subpackages. Within the import machinery, it functions much the same as&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>, i.e. providing a list of locations to search for modules during import. However,&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;is typically much more constrained than&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;must be an iterable of strings, but it may be empty. The same rules used for&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>&nbsp;also apply to a package’s&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>, and&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_hooks" title="sys.path_hooks" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_hooks</span></code></a>&nbsp;(described below) are consulted when traversing a package’s&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">A package’s&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py</span></code>&nbsp;file may set or alter the package’s&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;attribute, and this was typically the way namespace packages were implemented prior to&nbsp;<span class="target" id="index-14"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0420" style="color: rgb(99, 99, 187); text-decoration-line: none;"><strong>PEP 420</strong></a>. With the adoption of&nbsp;<span class="target" id="index-15"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0420" style="color: rgb(99, 99, 187); text-decoration-line: none;"><strong>PEP 420</strong></a>, namespace packages no longer need to supply&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__init__.py</span></code>&nbsp;files containing only&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;manipulation code; the import machinery automatically sets&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code>&nbsp;correctly for the namespace package.</p><h4>Module reprs</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">By default, all modules have a usable repr, however depending on the attributes set above, and in the module’s spec, you can more explicitly control the repr of module objects.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">If the module has a spec (<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__</span></code>), the import machinery will try to generate a repr from it. If that fails or there is no spec, the import system will craft a default repr using whatever information is available on the module. It will try to use the&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">module.__name__</span></code>,&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">module.__file__</span></code>, and&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">module.__loader__</span></code>&nbsp;as input into the repr, with defaults for whatever information is missing.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Here are the exact rules used:</p><blockquote style="hyphens: auto; text-align: justify; line-height: 20.8px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><ul class="simple"><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">If the module has a&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__</span></code>&nbsp;attribute, the information in the spec is used to generate the repr. The “name”, “loader”, “origin”, and “has_location” attributes are consulted.</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">If the module has a&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__file__</span></code>&nbsp;attribute, this is used as part of the module’s repr.</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">If the module has no&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__file__</span></code>&nbsp;but does have a&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__loader__</span></code>&nbsp;that is not<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>, then the loader’s repr is used as part of the module’s repr.</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">Otherwise, just use the module’s&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__name__</span></code>&nbsp;in the repr.</li></ul></blockquote><div class="versionchanged" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.4 版更改:&nbsp;</span>Use of&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.Loader.module_repr" title="importlib.abc.Loader.module_repr" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">loader.module_repr()</span></code></a>&nbsp;has been deprecated and the module spec is now used by the import machinery to generate a module repr.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">For backward compatibility with Python 3.3, the module repr will be generated by calling the loader’s&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.Loader.module_repr" title="importlib.abc.Loader.module_repr" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">module_repr()</span></code></a>&nbsp;method, if defined, before trying either approach described above. However, the method is deprecated.</p></div><h4>Cached bytecode invalidation</h4><p><div class="section" id="the-path-based-finder" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"></div></p><div class="section" id="loading" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><div class="section" id="cached-bytecode-invalidation"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">Before Python loads cached bytecode from<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.pyc</span></code><span>&nbsp;</span>file, it checks whether the cache is up-to-date with the source<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.py</span></code><span>&nbsp;</span>file. By default, Python does this by storing the source’s last-modified timestamp and size in the cache file when writing it. At runtime, the import system then validates the cache file by checking the stored metadata in the cache file against at source’s metadata.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">Python also supports “hash-based” cache files, which store a hash of the source file’s contents rather than its metadata. There are two variants of hash-based<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.pyc</span></code><span>&nbsp;</span>files: checked and unchecked. For checked hash-based<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.pyc</span></code><span>&nbsp;</span>files, Python validates the cache file by hashing the source file and comparing the resulting hash with the hash in the cache file. If a checked hash-based cache file is found to be invalid, Python regenerates it and writes a new checked hash-based cache file. For unchecked hash-based<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.pyc</span></code>files, Python simply assumes the cache file is valid if it exists. Hash-based<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.pyc</span></code><span>&nbsp;</span>files validation behavior may be overridden with the<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/using/cmdline.html#cmdoption-check-hash-based-pycs" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref std std-option docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">--check-hash-based-pycs</span></code></a><span>&nbsp;</span>flag.</p><div class="versionchanged"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.7 版更改:<span>&nbsp;</span></span>Added hash-based<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.pyc</span></code><span>&nbsp;</span>files. Previously, Python only supported timestamp-based invalidation of bytecode caches.</p></div></div></div><h3>The Path Based Finder</h3><p id="index-16" style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">As mentioned previously, Python comes with several default meta path finders. One of these, called the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-based-finder" style="color: rgb(99, 99, 187); text-decoration-line: none;">path based finder</a>&nbsp;(<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.machinery.PathFinder" title="importlib.machinery.PathFinder" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-class docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">PathFinder</span></code></a>), searches an&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-import-path" style="color: rgb(99, 99, 187); text-decoration-line: none;">import path</a>, which contains a list of&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry" style="color: rgb(99, 99, 187); text-decoration-line: none;">path entries</a>. Each path entry names a location to search for modules.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The path based finder itself doesn’t know how to import anything. Instead, it traverses the individual path entries, associating each of them with a path entry finder that knows how to handle that particular kind of path.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The default set of path entry finders implement all the semantics for finding modules on the file system, handling special file types such as Python source code (<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.py</span></code>&nbsp;files), Python byte code (<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.pyc</span></code>&nbsp;files) and shared libraries (e.g.&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">.so</span></code>&nbsp;files). When supported by the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/zipimport.html#module-zipimport" title="zipimport: support for importing Python modules from ZIP archives." style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">zipimport</span></code></a>&nbsp;module in the standard library, the default path entry finders also handle loading all of these file types (other than shared libraries) from zipfiles.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Path entries need not be limited to file system locations. They can refer to URLs, database queries, or any other location that can be specified as a string.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The path based finder provides additional hooks and protocols so that you can extend and customize the types of searchable path entries. For example, if you wanted to support path entries as network URLs, you could write a hook that implements HTTP semantics to find modules on the web. This hook (a callable) would return a&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-finder" style="color: rgb(99, 99, 187); text-decoration-line: none;">path entry finder</a>&nbsp;supporting the protocol described below, which was then used to get a loader for the module from the web.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">A word of warning: this section and the previous both use the term&nbsp;<em>finder</em>, distinguishing between them by using the terms&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-meta-path-finder" style="color: rgb(99, 99, 187); text-decoration-line: none;">meta path finder</a>&nbsp;and&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-finder" style="color: rgb(99, 99, 187); text-decoration-line: none;">path entry finder</a>. These two types of finders are very similar, support similar protocols, and function in similar ways during the import process, but it’s important to keep in mind that they are subtly different. In particular, meta path finders operate at the beginning of the import process, as keyed off the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.meta_path" title="sys.meta_path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.meta_path</span></code></a>&nbsp;traversal.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">By contrast, path entry finders are in a sense an implementation detail of the path based finder, and in fact, if the path based finder were to be removed from&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.meta_path" title="sys.meta_path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.meta_path</span></code></a>, none of the path entry finder semantics would be invoked.</p><h4>Path entry finders</h4><p><div class="section" id="path-entry-finder-protocol" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"></div></p><div class="section" id="path-entry-finders" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><p id="index-17" style="hyphens: auto; text-align: justify; line-height: 22.4px;">The<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-based-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path based finder</span></a><span>&nbsp;</span>is responsible for finding and loading Python modules and packages whose location is specified with a string<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry</span></a>. Most path entries name locations in the file system, but they need not be limited to this.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">As a meta path finder, the<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-based-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path based finder</span></a><span>&nbsp;</span>implements the<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.MetaPathFinder.find_spec" title="importlib.abc.MetaPathFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a><span>&nbsp;</span>protocol previously described, however it exposes additional hooks that can be used to customize how modules are found and loaded from the<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-import-path" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">import path</span></a>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">Three variables are used by the<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-based-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path based finder</span></a>,<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>,<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_hooks" title="sys.path_hooks" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_hooks</span></code></a><span>&nbsp;</span>and<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_importer_cache</span></code></a>. The<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code><span>&nbsp;</span>attributes on package objects are also used. These provide additional ways that the import machinery can be customized.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a><span>&nbsp;</span>contains a list of strings providing search locations for modules and packages. It is initialized from the<span>&nbsp;</span><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">PYTHONPATH</span></code><span>&nbsp;</span>environment variable and various other installation- and implementation-specific defaults. Entries in<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a><span>&nbsp;</span>can name directories on the file system, zip files, and potentially other “locations” (see the<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/site.html#module-site" title="site: Module responsible for site-specific configuration." style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">site</span></code></a>module) that should be searched for modules, such as URLs, or database queries. Only strings and bytes should be present on<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>; all other data types are ignored. The encoding of bytes entries is determined by the individual<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry finders</span></a>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">The<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-based-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path based finder</span></a><span>&nbsp;</span>is a<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-meta-path-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">meta path finder</span></a>, so the import machinery begins the<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-import-path" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">import path</span></a><span>&nbsp;</span>search by calling the path based finder’s<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.machinery.PathFinder.find_spec" title="importlib.machinery.PathFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a><span>&nbsp;</span>method as described previously. When the<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">path</span></code><span>&nbsp;</span>argument to<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.machinery.PathFinder.find_spec" title="importlib.machinery.PathFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a><span>&nbsp;</span>is given, it will be a list of string paths to traverse - typically a package’s<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__path__</span></code><span>&nbsp;</span>attribute for an import within that package. If the<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">path</span></code><span>&nbsp;</span>argument is<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>, this indicates a top level import and<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>is used.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">The path based finder iterates over every entry in the search path, and for each of these, looks for an appropriate<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry finder</span></a><span>&nbsp;</span>(<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.PathEntryFinder" title="importlib.abc.PathEntryFinder" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-class docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">PathEntryFinder</span></code></a>) for the path entry. Because this can be an expensive operation (e.g. there may be<span>&nbsp;</span><cite>stat()</cite><span>&nbsp;</span>call overheads for this search), the path based finder maintains a cache mapping path entries to path entry finders. This cache is maintained in<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_importer_cache</span></code></a><span>&nbsp;</span>(despite the name, this cache actually stores finder objects rather than being limited to<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-importer" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">importer</span></a>objects). In this way, the expensive search for a particular<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry</span></a><span>&nbsp;</span>location’s<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry finder</span></a><span>&nbsp;</span>need only be done once. User code is free to remove cache entries from<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_importer_cache</span></code></a><span>&nbsp;</span>forcing the path based finder to perform the path entry search again<span>&nbsp;</span><a class="footnote-reference" href="https://docs.python.org/zh-cn/3/reference/import.html#fnpic" id="id3" style="color: rgb(99, 99, 187); text-decoration: none;">[3]</a>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">If the path entry is not present in the cache, the path based finder iterates over every callable in<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_hooks" title="sys.path_hooks" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_hooks</span></code></a>. Each of the<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-hook" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry hooks</span></a><span>&nbsp;</span>in this list is called with a single argument, the path entry to be searched. This callable may either return a<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry finder</span></a><span>&nbsp;</span>that can handle the path entry, or it may raise<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ImportError" title="ImportError" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">ImportError</span></code></a>. An<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ImportError" title="ImportError" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">ImportError</span></code></a><span>&nbsp;</span>is used by the path based finder to signal that the hook cannot find a<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry finder</span></a><span>&nbsp;</span>for that<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry</span></a>. The exception is ignored and<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-import-path" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">import path</span></a><span>&nbsp;</span>iteration continues. The hook should expect either a string or bytes object; the encoding of bytes objects is up to the hook (e.g. it may be a file system encoding, UTF-8, or something else), and if the hook cannot decode the argument, it should raise<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ImportError" title="ImportError" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">ImportError</span></code></a>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">If<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_hooks" title="sys.path_hooks" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_hooks</span></code></a><span>&nbsp;</span>iteration ends with no<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry finder</span></a><span>&nbsp;</span>being returned, then the path based finder’s<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.machinery.PathFinder.find_spec" title="importlib.machinery.PathFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a><span>&nbsp;</span>method will store<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code><span>&nbsp;</span>in<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_importer_cache</span></code></a>(to indicate that there is no finder for this path entry) and return<span>&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>, indicating that this<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-meta-path-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">meta path finder</span></a><span>&nbsp;</span>could not find the module.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">If a<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-finder" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry finder</span></a><span>&nbsp;</span><em>is</em><span>&nbsp;</span>returned by one of the<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-path-entry-hook" style="color: rgb(99, 99, 187); text-decoration: none;"><span class="xref std std-term">path entry hook</span></a><span>&nbsp;</span>callables on<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_hooks" title="sys.path_hooks" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_hooks</span></code></a>, then the following protocol is used to ask the finder for a module spec, which is then used when loading the module.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">The current working directory – denoted by an empty string – is handled slightly differently from other entries on<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>. First, if the current working directory is found to not exist, no value is stored in<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_importer_cache</span></code></a>. Second, the value for the current working directory is looked up fresh for each module lookup. Third, the path used for<span>&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path_importer_cache" title="sys.path_importer_cache" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path_importer_cache</span></code></a><span>&nbsp;</span>and returned by<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.machinery.PathFinder.find_spec" title="importlib.machinery.PathFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; font-weight: normal; border-radius: 3px;"><span class="pre" style="hyphens: none;">importlib.machinery.PathFinder.find_spec()</span></code></a><span>&nbsp;</span>will be the actual current working directory and not the empty string.</p></div><h4>Path entry finder protocol</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">In order to support imports of modules and initialized packages and also to contribute portions to namespace packages, path entry finders must implement the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.PathEntryFinder.find_spec" title="importlib.abc.PathEntryFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a>method.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.PathEntryFinder.find_spec" title="importlib.abc.PathEntryFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a>&nbsp;takes two argument, the fully qualified name of the module being imported, and the (optional) target module.&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code>&nbsp;returns a fully populated spec for the module. This spec will always have “loader” set (with one exception).</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">To indicate to the import machinery that the spec represents a namespace&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-portion" style="color: rgb(99, 99, 187); text-decoration-line: none;">portion</a>. the path entry finder sets “loader” on the spec to&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>&nbsp;and “submodule_search_locations” to a list containing the portion.</p><div class="versionchanged" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><span class="versionmodified" style="font-style: italic;">在 3.4 版更改:&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.PathEntryFinder.find_spec" title="importlib.abc.PathEntryFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a>&nbsp;replaced&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.PathEntryFinder.find_loader" title="importlib.abc.PathEntryFinder.find_loader" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_loader()</span></code></a>&nbsp;and&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.PathEntryFinder.find_module" title="importlib.abc.PathEntryFinder.find_module" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_module()</span></code></a>, both of which are now deprecated, but will be used if&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code>&nbsp;is not defined.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">Older path entry finders may implement one of these two deprecated methods instead of&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code>. The methods are still respected for the sake of backward compatibility. However, if&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code>&nbsp;is implemented on the path entry finder, the legacy methods are ignored.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;"><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.PathEntryFinder.find_loader" title="importlib.abc.PathEntryFinder.find_loader" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_loader()</span></code></a>&nbsp;takes one argument, the fully qualified name of the module being imported.&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_loader()</span></code>&nbsp;returns a 2-tuple where the first item is the loader and the second item is a namespace&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/glossary.html#term-portion" style="color: rgb(99, 99, 187); text-decoration-line: none;">portion</a>. When the first item (i.e. the loader) is&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>, this means that while the path entry finder does not have a loader for the named module, it knows that the path entry contributes to a namespace portion for the named module. This will almost always be the case where Python is asked to import a namespace package that has no physical presence on the file system. When a path entry finder returns&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>&nbsp;for the loader, the second item of the 2-tuple return value must be a sequence, although it can be empty.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">If&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_loader()</span></code>&nbsp;returns a non-<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>&nbsp;loader value, the portion is ignored and the loader is returned from the path based finder, terminating the search through the path entries.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">For backwards compatibility with other implementations of the import protocol, many path entry finders also support the same, traditional&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_module()</span></code>&nbsp;method that meta path finders support. However path entry finder&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_module()</span></code>&nbsp;methods are never called with a&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">path</span></code>&nbsp;argument (they are expected to record the appropriate path information from the initial call to the path hook).</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px;">The&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_module()</span></code>&nbsp;method on path entry finders is deprecated, as it does not allow the path entry finder to contribute portions to namespace packages. If both&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_loader()</span></code>&nbsp;and&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_module()</span></code>&nbsp;exist on a path entry finder, the import system will always call&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_loader()</span></code>&nbsp;in preference to&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_module()</span></code>.</p></div><h3>Replacing the standard import system</h3><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">The most reliable mechanism for replacing the entire import system is to delete the default contents of&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.meta_path" title="sys.meta_path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.meta_path</span></code></a>, replacing them entirely with a custom meta path hook.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">If it is acceptable to only alter the behaviour of import statements without affecting other APIs that access the import system, then replacing the builtin&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/functions.html#__import__" title="__import__" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-func docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__import__()</span></code></a>function may be sufficient. This technique may also be employed at the module level to only alter the behaviour of import statements within that module.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">To selectively prevent import of some modules from a hook early on the meta path (rather than disabling the standard import system entirely), it is sufficient to raise&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ModuleNotFoundError" title="ModuleNotFoundError" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-exc docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">ModuleNotFoundError</span></code></a>&nbsp;directly from&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/importlib.html#importlib.abc.MetaPathFinder.find_spec" title="importlib.abc.MetaPathFinder.find_spec" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-meth docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">find_spec()</span></code></a>&nbsp;instead of returning&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>. The latter indicates that the meta path search should continue, while raising an exception terminates it immediately.</p><h3>Special considerations for __main__</h3><p><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">The&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/__main__.html#module-__main__" title="__main__: The environment where the top-level script is run." style="color: rgb(99, 99, 187); text-decoration-line: none; font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__</span></code></a><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">&nbsp;module is a special case relative to Python’s import system. As noted&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/reference/toplevel_components.html#programs" style="color: rgb(99, 99, 187); text-decoration-line: none; font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);"><span class="std std-ref">elsewhere</span></a><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">, the&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px; color: rgb(34, 34, 34); text-align: justify;"><span class="pre" style="hyphens: none;">__main__</span></code><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">&nbsp;module is directly initialized at interpreter startup, much like&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#module-sys" title="sys: Access system-specific parameters and functions." style="color: rgb(99, 99, 187); text-decoration-line: none; font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys</span></code></a><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">&nbsp;and&nbsp;</span><a class="reference internal" href="https://docs.python.org/zh-cn/3/library/builtins.html#module-builtins" title="builtins: The module that provides the built-in namespace." style="color: rgb(99, 99, 187); text-decoration-line: none; font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">builtins</span></code></a><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">. However, unlike those two, it doesn’t strictly qualify as a built-in module. This is because the manner in which&nbsp;</span><code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px; color: rgb(34, 34, 34); text-align: justify;"><span class="pre" style="hyphens: none;">__main__</span></code><span style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; text-align: justify; background-color: rgb(255, 255, 255);">&nbsp;is initialized depends on the flags and other options with which the interpreter is invoked.</span><br></p><h4>__main__.__spec__</h4><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Depending on how&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/__main__.html#module-__main__" title="__main__: The environment where the top-level script is run." style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__</span></code></a>&nbsp;is initialized,&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__.__spec__</span></code>&nbsp;gets set appropriately or to&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">When Python is started with the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/using/cmdline.html#cmdoption-m" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-option docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">-m</span></code></a>&nbsp;option,&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__</span></code>&nbsp;is set to the module spec of the corresponding module or package.&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__spec__</span></code>&nbsp;is also populated when the&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__</span></code>module is loaded as part of executing a directory, zipfile or other&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/sys.html#sys.path" title="sys.path" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-data docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">sys.path</span></code></a>&nbsp;entry.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">In&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/using/cmdline.html#using-on-interface-options" style="color: rgb(99, 99, 187); text-decoration-line: none;">the remaining cases</a>&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__.__spec__</span></code>&nbsp;is set to&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>, as the code used to populate the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/__main__.html#module-__main__" title="__main__: The environment where the top-level script is run." style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__</span></code></a>&nbsp;does not correspond directly with an importable module:</p><ul class="simple" style="color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">interactive prompt</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;"><a class="reference internal" href="https://docs.python.org/zh-cn/3/using/cmdline.html#cmdoption-c" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-option docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">-c</span></code></a>&nbsp;option</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">running from stdin</li><li style="hyphens: auto; text-align: justify; line-height: 20.8px;">running directly from a source or bytecode file</li></ul><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Note that&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__.__spec__</span></code>&nbsp;is always&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">None</span></code>&nbsp;in the last case,&nbsp;<em>even if</em>&nbsp;the file could technically be imported directly as a module instead. Use the&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/using/cmdline.html#cmdoption-m" style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref std std-option docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">-m</span></code></a>&nbsp;switch if valid module metadata is desired in&nbsp;<a class="reference internal" href="https://docs.python.org/zh-cn/3/library/__main__.html#module-__main__" title="__main__: The environment where the top-level script is run." style="color: rgb(99, 99, 187); text-decoration-line: none;"><code class="xref py py-mod docutils literal notranslate" style="background-color: transparent; padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__</span></code></a>.</p><p style="hyphens: auto; text-align: justify; line-height: 22.4px; color: rgb(34, 34, 34); font-family: &quot;Lucida Grande&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);">Note also that even when&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__</span></code>&nbsp;corresponds with an importable module and&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__.__spec__</span></code>&nbsp;is set accordingly, they’re still considered&nbsp;<em>distinct</em>&nbsp;modules. This is due to the fact that blocks guarded by&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">if</span>&nbsp;<span class="pre" style="hyphens: none;">__name__</span>&nbsp;<span class="pre" style="hyphens: none;">==</span>&nbsp;<span class="pre" style="hyphens: none;">"__main__":</span></code>&nbsp;checks only execute when the module is used to populate the&nbsp;<code class="docutils literal notranslate" style="background-color: rgb(236, 240, 243); padding: 0px 1px; font-size: 15.44px; font-family: monospace, sans-serif; border-radius: 3px;"><span class="pre" style="hyphens: none;">__main__</span></code>&nbsp;namespace, and not during normal import.</p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p>
</article>
{% endblock point1 %}
