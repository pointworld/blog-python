{% extends 'c-word.html' %}

{% block title %} Address Resolution Protocol - computer | hardware | network | protocol {% endblock title %}

{% block point1 %}
<article contenteditable="true">
  <p>Category: computer | hardware | network | protocol | Address Resolution Protocol</p>
  <h1 id="blogTitle0">Address Resolution Protocol</h1><h2>概述</h2><h3>定义</h3><div><div class="lemma-summary" label-module="lemmaSummary" style="clear: both; font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);"><div class="para" label-module="para" style="overflow-wrap: break-word; margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1;">地址解析协议，即ARP（Address Resolution Protocol），是根据<a target="_blank" href="https://baike.baidu.com/item/IP%E5%9C%B0%E5%9D%80" style="color: rgb(19, 110, 194); text-decoration-line: none;">IP地址</a>获取<a target="_blank" href="https://baike.baidu.com/item/%E7%89%A9%E7%90%86%E5%9C%B0%E5%9D%80/2129" data-lemmaid="2129" style="color: rgb(19, 110, 194); text-decoration-line: none;">物理地址</a>的一个<a target="_blank" href="https://baike.baidu.com/item/TCP%2FIP%E5%8D%8F%E8%AE%AE" style="color: rgb(19, 110, 194); text-decoration-line: none;">TCP/IP协议</a>。</div><div class="para" label-module="para" style="overflow-wrap: break-word; margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1;"><a target="_blank" href="https://baike.baidu.com/item/%E4%B8%BB%E6%9C%BA/455151" data-lemmaid="455151" style="color: rgb(19, 110, 194); text-decoration-line: none;">主机</a>发送信息时将包含目标IP地址的ARP请求广播到网络上的所有主机，并接收返回消息，以此确定目标的物理地址；收到返回消息后将该IP地址和物理地址存入本机ARP缓存中并保留一定时间，下次请求时直接查询ARP缓存以节约资源。</div><div class="para" label-module="para" style="overflow-wrap: break-word; margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1;">地址解析协议是建立在网络中各个主机互相信任的基础上的，网络上的主机可以自主发送ARP应答消息，其他主机收到应答报文时不会检测该报文的真实性就会将其记入本机ARP缓存；由此攻击者就可以向某一主机发送伪ARP应答报文，使其发送的信息无法到达预期的主机或到达错误的主机，这就构成了一个<a target="_blank" href="https://baike.baidu.com/item/ARP%E6%AC%BA%E9%AA%97" style="color: rgb(19, 110, 194); text-decoration-line: none;">ARP欺骗</a>。</div><div class="para" label-module="para" style="overflow-wrap: break-word; margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1;"><a target="_blank" href="https://baike.baidu.com/item/ARP%E5%91%BD%E4%BB%A4" style="color: rgb(19, 110, 194); text-decoration-line: none;">ARP命令</a>可用于查询本机ARP缓存中IP地址和<a target="_blank" href="https://baike.baidu.com/item/MAC%E5%9C%B0%E5%9D%80" style="color: rgb(19, 110, 194); text-decoration-line: none;">MAC地址</a>的对应关系、添加或删除静态对应关系等。相关协议有<a target="_blank" href="https://baike.baidu.com/item/RARP" style="color: rgb(19, 110, 194); text-decoration-line: none;">RARP</a>、<a target="_blank" href="https://baike.baidu.com/item/%E4%BB%A3%E7%90%86ARP" style="color: rgb(19, 110, 194); text-decoration-line: none;">代理ARP</a>。<a target="_blank" href="https://baike.baidu.com/item/NDP" style="color: rgb(19, 110, 194); text-decoration-line: none;">NDP</a>用于在<a target="_blank" href="https://baike.baidu.com/item/IPv6" style="color: rgb(19, 110, 194); text-decoration-line: none;">IPv6</a>中代替地址解析协议。</div></div></div><div><br></div><h3>组成</h3><div><br></div><h3>用途</h3><div><br></div><h3>为什么需要使用 ARP 协议</h3><div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">地址解析协议由互联网工程任务组（<a target="_blank" href="https://baike.baidu.com/item/IETF" style="color: rgb(19, 110, 194); text-decoration-line: none;">IETF</a>）在1982年11月发布的RFC 826中描述制定。地址解析协议是<a target="_blank" href="https://baike.baidu.com/item/IPv4" style="color: rgb(19, 110, 194); text-decoration-line: none;">IPv4</a>中必不可少的协议，而IPv4是使用较为广泛的互联网协议版本（IPv6仍处在部署的初期）。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);"><a target="_blank" href="https://baike.baidu.com/item/OSI%E6%A8%A1%E5%9E%8B" style="color: rgb(19, 110, 194); text-decoration-line: none;">OSI模型</a>把网络工作分为七层，IP地址在OSI模型的第三层，MAC地址在第二层，彼此不直接打交道。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">在通过<a target="_blank" href="https://baike.baidu.com/item/%E4%BB%A5%E5%A4%AA%E7%BD%91" style="color: rgb(19, 110, 194); text-decoration-line: none;">以太网</a>发送IP数据包时，需要先封装第三层（32位IP地址）、第二层（48位MAC地址）的报头，但由于发送时只知道目标IP地址，不知道其MAC地址，又不能跨第二、三层，所以需要使用地址解析协议。使用地址解析协议，可根据网络层IP数据包包头中的IP地址信息解析出目标硬件地址（MAC地址）信息，以保证通信的顺利进行。</div></div><h3>原理</h3><div><div class="para-title level-3" label-module="para-title" style="clear: both; zoom: 1; margin: 20px 0px 12px; line-height: 20px;"><h4 style="margin: 0px; padding: 0px;">&nbsp;工作过程</h4></div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">主机A的IP地址为192.168.1.1，MAC地址为0A-11-22-33-44-01；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">主机B的IP地址为192.168.1.2，MAC地址为0A-11-22-33-44-02；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">当主机A要与主机B通信时，地址解析协议可以将主机B的IP地址（192.168.1.2）解析成主机B的MAC地址，以下为工作流程：</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">第1步：根据主机A上的<a target="_blank" href="https://baike.baidu.com/item/%E8%B7%AF%E7%94%B1%E8%A1%A8" style="color: rgb(19, 110, 194); text-decoration-line: none;">路由表</a>内容，IP确定用于访问主机B的转发IP地址是192.168.1.2。然后A主机在自己的本地ARP缓存中检查主机B的匹配MAC地址。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">第2步：如果主机A在ARP缓存中没有找到映射，它将询问192.168.1.2的硬件地址，从而将ARP请求帧广播到本地网络上的所有主机。源主机A的IP地址和MAC地址都包括在ARP请求中。本地网络上的每台主机都接收到ARP请求并且检查是否与自己的IP地址匹配。如果主机发现请求的IP地址与自己的IP地址不匹配，它将丢弃ARP请求。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">第3步：主机B确定ARP请求中的IP地址与自己的IP地址匹配，则将主机A的IP地址和MAC地址<a target="_blank" href="https://baike.baidu.com/item/%E6%98%A0%E5%B0%84" style="color: rgb(19, 110, 194); text-decoration-line: none;">映射</a>添加到本地ARP缓存中。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">第4步：主机B将包含其MAC地址的ARP回复消息直接发送回主机A。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">第5步：当主机A收到从主机B发来的ARP回复消息时，会用主机B的IP和MAC地址映射更新ARP缓存。本机缓存是有<a target="_blank" href="https://baike.baidu.com/item/%E7%94%9F%E5%AD%98%E6%9C%9F" style="color: rgb(19, 110, 194); text-decoration-line: none;">生存期</a>的，生存期结束后，将再次重复上面的过程。主机B的MAC地址一旦确定，主机A就能向主机B发送IP通信了。</div></div><h4>工作要素：ARP 缓存</h4><div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">ARP 缓存是一个用来储存IP地址和MAC地址的<a target="_blank" href="https://baike.baidu.com/item/%E7%BC%93%E5%86%B2%E5%8C%BA" style="color: rgb(19, 110, 194); text-decoration-line: none;">缓冲区</a>，其本质就是一个IP地址--&gt;MAC地址的对应表，表中每一个条目分别记录了网络上其他主机的IP地址和对应的MAC地址。每一个以太网或<a target="_blank" href="https://baike.baidu.com/item/%E4%BB%A4%E7%89%8C%E7%8E%AF" style="color: rgb(19, 110, 194); text-decoration-line: none;">令牌环</a><a target="_blank" href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E9%80%82%E9%85%8D%E5%99%A8" style="color: rgb(19, 110, 194); text-decoration-line: none;">网络适配器</a>都有自己单独的表。当地址解析协议被询问一个已知IP地址<a target="_blank" href="https://baike.baidu.com/item/%E8%8A%82%E7%82%B9" style="color: rgb(19, 110, 194); text-decoration-line: none;">节点</a>的MAC地址时，先在ARP缓存中查看，若存在，就直接返回与之对应的MAC地址，若不存在，才发送ARP请求向<a target="_blank" href="https://baike.baidu.com/item/%E5%B1%80%E5%9F%9F%E7%BD%91" style="color: rgb(19, 110, 194); text-decoration-line: none;">局域网</a>查询。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">为使广播量最小，ARP维护IP地址到MAC地址映射的缓存以便将来使用。ARP缓存可以包含动态和静态项目。动态项目随时间推移自动添加和删除。每个动态ARP缓存项的潜在<a target="_blank" href="https://baike.baidu.com/item/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F" style="color: rgb(19, 110, 194); text-decoration-line: none;">生命周期</a>是10分钟。新加到缓存中的项目带有<a target="_blank" href="https://baike.baidu.com/item/%E6%97%B6%E9%97%B4%E6%88%B3" style="color: rgb(19, 110, 194); text-decoration-line: none;">时间戳</a>，如果某个项目添加后2分钟内没有再使用，则此项目过期并从ARP缓存中删除；如果某个项目已在使用，则又收到2分钟的生命周期；如果某个项目始终在使用，则会另外收到2分钟的生命周期，一直到10分钟的最长生命周期。静态项目一直保留在缓存中，直到重新启动计算机为止。</div></div><div><br></div><h4>工作媒介：报文</h4><div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">地址解析协议是通过<a target="_blank" href="https://baike.baidu.com/item/%E6%8A%A5%E6%96%87" style="color: rgb(19, 110, 194); text-decoration-line: none;">报文</a>工作的。报文包括如下字段：</div><table log-set-param="table_view" width="99%" data-sort="sortDisabled" style="border-spacing: 0px; color: rgb(51, 51, 51); font-family: arial, 宋体, sans-serif; font-size: 12px; background-color: rgb(255, 255, 255);"><caption style="font-weight: 700; padding: 8px 0px 9px; font-size: 14px;">ARP报文格式<br>　　</caption><tbody><tr><td align="left" valign="top" colspan="2" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">硬件类型<br>　　</td><td align="middle" valign="center" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">协议类型</td></tr><tr><td valign="top" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">硬件地址长度<br>　　</td><td valign="top" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">协议长度</td><td width="211" valign="top" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">操作类型</td></tr><tr><td valign="top" colspan="3" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">发送方硬件地址（0-3字节）</td></tr><tr><td valign="top" colspan="2" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">发送方硬件地址（4-5字节）</td><td valign="top" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">发送方IP地址（0-1字节）<br>　　</td></tr><tr><td valign="top" colspan="2" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">发送方IP地址（2-3字节）</td><td valign="top" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">目标硬件地址（0-1字节）</td></tr><tr><td valign="top" colspan="3" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">目标硬件地址（2-5字节）</td></tr><tr><td valign="top" colspan="3" style="margin: 0px; padding: 2px 10px; line-height: 22px; height: 22px; border-width: 1px; border-style: solid; border-color: rgb(230, 230, 230);">目标IP地址（0-3字节）</td></tr></tbody></table><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">硬件类型：指明了发送方想知道的硬件<a target="_blank" href="https://baike.baidu.com/item/%E6%8E%A5%E5%8F%A3" style="color: rgb(19, 110, 194); text-decoration-line: none;">接口</a>类型，以太网的值为1；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">协议类型：指明了发送方提供的高层<a target="_blank" href="https://baike.baidu.com/item/%E5%8D%8F%E8%AE%AE/13020269" data-lemmaid="13020269" style="color: rgb(19, 110, 194); text-decoration-line: none;">协议</a>类型，IP为0800（16进制）；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">硬件地址长度和协议长度：指明了硬件地址和高层协议地址的长度，这样ARP报文就可以在任意硬件和任意协议的网络中使用；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">操作类型：用来表示这个报文的类型，ARP请求为1，ARP响应为2，RARP请求为3，RARP响应为4；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">发送方硬件地址（0-3字节）：源主机硬件地址的前3个字节；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">发送方硬件地址（4-5字节）：源主机硬件地址的后3个字节；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">发送方IP地址（0-1字节）：源主机硬件地址的前2个字节；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">发送方IP地址（2-3字节）：源主机硬件地址的后2个字节；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">目标硬件地址（0-1字节）：目的主机硬件地址的前2个字节；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">目标硬件地址（2-5字节）：目的主机硬件地址的后4个字节；</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">目标IP地址（0-3字节）：目的主机的IP地址。</div></div><div><br></div><div><br></div><h3>特点</h3><div><br></div><h3>应用</h3><h4>ARP 命令</h4><div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">ARP缓存中包含一个或多个表，它们用于存储IP地址及其经过解析的MAC地址。ARP命令用于查询本机ARP缓存中IP地址--&gt;MAC地址的对应关系、添加或删除静态对应关系等。如果在没有参数的情况下使用，<a target="_blank" href="https://baike.baidu.com/item/ARP%E5%91%BD%E4%BB%A4" style="color: rgb(19, 110, 194); text-decoration-line: none;">ARP命令</a>将显示帮助信息。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);"><span style="font-weight: 700;">常见用法</span></div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">arp -a或arp –g</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">用于查看缓存中的所有项目。-a和-g参数的结果是一样的，多年来-g一直是UNIX平台上用来显示ARP缓存中所有项目的选项，而Windows用的是arp -a（-a可被视为all，即全部的意思），但它也可以接受比较传统的-g选项。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">arp -a Ip</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">如果有多个网卡，那么使用arp -a加上接口的IP地址，就可以只显示与该接口相关的ARP缓存项目。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">arp -s Ip 物理地址</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">可以向ARP缓存中人工输入一个静态项目。该项目在计算机引导过程中将保持有效状态，或者在出现错误时，人工配置的物理地址将自动更新该项目。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">arp -d Ip</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">使用该命令能够人工删除一个静态项目。</div></div><div><br></div><div><br></div><div><br></div><div><br></div><h3>ARP 欺骗</h3><div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">地址解析协议是建立在网络中各个主机互相信任的基础上的，它的诞生使得网络能够更加高效的运行，但其本身也存在缺陷：</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">ARP 地址转换表是依赖于计算机中高速缓冲存储器动态更新的，而高速缓冲存储器的更新是受到更新周期的限制的，只保存最近使用的地址的<a target="_blank" href="https://baike.baidu.com/item/%E6%98%A0%E5%B0%84" style="color: rgb(19, 110, 194); text-decoration-line: none;">映射</a>关系表项，这使得攻击者有了可乘之机，可以在高速缓冲存储器更新表项之前修改地址转换表，实现攻击。ARP请求为广播形式发送的，网络上的主机可以自主发送ARP应答消息，并且当其他主机收到应答报文时不会检测该报文的真实性就将其记录在本地的MAC地址转换表，这样攻击者就可以向目标主机发送伪ARP应答报文，从而篡改本地的MAC地址表。ARP欺骗可以导致目标计算机与<a target="_blank" href="https://baike.baidu.com/item/%E7%BD%91%E5%85%B3" style="color: rgb(19, 110, 194); text-decoration-line: none;">网关</a>通信失败，更会导致通信<a target="_blank" href="https://baike.baidu.com/item/%E9%87%8D%E5%AE%9A%E5%90%91" style="color: rgb(19, 110, 194); text-decoration-line: none;">重定向</a>，所有的数据都会通过攻击者的机器，因此存在极大的安全隐患。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);"><span style="font-weight: 700;">防御措施</span></div><ul class="custom_dot  para-list list-paddingleft-1" style="margin: 0px 0px 15px 2em; padding: 0px; list-style: none; color: rgb(51, 51, 51); font-family: arial, 宋体, sans-serif; font-size: 12px; background-color: rgb(255, 255, 255);"><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">不要把网络安全信任关系建立在IP基础上或MAC基础上（RARP同样存在欺骗的问题），理想的关系应该建立在IP+MAC基础上。</div></li><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">设置静态的MAC--&gt;IP对应表，不要让主机刷新设定好的转换表。</div></li><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">除非很有必要，否则停止使用ARP，将ARP做为永久条目保存在对应表中。</div></li><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">使用ARP服务器。通过该服务器查找自己的ARP转换表来响应其他机器的ARP广播。确保这台ARP服务器不被黑。</div></li><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">使用“<a target="_blank" href="https://baike.baidu.com/item/proxy" style="color: rgb(19, 110, 194); text-decoration-line: none;">proxy</a>”代理IP的传输。</div></li><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">使用硬件屏蔽主机。设置好<a target="_blank" href="https://baike.baidu.com/item/%E8%B7%AF%E7%94%B1" style="color: rgb(19, 110, 194); text-decoration-line: none;">路由</a>，确保IP地址能到达合法的路径（静态配置路由ARP条目），注意，使用交换集线器和网桥无法阻止ARP欺骗。</div></li><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">管理员定期用响应的IP包中获得一个RARP请求，然后检查ARP响应的真实性。</div></li><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">管理员定期<a target="_blank" href="https://baike.baidu.com/item/%E8%BD%AE%E8%AF%A2" style="color: rgb(19, 110, 194); text-decoration-line: none;">轮询</a>，检查主机上的ARP缓存。</div></li><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">使用<a target="_blank" href="https://baike.baidu.com/item/%E9%98%B2%E7%81%AB%E5%A2%99/52767" data-lemmaid="52767" style="color: rgb(19, 110, 194); text-decoration-line: none;">防火墙</a>连续监控网络。注意有使用<a target="_blank" href="https://baike.baidu.com/item/SNMP" style="color: rgb(19, 110, 194); text-decoration-line: none;">SNMP</a>的情况下，ARP的欺骗有可能导致陷阱包丢失。</div></li><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">若感染ARP病毒，可以通过清空ARP缓存、指定ARP对应关系、添加路由信息、使用防病毒软件等方式解决。</div></li></ul></div><h3>对比</h3><div><div class="para-title level-3" label-module="para-title" style="clear: both; zoom: 1; margin: 20px 0px 12px; line-height: 20px;"><h4 style="margin: 0px; padding: 0px;">&nbsp;RARP</h4></div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">地址解析协议是根据IP地址获取物理地址的协议，而反向地址转换协议（<a target="_blank" href="https://baike.baidu.com/item/RARP" style="color: rgb(19, 110, 194); text-decoration-line: none;">RARP</a>）是局域网的物理机器从网关服务器的ARP表或者缓存上根据MAC地址请求IP地址的协议，其功能与地址解析协议相反。与ARP相比，RARP的工作流程也相反。首先是查询主机向网路送出一个RARP Request 广播封包，向别的主机查询自己的IP地址。这时候网络上的 RARP 服务器就会将发送端的IP地址用 RARP Reply 封包回应给查询者，这样查询主机就获得自己的IP地址了。</div></div><div><h4 style="margin: 0px; padding: 0px;">&nbsp;代理 ARP</h4></div><div><br></div><div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">地址解析协议工作在一个网段中，而<a target="_blank" href="https://baike.baidu.com/item/%E4%BB%A3%E7%90%86ARP" style="color: rgb(19, 110, 194); text-decoration-line: none;">代理ARP</a>（Proxy ARP，也被称作混杂ARP（Promiscuous ARP））工作在不同的网段间，其一般被像<a target="_blank" href="https://baike.baidu.com/item/%E8%B7%AF%E7%94%B1%E5%99%A8" style="color: rgb(19, 110, 194); text-decoration-line: none;">路由器</a>这样的设备使用，用来代替处于另一个<a target="_blank" href="https://baike.baidu.com/item/%E7%BD%91%E6%AE%B5" style="color: rgb(19, 110, 194); text-decoration-line: none;">网段</a>的主机回答本网段主机的ARP请求。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">例如，主机PC1（192.168.20.66/24）需要向主机PC2（192.168.20.20/24）发送报文，因为主机PC1不知道<a target="_blank" href="https://baike.baidu.com/item/%E5%AD%90%E7%BD%91" style="color: rgb(19, 110, 194); text-decoration-line: none;">子网</a>的存在且和目标主机PC2在同一主网络网段，所以主机PC1将发送ARP协议请求广播报文请求192.168.20.20的MAC地址。这时，路由器将识别出报文的目标地址属于另一个子网（注意，路由器的接口IP地址配置的是28位的<a target="_blank" href="https://baike.baidu.com/item/%E6%8E%A9%E7%A0%81" style="color: rgb(19, 110, 194); text-decoration-line: none;">掩码</a>），因此向请求主机回复自己的硬件地址（0004.dd9e.cca0）。之后，PC1将发往PC2的数据包都发往MAC地址0004.dd9e.cca0（路由器的接口E0/0），由路由器将数据包转发到目标主机PC2。（接下来路由器将为PC2做同样的代理发送数据包的工作）。代理ARP协议使得子网化<a target="_blank" href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91" style="color: rgb(19, 110, 194); text-decoration-line: none;">网络拓扑</a>对于主机来说时透明的（或者可以说是路由器以一个不真实的PC2的MAC地址欺骗了源主机PC1）。</div></div><h4>NDP</h4><div><br></div><div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);">地址解析协议是IPv4中必不可少的协议，但在IPv6中将不再存在地址解析协议。在IPv6中，地址解析协议的功能将由<a target="_blank" href="https://baike.baidu.com/item/NDP" style="color: rgb(19, 110, 194); text-decoration-line: none;">NDP</a>（邻居发现协议，Neighbor Discovery Protocol）实现，它使用一系列IPv6控制信息报文（<a target="_blank" href="https://baike.baidu.com/item/ICMPv6" style="color: rgb(19, 110, 194); text-decoration-line: none;">ICMPv6</a>）来实现相邻节点（同一<a target="_blank" href="https://baike.baidu.com/item/%E9%93%BE%E8%B7%AF" style="color: rgb(19, 110, 194); text-decoration-line: none;">链路</a>上的节点）的交互管理，并在一个子网中保持网络层地址和<a target="_blank" href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82" style="color: rgb(19, 110, 194); text-decoration-line: none;">数据链路层</a>地址之间的映射。邻居发现协议中定义了5种类型的信息：路由器宣告、路由器请求、路由重定向、邻居请求和邻居宣告。与ARP相比，NDP可以实现路由器发现、前缀发现、参数发现、地址自动配置、地址解析（代替ARP和RARP）、下一跳确定、邻居不可达检测、重复地址检测、重定向等更多功能。</div><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; color: rgb(51, 51, 51); margin-bottom: 15px; text-indent: 2em; line-height: 24px; zoom: 1; font-family: arial, 宋体, sans-serif; background-color: rgb(255, 255, 255);"><span style="font-weight: 700;">NDP与ARP的区别</span></div><ul class="custom_dot para-list list-paddingleft-1" style="margin: 0px 0px 15px 2em; padding: 0px; list-style: none; color: rgb(51, 51, 51); font-family: arial, 宋体, sans-serif; font-size: 12px; background-color: rgb(255, 255, 255);"><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">IPv4中地址解析协议是独立的协议，负责IP地址到MAC地址的转换，对不同的数据链路层协议要定义不同的地址解析协议。IPv6中NDP包含了ARP的功能，且运行于因特网控制信息协议ICMPv6上，更具有一般性，包括更多的内容，而且适用于各种数据链路层协议；</div></li><li class="list-dot list-dot-paddingleft" style="margin: 0px; padding: 0px; list-style: none;"><div class="para" label-module="para" style="font-size: 14px; overflow-wrap: break-word; margin-bottom: 0px; line-height: 24px; zoom: 1; margin-left: 20px;">地址解析协议以及ICMPv4路由器发现和ICMPv4重定向报文基于广播，而NDP的邻居发现报文基于高效的<a target="_blank" href="https://baike.baidu.com/item/%E7%BB%84%E6%92%AD" style="color: rgb(19, 110, 194); text-decoration-line: none;">组播</a>和<a target="_blank" href="https://baike.baidu.com/item/%E5%8D%95%E6%92%AD" style="color: rgb(19, 110, 194); text-decoration-line: none;">单播</a>。</div></li></ul></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div>
</article>
{% endblock point1 %}
