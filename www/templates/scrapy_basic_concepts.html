{% extends 'c-word.html' %}

{% block title %} basic concepts - computer | software | language | python | framework | crawler | scrapy | basic concepts {% endblock title %}

{% block point1 %}
<article contenteditable="true">
  <p>Category: computer | software | language | python | framework | crawler | scrapy | basic concepts</p>
  <h1 id="blogTitle0">basic concepts</h1><div><h2 id="blogTitle1">命令行工具</h2><h2 id="blogTitle2">Spiders</h2></div><h2 id="blogTitle49">Selectors</h2><h2 id="blogTitle50">Scrapy shell</h2><h2 id="blogTitle51">Items</h2><h2 id="blogTitle52">Item Loaders</h2><h2 id="blogTitle53">Item Pipeline</h2><div><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">After an item has been scraped by a spider, it is sent to the Item Pipeline which processes it through several components that are executed sequentially.</p><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">Each item pipeline component (sometimes referred as just “Item Pipeline”) is a Python class that implements a simple method. They receive an item and perform an action over it, also deciding if the item should continue through the pipeline or be dropped and no longer processed.</p><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px; font-size: 16px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; background-color: rgb(252, 252, 252);">Typical uses of item pipelines are:</p><ul class="simple" style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style-position: initial; list-style-image: initial; line-height: 24px; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);"><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">cleansing HTML data</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">validating scraped data (checking that the items contain certain fields)</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">checking for duplicates (and dropping them)</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;">storing the scraped item in a database</li></ul><div class="section" id="writing-your-own-item-pipeline" style="box-sizing: border-box; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);"><h3 style="box-sizing: border-box; margin-top: 0px; font-family: &quot;Roboto Slab&quot;, ff-tisa-web-pro, Georgia, Arial, sans-serif; font-size: 24px;" id="blogTitle54">Writing your own item pipeline</h3><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px;">Each item pipeline component is a Python class that must implement the following method:</p><h4 style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style: none none;" id="blogTitle55"><code class="descname" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 14.4px; white-space: nowrap; max-width: 100%; background: transparent; border: none; padding: 0px; color: rgb(0, 0, 0); overflow-x: auto;">process_item</code><span class="sig-paren" style="box-sizing: border-box;">(</span><em style="box-sizing: border-box;">self</em>,&nbsp;<em style="box-sizing: border-box;">item</em>,&nbsp;<em style="box-sizing: border-box;">spider</em><span class="sig-paren" style="box-sizing: border-box;">)</span></h4><dl class="method" style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style: none none;"><dt id="process_item" style="box-sizing: border-box; font-weight: bold; margin: 0px 0px 6px; display: table; font-size: 14.4px; line-height: normal; background: rgb(231, 242, 250); color: rgb(41, 128, 185); border-top: 3px solid rgb(106, 176, 222); padding: 6px; position: relative;"><a class="headerlink" href="https://docs.scrapy.org/en/latest/topics/item-pipeline.html#process_item" title="Permalink to this definition" style="box-sizing: border-box; color: rgb(64, 64, 64); text-decoration-line: none; cursor: pointer; display: inline-block; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: normal; font-stretch: normal; line-height: 1; font-family: inherit; font-size: 14.4px; text-rendering: auto; -webkit-font-smoothing: antialiased; visibility: hidden;"></a></dt><dd style="box-sizing: border-box; margin: 0px 0px 12px 24px; line-height: 24px;"><p style="box-sizing: border-box; line-height: 24px; margin-top: 0px; margin-right: 0px; margin-left: 0px; margin-bottom: 12px !important;">This method is called for every item pipeline component.&nbsp;<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/item-pipeline.html#process_item" title="process_item" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-meth docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">process_item()</span></code></a>&nbsp;must either: return a dict with data, return an&nbsp;<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/items.html#scrapy.item.Item" title="scrapy.item.Item" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-class docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">Item</span></code></a>&nbsp;(or any descendant class) object, return a&nbsp;<a class="reference external" href="https://twistedmatrix.com/documents/current/core/howto/defer.html" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Twisted Deferred</a>&nbsp;or raise<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/exceptions.html#scrapy.exceptions.DropItem" title="scrapy.exceptions.DropItem" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-exc docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">DropItem</span></code></a>&nbsp;exception. Dropped items are no longer processed by further pipeline components.</p><table class="docutils field-list" frame="void" rules="none" style="box-sizing: border-box; border-spacing: 0px; margin-bottom: 24px; empty-cells: show; border: none;"><colgroup style="box-sizing: border-box;"><col class="field-name" style="box-sizing: border-box; padding-right: 10px; white-space: nowrap;"><col class="field-body" style="box-sizing: border-box;"></colgroup><tbody valign="top" style="box-sizing: border-box;"><tr class="field-odd field" style="box-sizing: border-box;"><th class="field-name" style="box-sizing: border-box; font-size: 14.4px; margin: 0px; overflow: visible; padding: 8px 10px 8px 16px; border-color: rgb(225, 228, 229); white-space: nowrap; border-left-width: 0px;">Parameters:</th><td class="field-body" style="box-sizing: border-box; vertical-align: middle; font-size: 14.4px; margin: 0px; overflow: visible; padding: 8px 16px; background-color: transparent; border-bottom-width: 0px;"><ul class="first last simple" style="box-sizing: border-box; margin: 0px; padding: 0px; list-style-position: initial; list-style-image: initial; line-height: 24px;"><li style="box-sizing: border-box; list-style: disc; margin-left: 24px;"><strong style="box-sizing: border-box;">item</strong>&nbsp;(<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/items.html#scrapy.item.Item" title="scrapy.item.Item" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer; margin-bottom: 0px;"><code class="xref py py-class docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 10.8px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold; margin-bottom: 0px;"><span class="pre" style="box-sizing: border-box; margin-bottom: 0px;">Item</span></code></a>&nbsp;object or a dict) – the item scraped</li><li style="box-sizing: border-box; list-style: disc; margin-left: 24px; margin-bottom: 0px;"><strong style="box-sizing: border-box;">spider</strong>&nbsp;(<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/spiders.html#scrapy.spiders.Spider" title="scrapy.spiders.Spider" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer; margin-bottom: 0px;"><code class="xref py py-class docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 10.8px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold; margin-bottom: 0px;"><span class="pre" style="box-sizing: border-box; margin-bottom: 0px;">Spider</span></code></a>&nbsp;object) – the spider which scraped the item</li></ul></td></tr></tbody></table></dd></dl><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px;">Additionally, they may also implement the following methods:</p><h4 style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style: none none;" id="blogTitle56"><code class="descname" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 14.4px; white-space: nowrap; max-width: 100%; background: transparent; border: none; padding: 0px; color: rgb(0, 0, 0); overflow-x: auto;">open_spider</code><span class="sig-paren" style="box-sizing: border-box;">(</span><em style="box-sizing: border-box;">self</em>,&nbsp;<em style="box-sizing: border-box;">spider</em><span class="sig-paren" style="box-sizing: border-box;">)</span></h4><dl class="method" style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style: none none;"><dt id="open_spider" style="box-sizing: border-box; font-weight: bold; margin: 0px 0px 6px; display: table; font-size: 14.4px; line-height: normal; background: rgb(231, 242, 250); color: rgb(41, 128, 185); border-top: 3px solid rgb(106, 176, 222); padding: 6px; position: relative;"><a class="headerlink" href="https://docs.scrapy.org/en/latest/topics/item-pipeline.html#open_spider" title="Permalink to this definition" style="box-sizing: border-box; color: rgb(64, 64, 64); text-decoration-line: none; cursor: pointer; display: inline-block; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: normal; font-stretch: normal; line-height: 1; font-family: inherit; font-size: 14.4px; text-rendering: auto; -webkit-font-smoothing: antialiased; visibility: hidden;"></a></dt><dd style="box-sizing: border-box; margin: 0px 0px 12px 24px; line-height: 24px;"><p style="box-sizing: border-box; line-height: 24px; margin-top: 0px; margin-right: 0px; margin-left: 0px; margin-bottom: 12px !important;">当 spider 开启的时候会被调用，仅执行一次。<br><br>This method is called when the spider is opened.</p><table class="docutils field-list" frame="void" rules="none" style="box-sizing: border-box; border-spacing: 0px; margin-bottom: 24px; empty-cells: show; border: none;"><colgroup style="box-sizing: border-box;"><col class="field-name" style="box-sizing: border-box; padding-right: 10px; white-space: nowrap;"><col class="field-body" style="box-sizing: border-box;"></colgroup><tbody valign="top" style="box-sizing: border-box;"><tr class="field-odd field" style="box-sizing: border-box;"><th class="field-name" style="box-sizing: border-box; font-size: 14.4px; margin: 0px; overflow: visible; padding: 8px 10px 8px 16px; border-color: rgb(225, 228, 229); white-space: nowrap; border-left-width: 0px;">Parameters:</th><td class="field-body" style="box-sizing: border-box; vertical-align: middle; font-size: 14.4px; margin: 0px; overflow: visible; padding: 8px 16px; background-color: transparent; border-bottom-width: 0px;"><strong style="box-sizing: border-box; display: inline-block;">spider</strong>&nbsp;(<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/spiders.html#scrapy.spiders.Spider" title="scrapy.spiders.Spider" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-class docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 10.8px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">Spider</span></code></a>&nbsp;object) – the spider which was opened</td></tr></tbody></table></dd></dl><h4 style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style: none none;" id="blogTitle57"><code class="descname" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 14.4px; white-space: nowrap; max-width: 100%; background: transparent; border: none; padding: 0px; color: rgb(0, 0, 0); overflow-x: auto;">close_spider</code><span class="sig-paren" style="box-sizing: border-box;">(</span><em style="box-sizing: border-box;">self</em>,&nbsp;<em style="box-sizing: border-box;">spider</em><span class="sig-paren" style="box-sizing: border-box;">)</span></h4><dl class="method" style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style: none none;"><dt id="close_spider" style="box-sizing: border-box; font-weight: bold; margin: 0px 0px 6px; display: table; font-size: 14.4px; line-height: normal; background: rgb(231, 242, 250); color: rgb(41, 128, 185); border-top: 3px solid rgb(106, 176, 222); padding: 6px; position: relative;"><a class="headerlink" href="https://docs.scrapy.org/en/latest/topics/item-pipeline.html#close_spider" title="Permalink to this definition" style="box-sizing: border-box; color: rgb(64, 64, 64); text-decoration-line: none; cursor: pointer; display: inline-block; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: normal; font-stretch: normal; line-height: 1; font-family: inherit; font-size: 14.4px; text-rendering: auto; -webkit-font-smoothing: antialiased; visibility: hidden;"></a></dt><dd style="box-sizing: border-box; margin: 0px 0px 12px 24px; line-height: 24px;"><p style="box-sizing: border-box; line-height: 24px; margin-top: 0px; margin-right: 0px; margin-left: 0px; margin-bottom: 12px !important;">当 spider 关闭的时候会被调用，仅执行一次。<br><br>This method is called when the spider is closed.</p><table class="docutils field-list" frame="void" rules="none" style="box-sizing: border-box; border-spacing: 0px; margin-bottom: 24px; empty-cells: show; border: none;"><colgroup style="box-sizing: border-box;"><col class="field-name" style="box-sizing: border-box; padding-right: 10px; white-space: nowrap;"><col class="field-body" style="box-sizing: border-box;"></colgroup><tbody valign="top" style="box-sizing: border-box;"><tr class="field-odd field" style="box-sizing: border-box;"><th class="field-name" style="box-sizing: border-box; font-size: 14.4px; margin: 0px; overflow: visible; padding: 8px 10px 8px 16px; border-color: rgb(225, 228, 229); white-space: nowrap; border-left-width: 0px;">Parameters:</th><td class="field-body" style="box-sizing: border-box; vertical-align: middle; font-size: 14.4px; margin: 0px; overflow: visible; padding: 8px 16px; background-color: transparent; border-bottom-width: 0px;"><strong style="box-sizing: border-box; display: inline-block;">spider</strong>&nbsp;(<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/spiders.html#scrapy.spiders.Spider" title="scrapy.spiders.Spider" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-class docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 10.8px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">Spider</span></code></a>&nbsp;object) – the spider which was closed</td></tr></tbody></table></dd></dl><h4 style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style: none none;" id="blogTitle58"><code class="descname" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 14.4px; white-space: nowrap; max-width: 100%; background: transparent; border: none; padding: 0px; color: rgb(0, 0, 0); overflow-x: auto;">from_crawler</code><span class="sig-paren" style="box-sizing: border-box;">(</span><em style="box-sizing: border-box;">cls</em>,&nbsp;<em style="box-sizing: border-box;">crawler</em><span class="sig-paren" style="box-sizing: border-box;">)</span></h4><dl class="method" style="box-sizing: border-box; margin: 0px 0px 24px; padding: 0px; list-style: none none;"><dt id="from_crawler" style="box-sizing: border-box; font-weight: bold; margin: 0px 0px 6px; display: table; font-size: 14.4px; line-height: normal; background: rgb(231, 242, 250); color: rgb(41, 128, 185); border-top: 3px solid rgb(106, 176, 222); padding: 6px; position: relative;"><a class="headerlink" href="https://docs.scrapy.org/en/latest/topics/item-pipeline.html#from_crawler" title="Permalink to this definition" style="box-sizing: border-box; color: rgb(64, 64, 64); text-decoration-line: none; cursor: pointer; display: inline-block; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: normal; font-stretch: normal; line-height: 1; font-family: inherit; font-size: 14.4px; text-rendering: auto; -webkit-font-smoothing: antialiased; visibility: hidden;"></a></dt><dd style="box-sizing: border-box; margin: 0px 0px 12px 24px; line-height: 24px;"><p style="box-sizing: border-box; line-height: 24px; margin-top: 0px; margin-right: 0px; margin-left: 0px; margin-bottom: 12px !important;">If present, this classmethod is called to create a pipeline instance from a&nbsp;<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/api.html#scrapy.crawler.Crawler" title="scrapy.crawler.Crawler" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-class docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">Crawler</span></code></a>. It must return a new instance of the pipeline. Crawler object provides access to all Scrapy core components like settings and signals; it is a way for pipeline to access them and hook its functionality into Scrapy.</p><table class="docutils field-list" frame="void" rules="none" style="box-sizing: border-box; border-spacing: 0px; margin-bottom: 24px; empty-cells: show; border: none;"><colgroup style="box-sizing: border-box;"><col class="field-name" style="box-sizing: border-box; padding-right: 10px; white-space: nowrap;"><col class="field-body" style="box-sizing: border-box;"></colgroup><tbody valign="top" style="box-sizing: border-box;"><tr class="field-odd field" style="box-sizing: border-box;"><th class="field-name" style="box-sizing: border-box; font-size: 14.4px; margin: 0px; overflow: visible; padding: 8px 10px 8px 16px; border-color: rgb(225, 228, 229); white-space: nowrap; border-left-width: 0px;">Parameters:</th><td class="field-body" style="box-sizing: border-box; vertical-align: middle; font-size: 14.4px; margin: 0px; overflow: visible; padding: 8px 16px; background-color: transparent; border-bottom-width: 0px;"><strong style="box-sizing: border-box; display: inline-block;">crawler</strong>&nbsp;(<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/api.html#scrapy.crawler.Crawler" title="scrapy.crawler.Crawler" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-class docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 10.8px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">Crawler</span></code></a>&nbsp;object) – crawler that uses this pipeline</td></tr></tbody></table></dd></dl></div><div class="section" id="item-pipeline-example" style="box-sizing: border-box; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);"><h3 style="box-sizing: border-box; margin-top: 0px; font-family: &quot;Roboto Slab&quot;, ff-tisa-web-pro, Georgia, Arial, sans-serif; font-size: 24px;" id="blogTitle59">Item pipeline example</h3><div class="section" id="price-validation-and-dropping-items-with-no-prices" style="box-sizing: border-box;"><h4 style="box-sizing: border-box; margin-top: 0px; font-family: &quot;Roboto Slab&quot;, ff-tisa-web-pro, Georgia, Arial, sans-serif; font-size: 20px;" id="blogTitle60">Price validation and dropping items with no prices</h4><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px;">Let’s take a look at the following hypothetical pipeline that adjusts the&nbsp;<code class="docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(231, 76, 60); overflow-x: auto;"><span class="pre" style="box-sizing: border-box;">price</span></code>&nbsp;attribute for those items that do not include VAT (<code class="docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(231, 76, 60); overflow-x: auto;"><span class="pre" style="box-sizing: border-box;">price_excludes_vat</span></code>&nbsp;attribute), and drops those items which don’t contain a price:</p><div class="highlight-default notranslate" style="box-sizing: border-box; border: 1px solid rgb(225, 228, 229); overflow-x: auto; margin: 1px 0px 24px;"><div class="highlight" style="box-sizing: border-box; background: rgb(238, 255, 204); border: none; overflow-x: auto; margin: 0px; padding: 0px;"><pre style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; margin-top: 0px; margin-bottom: 0px; padding: 12px; line-height: 1.4;"><span style="box-sizing: border-box;"></span><span class="kn" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">scrapy.exceptions</span> <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n" style="box-sizing: border-box;">DropItem</span>

<span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">class</span> <span class="nc" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">PricePipeline</span><span class="p" style="box-sizing: border-box;">(</span><span class="nb" style="box-sizing: border-box; color: rgb(0, 112, 32);">object</span><span class="p" style="box-sizing: border-box;">):</span>

    <span class="n" style="box-sizing: border-box;">vat_factor</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="mf" style="box-sizing: border-box; color: rgb(32, 128, 80);">1.15</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">process_item</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">if</span> <span class="n" style="box-sizing: border-box;">item</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">get</span><span class="p" style="box-sizing: border-box;">(</span><span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'price'</span><span class="p" style="box-sizing: border-box;">):</span>
            <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">if</span> <span class="n" style="box-sizing: border-box;">item</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">get</span><span class="p" style="box-sizing: border-box;">(</span><span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'price_excludes_vat'</span><span class="p" style="box-sizing: border-box;">):</span>
                <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">[</span><span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'price'</span><span class="p" style="box-sizing: border-box;">]</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">[</span><span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'price'</span><span class="p" style="box-sizing: border-box;">]</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">*</span> <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">vat_factor</span>
            <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">return</span> <span class="n" style="box-sizing: border-box;">item</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">else</span><span class="p" style="box-sizing: border-box;">:</span>
            <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">raise</span> <span class="n" style="box-sizing: border-box;">DropItem</span><span class="p" style="box-sizing: border-box;">(</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"Missing price in </span><span class="si" style="box-sizing: border-box; color: rgb(112, 160, 208); font-style: italic;">%s</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">%</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">)</span>
</pre></div></div></div><div class="section" id="write-items-to-a-json-file" style="box-sizing: border-box;"><h4 style="box-sizing: border-box; margin-top: 0px; font-family: &quot;Roboto Slab&quot;, ff-tisa-web-pro, Georgia, Arial, sans-serif; font-size: 20px;" id="blogTitle61">Write items to a JSON file</h4><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px;">The following pipeline stores all scraped items (from all spiders) into a single&nbsp;<code class="docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(231, 76, 60); overflow-x: auto;"><span class="pre" style="box-sizing: border-box;">items.jl</span></code>&nbsp;file, containing one item per line serialized in JSON format:</p><div class="highlight-default notranslate" style="box-sizing: border-box; border: 1px solid rgb(225, 228, 229); overflow-x: auto; margin: 1px 0px 24px;"><div class="highlight" style="box-sizing: border-box; background: rgb(238, 255, 204); border: none; overflow-x: auto; margin: 0px; padding: 0px;"><pre style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; margin-top: 0px; margin-bottom: 0px; padding: 12px; line-height: 1.4;"><span style="box-sizing: border-box;"></span><span class="kn" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">json</span>

<span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">class</span> <span class="nc" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">JsonWriterPipeline</span><span class="p" style="box-sizing: border-box;">(</span><span class="nb" style="box-sizing: border-box; color: rgb(0, 112, 32);">object</span><span class="p" style="box-sizing: border-box;">):</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">open_spider</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">file</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="nb" style="box-sizing: border-box; color: rgb(0, 112, 32);">open</span><span class="p" style="box-sizing: border-box;">(</span><span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'items.jl'</span><span class="p" style="box-sizing: border-box;">,</span> <span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'w'</span><span class="p" style="box-sizing: border-box;">)</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">close_spider</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">file</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">close</span><span class="p" style="box-sizing: border-box;">()</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">process_item</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="n" style="box-sizing: border-box;">line</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">json</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">dumps</span><span class="p" style="box-sizing: border-box;">(</span><span class="nb" style="box-sizing: border-box; color: rgb(0, 112, 32);">dict</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">))</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">+</span> <span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"</span><span class="se" style="box-sizing: border-box; color: rgb(64, 112, 160); font-weight: bold;">\n</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"</span>
        <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">file</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">write</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">line</span><span class="p" style="box-sizing: border-box;">)</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">return</span> <span class="n" style="box-sizing: border-box;">item</span>
</pre></div></div><div class="admonition note" style="box-sizing: border-box; -webkit-font-smoothing: antialiased; padding: 12px; line-height: 24px; margin-bottom: 24px; background: rgb(231, 242, 250);"><p class="first admonition-title" style="box-sizing: border-box; line-height: 1; margin: -12px -12px 12px; font-size: inherit; font-variant-numeric: normal; font-variant-east-asian: normal; font-weight: bold; font-stretch: normal; font-family: inherit; text-rendering: auto; -webkit-font-smoothing: antialiased; color: rgb(255, 255, 255); background: rgb(106, 176, 222); padding: 6px 12px;">Note</p><p class="last" style="box-sizing: border-box; line-height: 24px; margin: 0px;">The purpose of JsonWriterPipeline is just to introduce how to write item pipelines. If you really want to store all scraped items into a JSON file you should use the&nbsp;<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/feed-exports.html#topics-feed-exports" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Feed exports</a>.</p></div></div><div class="section" id="write-items-to-mongodb" style="box-sizing: border-box;"><h4 style="box-sizing: border-box; margin-top: 0px; font-family: &quot;Roboto Slab&quot;, ff-tisa-web-pro, Georgia, Arial, sans-serif; font-size: 20px;" id="blogTitle62">Write items to MongoDB</h4><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px;">In this example we’ll write items to&nbsp;<a class="reference external" href="https://www.mongodb.org/" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">MongoDB</a>&nbsp;using&nbsp;<a class="reference external" href="https://api.mongodb.org/python/current/" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">pymongo</a>. MongoDB address and database name are specified in Scrapy settings; MongoDB collection is named after item class.</p><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px;">The main point of this example is to show how to use&nbsp;<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/item-pipeline.html#from_crawler" title="from_crawler" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-meth docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">from_crawler()</span></code></a>&nbsp;method and how to clean up the resources properly.:</p><div class="highlight-default notranslate" style="box-sizing: border-box; border: 1px solid rgb(225, 228, 229); overflow-x: auto; margin: 1px 0px 24px;"><div class="highlight" style="box-sizing: border-box; background: rgb(238, 255, 204); border: none; overflow-x: auto; margin: 0px; padding: 0px;"><pre style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; margin-top: 0px; margin-bottom: 0px; padding: 12px; line-height: 1.4;"><span style="box-sizing: border-box;"></span><span class="kn" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">pymongo</span>

<span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">class</span> <span class="nc" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">MongoPipeline</span><span class="p" style="box-sizing: border-box;">(</span><span class="nb" style="box-sizing: border-box; color: rgb(0, 112, 32);">object</span><span class="p" style="box-sizing: border-box;">):</span>

    <span class="n" style="box-sizing: border-box;">collection_name</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'scrapy_items'</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">__init__</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">mongo_uri</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">mongo_db</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">mongo_uri</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">mongo_uri</span>
        <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">mongo_db</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">mongo_db</span>

    <span class="nd" style="box-sizing: border-box; color: rgb(85, 85, 85); font-weight: bold;">@classmethod</span>
    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">from_crawler</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">cls</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">crawler</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">return</span> <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">cls</span><span class="p" style="box-sizing: border-box;">(</span>
            <span class="n" style="box-sizing: border-box;">mongo_uri</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span><span class="n" style="box-sizing: border-box;">crawler</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">settings</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">get</span><span class="p" style="box-sizing: border-box;">(</span><span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'MONGO_URI'</span><span class="p" style="box-sizing: border-box;">),</span>
            <span class="n" style="box-sizing: border-box;">mongo_db</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span><span class="n" style="box-sizing: border-box;">crawler</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">settings</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">get</span><span class="p" style="box-sizing: border-box;">(</span><span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'MONGO_DATABASE'</span><span class="p" style="box-sizing: border-box;">,</span> <span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'items'</span><span class="p" style="box-sizing: border-box;">)</span>
        <span class="p" style="box-sizing: border-box;">)</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">open_spider</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">client</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">pymongo</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">MongoClient</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">mongo_uri</span><span class="p" style="box-sizing: border-box;">)</span>
        <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">db</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">client</span><span class="p" style="box-sizing: border-box;">[</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">mongo_db</span><span class="p" style="box-sizing: border-box;">]</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">close_spider</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">client</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">close</span><span class="p" style="box-sizing: border-box;">()</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">process_item</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">db</span><span class="p" style="box-sizing: border-box;">[</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">collection_name</span><span class="p" style="box-sizing: border-box;">]</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">insert_one</span><span class="p" style="box-sizing: border-box;">(</span><span class="nb" style="box-sizing: border-box; color: rgb(0, 112, 32);">dict</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">))</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">return</span> <span class="n" style="box-sizing: border-box;">item</span>
</pre></div></div></div><div class="section" id="take-screenshot-of-item" style="box-sizing: border-box;"><h4 style="box-sizing: border-box; margin-top: 0px; font-family: &quot;Roboto Slab&quot;, ff-tisa-web-pro, Georgia, Arial, sans-serif; font-size: 20px;" id="blogTitle63">Take screenshot of item</h4><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px;">This example demonstrates how to return&nbsp;<a class="reference external" href="https://twistedmatrix.com/documents/current/core/howto/defer.html" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Deferred</a>&nbsp;from&nbsp;<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/item-pipeline.html#process_item" title="process_item" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref py py-meth docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">process_item()</span></code></a>&nbsp;method. It uses&nbsp;<a class="reference external" href="https://splash.readthedocs.io/en/stable/" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Splash</a>&nbsp;to render screenshot of item url. Pipeline makes request to locally running instance of&nbsp;<a class="reference external" href="https://splash.readthedocs.io/en/stable/" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;">Splash</a>. After request is downloaded and Deferred callback fires, it saves item to a file and adds filename to an item.</p><div class="highlight-default notranslate" style="box-sizing: border-box; border: 1px solid rgb(225, 228, 229); overflow-x: auto; margin: 1px 0px 24px;"><div class="highlight" style="box-sizing: border-box; background: rgb(238, 255, 204); border: none; overflow-x: auto; margin: 0px; padding: 0px;"><pre style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; margin-top: 0px; margin-bottom: 0px; padding: 12px; line-height: 1.4;"><span style="box-sizing: border-box;"></span><span class="kn" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">scrapy</span>
<span class="kn" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="nn" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">hashlib</span>
<span class="kn" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">urllib.parse</span> <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n" style="box-sizing: border-box;">quote</span>


<span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">class</span> <span class="nc" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">ScreenshotPipeline</span><span class="p" style="box-sizing: border-box;">(</span><span class="nb" style="box-sizing: border-box; color: rgb(0, 112, 32);">object</span><span class="p" style="box-sizing: border-box;">):</span>
    <span class="sd" style="box-sizing: border-box; color: rgb(64, 112, 160); font-style: italic;">"""Pipeline that uses Splash to render screenshot of</span>
<span class="sd" style="box-sizing: border-box; color: rgb(64, 112, 160); font-style: italic;">    every Scrapy item."""</span>

    <span class="n" style="box-sizing: border-box;">SPLASH_URL</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"http://localhost:8050/render.png?url=</span><span class="si" style="box-sizing: border-box; color: rgb(112, 160, 208); font-style: italic;">{}</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">process_item</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="n" style="box-sizing: border-box;">encoded_item_url</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">quote</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">[</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"url"</span><span class="p" style="box-sizing: border-box;">])</span>
        <span class="n" style="box-sizing: border-box;">screenshot_url</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">SPLASH_URL</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">format</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">encoded_item_url</span><span class="p" style="box-sizing: border-box;">)</span>
        <span class="n" style="box-sizing: border-box;">request</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">scrapy</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">Request</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">screenshot_url</span><span class="p" style="box-sizing: border-box;">)</span>
        <span class="n" style="box-sizing: border-box;">dfd</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">crawler</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">engine</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">download</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">request</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="p" style="box-sizing: border-box;">)</span>
        <span class="n" style="box-sizing: border-box;">dfd</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">addBoth</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">return_item</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">)</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">return</span> <span class="n" style="box-sizing: border-box;">dfd</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">return_item</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">response</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">if</span> <span class="n" style="box-sizing: border-box;">response</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">status</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">!=</span> <span class="mi" style="box-sizing: border-box; color: rgb(32, 128, 80);">200</span><span class="p" style="box-sizing: border-box;">:</span>
            <span class="c1" style="box-sizing: border-box; color: rgb(64, 128, 144); font-style: italic;"># Error happened, return item.</span>
            <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">return</span> <span class="n" style="box-sizing: border-box;">item</span>

        <span class="c1" style="box-sizing: border-box; color: rgb(64, 128, 144); font-style: italic;"># Save screenshot to file, filename will be hash of url.</span>
        <span class="n" style="box-sizing: border-box;">url</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">[</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"url"</span><span class="p" style="box-sizing: border-box;">]</span>
        <span class="n" style="box-sizing: border-box;">url_hash</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">hashlib</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">md5</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">url</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">encode</span><span class="p" style="box-sizing: border-box;">(</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"utf8"</span><span class="p" style="box-sizing: border-box;">))</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">hexdigest</span><span class="p" style="box-sizing: border-box;">()</span>
        <span class="n" style="box-sizing: border-box;">filename</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"</span><span class="si" style="box-sizing: border-box; color: rgb(112, 160, 208); font-style: italic;">{}</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">.png"</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">format</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">url_hash</span><span class="p" style="box-sizing: border-box;">)</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">with</span> <span class="nb" style="box-sizing: border-box; color: rgb(0, 112, 32);">open</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">filename</span><span class="p" style="box-sizing: border-box;">,</span> <span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"wb"</span><span class="p" style="box-sizing: border-box;">)</span> <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">as</span> <span class="n" style="box-sizing: border-box;">f</span><span class="p" style="box-sizing: border-box;">:</span>
            <span class="n" style="box-sizing: border-box;">f</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">write</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">response</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">body</span><span class="p" style="box-sizing: border-box;">)</span>

        <span class="c1" style="box-sizing: border-box; color: rgb(64, 128, 144); font-style: italic;"># Store filename in item.</span>
        <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">[</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"screenshot_filename"</span><span class="p" style="box-sizing: border-box;">]</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="n" style="box-sizing: border-box;">filename</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">return</span> <span class="n" style="box-sizing: border-box;">item</span>
</pre></div></div></div><div class="section" id="duplicates-filter" style="box-sizing: border-box;"><h4 style="box-sizing: border-box; margin-top: 0px; font-family: &quot;Roboto Slab&quot;, ff-tisa-web-pro, Georgia, Arial, sans-serif; font-size: 20px;" id="blogTitle64">Duplicates filter</h4><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px;">A filter that looks for duplicate items, and drops those items that were already processed. Let’s say that our items have a unique id, but our spider returns multiples items with the same id:</p><div class="highlight-default notranslate" style="box-sizing: border-box; border: 1px solid rgb(225, 228, 229); overflow-x: auto; margin: 1px 0px 24px;"><div class="highlight" style="box-sizing: border-box; background: rgb(238, 255, 204); border: none; overflow-x: auto; margin: 0px; padding: 0px;"><pre style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; margin-top: 0px; margin-bottom: 0px; padding: 12px; line-height: 1.4;"><span style="box-sizing: border-box;"></span><span class="kn" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">from</span> <span class="nn" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">scrapy.exceptions</span> <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">import</span> <span class="n" style="box-sizing: border-box;">DropItem</span>

<span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">class</span> <span class="nc" style="box-sizing: border-box; color: rgb(14, 132, 181); font-weight: bold;">DuplicatesPipeline</span><span class="p" style="box-sizing: border-box;">(</span><span class="nb" style="box-sizing: border-box; color: rgb(0, 112, 32);">object</span><span class="p" style="box-sizing: border-box;">):</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">__init__</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">ids_seen</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="nb" style="box-sizing: border-box; color: rgb(0, 112, 32);">set</span><span class="p" style="box-sizing: border-box;">()</span>

    <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">def</span> <span class="nf" style="box-sizing: border-box; color: rgb(6, 40, 126);">process_item</span><span class="p" style="box-sizing: border-box;">(</span><span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">,</span> <span class="n" style="box-sizing: border-box;">spider</span><span class="p" style="box-sizing: border-box;">):</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">if</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">[</span><span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'id'</span><span class="p" style="box-sizing: border-box;">]</span> <span class="ow" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">in</span> <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">ids_seen</span><span class="p" style="box-sizing: border-box;">:</span>
            <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">raise</span> <span class="n" style="box-sizing: border-box;">DropItem</span><span class="p" style="box-sizing: border-box;">(</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"Duplicate item found: </span><span class="si" style="box-sizing: border-box; color: rgb(112, 160, 208); font-style: italic;">%s</span><span class="s2" style="box-sizing: border-box; color: rgb(64, 112, 160);">"</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">%</span> <span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">)</span>
        <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">else</span><span class="p" style="box-sizing: border-box;">:</span>
            <span class="bp" style="box-sizing: border-box; color: rgb(0, 112, 32);">self</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">ids_seen</span><span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">.</span><span class="n" style="box-sizing: border-box;">add</span><span class="p" style="box-sizing: border-box;">(</span><span class="n" style="box-sizing: border-box;">item</span><span class="p" style="box-sizing: border-box;">[</span><span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'id'</span><span class="p" style="box-sizing: border-box;">])</span>
            <span class="k" style="box-sizing: border-box; color: rgb(0, 112, 32); font-weight: bold;">return</span> <span class="n" style="box-sizing: border-box;">item</span>
</pre></div></div></div></div><div class="section" id="activating-an-item-pipeline-component" style="box-sizing: border-box; color: rgb(64, 64, 64); font-family: Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif; font-size: 16px; background-color: rgb(252, 252, 252);"><h3 style="box-sizing: border-box; margin-top: 0px; font-family: &quot;Roboto Slab&quot;, ff-tisa-web-pro, Georgia, Arial, sans-serif; font-size: 24px;" id="blogTitle65">Activating an Item Pipeline component</h3><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px;">To activate an Item Pipeline component you must add its class to the&nbsp;<a class="reference internal" href="https://docs.scrapy.org/en/latest/topics/settings.html#std:setting-ITEM_PIPELINES" style="box-sizing: border-box; color: rgb(155, 89, 182); text-decoration-line: none; cursor: pointer;"><code class="xref std std-setting docutils literal notranslate" style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; white-space: nowrap; max-width: 100%; background: rgb(255, 255, 255); border: 1px solid rgb(225, 228, 229); padding: 2px 5px; color: rgb(64, 64, 64); overflow-x: auto; font-weight: bold;"><span class="pre" style="box-sizing: border-box;">ITEM_PIPELINES</span></code></a>&nbsp;setting, like in the following example:</p><div class="highlight-default notranslate" style="box-sizing: border-box; border: 1px solid rgb(225, 228, 229); overflow-x: auto; margin: 1px 0px 24px;"><div class="highlight" style="box-sizing: border-box; background: rgb(238, 255, 204); border: none; overflow-x: auto; margin: 0px; padding: 0px;"><pre style="box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, Courier, monospace; font-size: 12px; margin-top: 0px; margin-bottom: 0px; padding: 12px; line-height: 1.4;"><span style="box-sizing: border-box;"></span><span class="n" style="box-sizing: border-box;">ITEM_PIPELINES</span> <span class="o" style="box-sizing: border-box; color: rgb(102, 102, 102);">=</span> <span class="p" style="box-sizing: border-box;">{</span>
    <span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'myproject.pipelines.PricePipeline'</span><span class="p" style="box-sizing: border-box;">:</span> <span class="mi" style="box-sizing: border-box; color: rgb(32, 128, 80);">300</span><span class="p" style="box-sizing: border-box;">,</span>
    <span class="s1" style="box-sizing: border-box; color: rgb(64, 112, 160);">'myproject.pipelines.JsonWriterPipeline'</span><span class="p" style="box-sizing: border-box;">:</span> <span class="mi" style="box-sizing: border-box; color: rgb(32, 128, 80);">800</span><span class="p" style="box-sizing: border-box;">,</span>
<span class="p" style="box-sizing: border-box;">}</span>
</pre></div></div><p style="box-sizing: border-box; line-height: 24px; margin: 0px 0px 24px;">The integer values you assign to classes in this setting determine the order in which they run: items go through from lower valued to higher valued classes. It’s customary to define these numbers in the 0-1000 range.</p></div></div><div><br></div><div><br></div><div><br></div><h2 id="blogTitle66">Feed exports</h2><h2 id="blogTitle67">Requests and Responses</h2><h2 id="blogTitle68">Link Extractors</h2><h2 id="blogTitle69">Settings</h2><h2 id="blogTitle70">Exceptions</h2><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div>
</article>
{% endblock point1 %}
